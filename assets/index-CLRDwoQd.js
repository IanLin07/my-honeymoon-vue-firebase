(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();function e(e){let t=Object.create(null);for(let n of e.split(`,`))t[n]=1;return e=>e in t}var t={},n=[],r=()=>{},i=()=>!1,a=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),o=e=>e.startsWith(`onUpdate:`),s=Object.assign,c=(e,t)=>{let n=e.indexOf(t);n>-1&&e.splice(n,1)},l=Object.prototype.hasOwnProperty,u=(e,t)=>l.call(e,t),d=Array.isArray,f=e=>x(e)===`[object Map]`,p=e=>x(e)===`[object Set]`,m=e=>x(e)===`[object Date]`,h=e=>typeof e==`function`,g=e=>typeof e==`string`,_=e=>typeof e==`symbol`,v=e=>typeof e==`object`&&!!e,y=e=>(v(e)||h(e))&&h(e.then)&&h(e.catch),b=Object.prototype.toString,x=e=>b.call(e),ee=e=>x(e).slice(8,-1),te=e=>x(e)===`[object Object]`,S=e=>g(e)&&e!==`NaN`&&e[0]!==`-`&&``+parseInt(e,10)===e,ne=e(`,key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted`),re=e=>{let t=Object.create(null);return(n=>t[n]||(t[n]=e(n)))},C=/-\w/g,w=re(e=>e.replace(C,e=>e.slice(1).toUpperCase())),ie=/\B([A-Z])/g,T=re(e=>e.replace(ie,`-$1`).toLowerCase()),E=re(e=>e.charAt(0).toUpperCase()+e.slice(1)),ae=re(e=>e?`on${E(e)}`:``),oe=(e,t)=>!Object.is(e,t),se=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},D=(e,t,n,r=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:r,value:n})},ce=e=>{let t=parseFloat(e);return isNaN(t)?e:t},le,ue=()=>le||=typeof globalThis<`u`?globalThis:typeof self<`u`?self:typeof window<`u`?window:typeof global<`u`?global:{};function de(e){if(d(e)){let t={};for(let n=0;n<e.length;n++){let r=e[n],i=g(r)?me(r):de(r);if(i)for(let e in i)t[e]=i[e]}return t}else if(g(e)||v(e))return e}var fe=/;(?![^(]*\))/g,pe=/:([^]+)/,O=/\/\*[^]*?\*\//g;function me(e){let t={};return e.replace(O,``).split(fe).forEach(e=>{if(e){let n=e.split(pe);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function he(e){let t=``;if(g(e))t=e;else if(d(e))for(let n=0;n<e.length;n++){let r=he(e[n]);r&&(t+=r+` `)}else if(v(e))for(let n in e)e[n]&&(t+=n+` `);return t.trim()}var ge=`itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly`,_e=e(ge);ge+``;function ve(e){return!!e||e===``}function ye(e,t){if(e.length!==t.length)return!1;let n=!0;for(let r=0;n&&r<e.length;r++)n=be(e[r],t[r]);return n}function be(e,t){if(e===t)return!0;let n=m(e),r=m(t);if(n||r)return n&&r?e.getTime()===t.getTime():!1;if(n=_(e),r=_(t),n||r)return e===t;if(n=d(e),r=d(t),n||r)return n&&r?ye(e,t):!1;if(n=v(e),r=v(t),n||r){if(!n||!r||Object.keys(e).length!==Object.keys(t).length)return!1;for(let n in e){let r=e.hasOwnProperty(n),i=t.hasOwnProperty(n);if(r&&!i||!r&&i||!be(e[n],t[n]))return!1}}return String(e)===String(t)}function xe(e,t){return e.findIndex(e=>be(e,t))}var Se=e=>!!(e&&e.__v_isRef===!0),k=e=>g(e)?e:e==null?``:d(e)||v(e)&&(e.toString===b||!h(e.toString))?Se(e)?k(e.value):JSON.stringify(e,Ce,2):String(e),Ce=(e,t)=>Se(t)?Ce(e,t.value):f(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[t,n],r)=>(e[we(t,r)+` =>`]=n,e),{})}:p(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>we(e))}:_(t)?we(t):v(t)&&!d(t)&&!te(t)?String(t):t,we=(e,t=``)=>_(e)?`Symbol(${e.description??t})`:e,Te,Ee=class{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Te,!e&&Te&&(this.index=(Te.scopes||=[]).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){let t=Te;try{return Te=this,e()}finally{Te=t}}}on(){++this._on===1&&(this.prevScope=Te,Te=this)}off(){this._on>0&&--this._on===0&&(Te=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(this.effects.length=0,t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){let e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=void 0}}};function De(){return Te}var A,Oe=new WeakSet,ke=class{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Te&&Te.active&&Te.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Oe.has(this)&&(Oe.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Ne(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Ke(this),Ie(this);let e=A,t=He;A=this,He=!0;try{return this.fn()}finally{Le(this),A=e,He=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Be(e);this.deps=this.depsTail=void 0,Ke(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Oe.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Re(this)&&this.run()}get dirty(){return Re(this)}},Ae=0,je,Me;function Ne(e,t=!1){if(e.flags|=8,t){e.next=Me,Me=e;return}e.next=je,je=e}function Pe(){Ae++}function Fe(){if(--Ae>0)return;if(Me){let e=Me;for(Me=void 0;e;){let t=e.next;e.next=void 0,e.flags&=-9,e=t}}let e;for(;je;){let t=je;for(je=void 0;t;){let n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(t){e||=t}t=n}}if(e)throw e}function Ie(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Le(e){let t,n=e.depsTail,r=n;for(;r;){let e=r.prevDep;r.version===-1?(r===n&&(n=e),Be(r),Ve(r)):t=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=e}e.deps=t,e.depsTail=n}function Re(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(ze(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function ze(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===qe)||(e.globalVersion=qe,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!Re(e))))return;e.flags|=2;let t=e.dep,n=A,r=He;A=e,He=!0;try{Ie(e);let n=e.fn(e._value);(t.version===0||oe(n,e._value))&&(e.flags|=128,e._value=n,t.version++)}catch(e){throw t.version++,e}finally{A=n,He=r,Le(e),e.flags&=-3}}function Be(e,t=!1){let{dep:n,prevSub:r,nextSub:i}=e;if(r&&(r.nextSub=i,e.prevSub=void 0),i&&(i.prevSub=r,e.nextSub=void 0),n.subs===e&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let e=n.computed.deps;e;e=e.nextDep)Be(e,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function Ve(e){let{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}var He=!0,Ue=[];function We(){Ue.push(He),He=!1}function Ge(){let e=Ue.pop();He=e===void 0?!0:e}function Ke(e){let{cleanup:t}=e;if(e.cleanup=void 0,t){let e=A;A=void 0;try{t()}finally{A=e}}}var qe=0,Je=class{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}},Ye=class{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!A||!He||A===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==A)t=this.activeLink=new Je(A,this),A.deps?(t.prevDep=A.depsTail,A.depsTail.nextDep=t,A.depsTail=t):A.deps=A.depsTail=t,Xe(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){let e=t.nextDep;e.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=e),t.prevDep=A.depsTail,t.nextDep=void 0,A.depsTail.nextDep=t,A.depsTail=t,A.deps===t&&(A.deps=e)}return t}trigger(e){this.version++,qe++,this.notify(e)}notify(e){Pe();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{Fe()}}};function Xe(e){if(e.dep.sc++,e.sub.flags&4){let t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let e=t.deps;e;e=e.nextDep)Xe(e)}let n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}var Ze=new WeakMap,Qe=Symbol(``),$e=Symbol(``),et=Symbol(``);function tt(e,t,n){if(He&&A){let t=Ze.get(e);t||Ze.set(e,t=new Map);let r=t.get(n);r||(t.set(n,r=new Ye),r.map=t,r.key=n),r.track()}}function nt(e,t,n,r,i,a){let o=Ze.get(e);if(!o){qe++;return}let s=e=>{e&&e.trigger()};if(Pe(),t===`clear`)o.forEach(s);else{let i=d(e),a=i&&S(n);if(i&&n===`length`){let e=Number(r);o.forEach((t,n)=>{(n===`length`||n===et||!_(n)&&n>=e)&&s(t)})}else switch((n!==void 0||o.has(void 0))&&s(o.get(n)),a&&s(o.get(et)),t){case`add`:i?a&&s(o.get(`length`)):(s(o.get(Qe)),f(e)&&s(o.get($e)));break;case`delete`:i||(s(o.get(Qe)),f(e)&&s(o.get($e)));break;case`set`:f(e)&&s(o.get(Qe));break}}Fe()}function rt(e){let t=M(e);return t===e?t:(tt(t,`iterate`,et),Ht(e)?t:t.map(Gt))}function it(e){return tt(e=M(e),`iterate`,et),e}function at(e,t){return Vt(e)?Bt(e)?Kt(Gt(t)):Kt(t):Gt(t)}var ot={__proto__:null,[Symbol.iterator](){return st(this,Symbol.iterator,e=>at(this,e))},concat(...e){return rt(this).concat(...e.map(e=>d(e)?rt(e):e))},entries(){return st(this,`entries`,e=>(e[1]=at(this,e[1]),e))},every(e,t){return lt(this,`every`,e,t,void 0,arguments)},filter(e,t){return lt(this,`filter`,e,t,e=>e.map(e=>at(this,e)),arguments)},find(e,t){return lt(this,`find`,e,t,e=>at(this,e),arguments)},findIndex(e,t){return lt(this,`findIndex`,e,t,void 0,arguments)},findLast(e,t){return lt(this,`findLast`,e,t,e=>at(this,e),arguments)},findLastIndex(e,t){return lt(this,`findLastIndex`,e,t,void 0,arguments)},forEach(e,t){return lt(this,`forEach`,e,t,void 0,arguments)},includes(...e){return dt(this,`includes`,e)},indexOf(...e){return dt(this,`indexOf`,e)},join(e){return rt(this).join(e)},lastIndexOf(...e){return dt(this,`lastIndexOf`,e)},map(e,t){return lt(this,`map`,e,t,void 0,arguments)},pop(){return ft(this,`pop`)},push(...e){return ft(this,`push`,e)},reduce(e,...t){return ut(this,`reduce`,e,t)},reduceRight(e,...t){return ut(this,`reduceRight`,e,t)},shift(){return ft(this,`shift`)},some(e,t){return lt(this,`some`,e,t,void 0,arguments)},splice(...e){return ft(this,`splice`,e)},toReversed(){return rt(this).toReversed()},toSorted(e){return rt(this).toSorted(e)},toSpliced(...e){return rt(this).toSpliced(...e)},unshift(...e){return ft(this,`unshift`,e)},values(){return st(this,`values`,e=>at(this,e))}};function st(e,t,n){let r=it(e),i=r[t]();return r!==e&&!Ht(e)&&(i._next=i.next,i.next=()=>{let e=i._next();return e.done||(e.value=n(e.value)),e}),i}var ct=Array.prototype;function lt(e,t,n,r,i,a){let o=it(e),s=o!==e&&!Ht(e),c=o[t];if(c!==ct[t]){let t=c.apply(e,a);return s?Gt(t):t}let l=n;o!==e&&(s?l=function(t,r){return n.call(this,at(e,t),r,e)}:n.length>2&&(l=function(t,r){return n.call(this,t,r,e)}));let u=c.call(o,l,r);return s&&i?i(u):u}function ut(e,t,n,r){let i=it(e),a=n;return i!==e&&(Ht(e)?n.length>3&&(a=function(t,r,i){return n.call(this,t,r,i,e)}):a=function(t,r,i){return n.call(this,t,at(e,r),i,e)}),i[t](a,...r)}function dt(e,t,n){let r=M(e);tt(r,`iterate`,et);let i=r[t](...n);return(i===-1||i===!1)&&Ut(n[0])?(n[0]=M(n[0]),r[t](...n)):i}function ft(e,t,n=[]){We(),Pe();let r=M(e)[t].apply(e,n);return Fe(),Ge(),r}var pt=e(`__proto__,__v_isRef,__isVue`),mt=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!==`arguments`&&e!==`caller`).map(e=>Symbol[e]).filter(_));function ht(e){_(e)||(e=String(e));let t=M(this);return tt(t,`has`,e),t.hasOwnProperty(e)}var gt=class{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){if(t===`__v_skip`)return e.__v_skip;let r=this._isReadonly,i=this._isShallow;if(t===`__v_isReactive`)return!r;if(t===`__v_isReadonly`)return r;if(t===`__v_isShallow`)return i;if(t===`__v_raw`)return n===(r?i?Pt:Nt:i?Mt:jt).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;let a=d(e);if(!r){let e;if(a&&(e=ot[t]))return e;if(t===`hasOwnProperty`)return ht}let o=Reflect.get(e,t,N(e)?e:n);if((_(t)?mt.has(t):pt(t))||(r||tt(e,`get`,t),i))return o;if(N(o)){let e=a&&S(t)?o:o.value;return r&&v(e)?j(e):e}return v(o)?r?j(o):Lt(o):o}},_t=class extends gt{constructor(e=!1){super(!1,e)}set(e,t,n,r){let i=e[t],a=d(e)&&S(t);if(!this._isShallow){let e=Vt(i);if(!Ht(n)&&!Vt(n)&&(i=M(i),n=M(n)),!a&&N(i)&&!N(n))return e||(i.value=n),!0}let o=a?Number(t)<e.length:u(e,t),s=Reflect.set(e,t,n,N(e)?e:r);return e===M(r)&&(o?oe(n,i)&&nt(e,`set`,t,n,i):nt(e,`add`,t,n)),s}deleteProperty(e,t){let n=u(e,t),r=e[t],i=Reflect.deleteProperty(e,t);return i&&n&&nt(e,`delete`,t,void 0,r),i}has(e,t){let n=Reflect.has(e,t);return(!_(t)||!mt.has(t))&&tt(e,`has`,t),n}ownKeys(e){return tt(e,`iterate`,d(e)?`length`:Qe),Reflect.ownKeys(e)}},vt=class extends gt{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}},yt=new _t,bt=new vt,xt=new _t(!0),St=e=>e,Ct=e=>Reflect.getPrototypeOf(e);function wt(e,t,n){return function(...r){let i=this.__v_raw,a=M(i),o=f(a),s=e===`entries`||e===Symbol.iterator&&o,c=e===`keys`&&o,l=i[e](...r),u=n?St:t?Kt:Gt;return!t&&tt(a,`iterate`,c?$e:Qe),{next(){let{value:e,done:t}=l.next();return t?{value:e,done:t}:{value:s?[u(e[0]),u(e[1])]:u(e),done:t}},[Symbol.iterator](){return this}}}}function Tt(e){return function(...t){return e===`delete`?!1:e===`clear`?void 0:this}}function Et(e,t){let n={get(n){let r=this.__v_raw,i=M(r),a=M(n);e||(oe(n,a)&&tt(i,`get`,n),tt(i,`get`,a));let{has:o}=Ct(i),s=t?St:e?Kt:Gt;if(o.call(i,n))return s(r.get(n));if(o.call(i,a))return s(r.get(a));r!==i&&r.get(n)},get size(){let t=this.__v_raw;return!e&&tt(M(t),`iterate`,Qe),t.size},has(t){let n=this.__v_raw,r=M(n),i=M(t);return e||(oe(t,i)&&tt(r,`has`,t),tt(r,`has`,i)),t===i?n.has(t):n.has(t)||n.has(i)},forEach(n,r){let i=this,a=i.__v_raw,o=M(a),s=t?St:e?Kt:Gt;return!e&&tt(o,`iterate`,Qe),a.forEach((e,t)=>n.call(r,s(e),s(t),i))}};return s(n,e?{add:Tt(`add`),set:Tt(`set`),delete:Tt(`delete`),clear:Tt(`clear`)}:{add(e){!t&&!Ht(e)&&!Vt(e)&&(e=M(e));let n=M(this);return Ct(n).has.call(n,e)||(n.add(e),nt(n,`add`,e,e)),this},set(e,n){!t&&!Ht(n)&&!Vt(n)&&(n=M(n));let r=M(this),{has:i,get:a}=Ct(r),o=i.call(r,e);o||=(e=M(e),i.call(r,e));let s=a.call(r,e);return r.set(e,n),o?oe(n,s)&&nt(r,`set`,e,n,s):nt(r,`add`,e,n),this},delete(e){let t=M(this),{has:n,get:r}=Ct(t),i=n.call(t,e);i||=(e=M(e),n.call(t,e));let a=r?r.call(t,e):void 0,o=t.delete(e);return i&&nt(t,`delete`,e,void 0,a),o},clear(){let e=M(this),t=e.size!==0,n=e.clear();return t&&nt(e,`clear`,void 0,void 0,void 0),n}}),[`keys`,`values`,`entries`,Symbol.iterator].forEach(r=>{n[r]=wt(r,e,t)}),n}function Dt(e,t){let n=Et(e,t);return(t,r,i)=>r===`__v_isReactive`?!e:r===`__v_isReadonly`?e:r===`__v_raw`?t:Reflect.get(u(n,r)&&r in t?n:t,r,i)}var Ot={get:Dt(!1,!1)},kt={get:Dt(!1,!0)},At={get:Dt(!0,!1)},jt=new WeakMap,Mt=new WeakMap,Nt=new WeakMap,Pt=new WeakMap;function Ft(e){switch(e){case`Object`:case`Array`:return 1;case`Map`:case`Set`:case`WeakMap`:case`WeakSet`:return 2;default:return 0}}function It(e){return e.__v_skip||!Object.isExtensible(e)?0:Ft(ee(e))}function Lt(e){return Vt(e)?e:zt(e,!1,yt,Ot,jt)}function Rt(e){return zt(e,!1,xt,kt,Mt)}function j(e){return zt(e,!0,bt,At,Nt)}function zt(e,t,n,r,i){if(!v(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;let a=It(e);if(a===0)return e;let o=i.get(e);if(o)return o;let s=new Proxy(e,a===2?r:n);return i.set(e,s),s}function Bt(e){return Vt(e)?Bt(e.__v_raw):!!(e&&e.__v_isReactive)}function Vt(e){return!!(e&&e.__v_isReadonly)}function Ht(e){return!!(e&&e.__v_isShallow)}function Ut(e){return e?!!e.__v_raw:!1}function M(e){let t=e&&e.__v_raw;return t?M(t):e}function Wt(e){return!u(e,`__v_skip`)&&Object.isExtensible(e)&&D(e,`__v_skip`,!0),e}var Gt=e=>v(e)?Lt(e):e,Kt=e=>v(e)?j(e):e;function N(e){return e?e.__v_isRef===!0:!1}function qt(e){return Jt(e,!1)}function Jt(e,t){return N(e)?e:new Yt(e,t)}var Yt=class{constructor(e,t){this.dep=new Ye,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:M(e),this._value=t?e:Gt(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){let t=this._rawValue,n=this.__v_isShallow||Ht(e)||Vt(e);e=n?e:M(e),oe(e,t)&&(this._rawValue=e,this._value=n?e:Gt(e),this.dep.trigger())}};function Xt(e){return N(e)?e.value:e}var Zt={get:(e,t,n)=>t===`__v_raw`?e:Xt(Reflect.get(e,t,n)),set:(e,t,n,r)=>{let i=e[t];return N(i)&&!N(n)?(i.value=n,!0):Reflect.set(e,t,n,r)}};function Qt(e){return Bt(e)?e:new Proxy(e,Zt)}var $t=class{constructor(e,t,n){this.fn=e,this.setter=t,this._value=void 0,this.dep=new Ye(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=qe-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&A!==this)return Ne(this,!0),!0}get value(){let e=this.dep.track();return ze(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}};function en(e,t,n=!1){let r,i;return h(e)?r=e:(r=e.get,i=e.set),new $t(r,i,n)}var tn={},nn=new WeakMap,rn=void 0;function an(e,t=!1,n=rn){if(n){let t=nn.get(n);t||nn.set(n,t=[]),t.push(e)}}function on(e,n,i=t){let{immediate:a,deep:o,once:s,scheduler:l,augmentJob:u,call:f}=i,p=e=>o?e:Ht(e)||o===!1||o===0?sn(e,1):sn(e),m,g,_,v,y=!1,b=!1;if(N(e)?(g=()=>e.value,y=Ht(e)):Bt(e)?(g=()=>p(e),y=!0):d(e)?(b=!0,y=e.some(e=>Bt(e)||Ht(e)),g=()=>e.map(e=>{if(N(e))return e.value;if(Bt(e))return p(e);if(h(e))return f?f(e,2):e()})):g=h(e)?n?f?()=>f(e,2):e:()=>{if(_){We();try{_()}finally{Ge()}}let t=rn;rn=m;try{return f?f(e,3,[v]):e(v)}finally{rn=t}}:r,n&&o){let e=g,t=o===!0?1/0:o;g=()=>sn(e(),t)}let x=De(),ee=()=>{m.stop(),x&&x.active&&c(x.effects,m)};if(s&&n){let e=n;n=(...t)=>{e(...t),ee()}}let te=b?Array(e.length).fill(tn):tn,S=e=>{if(!(!(m.flags&1)||!m.dirty&&!e))if(n){let e=m.run();if(o||y||(b?e.some((e,t)=>oe(e,te[t])):oe(e,te))){_&&_();let t=rn;rn=m;try{let t=[e,te===tn?void 0:b&&te[0]===tn?[]:te,v];te=e,f?f(n,3,t):n(...t)}finally{rn=t}}}else m.run()};return u&&u(S),m=new ke(g),m.scheduler=l?()=>l(S,!1):S,v=e=>an(e,!1,m),_=m.onStop=()=>{let e=nn.get(m);if(e){if(f)f(e,4);else for(let t of e)t();nn.delete(m)}},n?a?S(!0):te=m.run():l?l(S.bind(null,!0),!0):m.run(),ee.pause=m.pause.bind(m),ee.resume=m.resume.bind(m),ee.stop=ee,ee}function sn(e,t=1/0,n){if(t<=0||!v(e)||e.__v_skip||(n||=new Map,(n.get(e)||0)>=t))return e;if(n.set(e,t),t--,N(e))sn(e.value,t,n);else if(d(e))for(let r=0;r<e.length;r++)sn(e[r],t,n);else if(p(e)||f(e))e.forEach(e=>{sn(e,t,n)});else if(te(e)){for(let r in e)sn(e[r],t,n);for(let r of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,r)&&sn(e[r],t,n)}return e}function cn(e,t,n,r){try{return r?e(...r):e()}catch(e){un(e,t,n)}}function ln(e,t,n,r){if(h(e)){let i=cn(e,t,n,r);return i&&y(i)&&i.catch(e=>{un(e,t,n)}),i}if(d(e)){let i=[];for(let a=0;a<e.length;a++)i.push(ln(e[a],t,n,r));return i}}function un(e,n,r,i=!0){let a=n?n.vnode:null,{errorHandler:o,throwUnhandledErrorInProduction:s}=n&&n.appContext.config||t;if(n){let t=n.parent,i=n.proxy,a=`https://vuejs.org/error-reference/#runtime-${r}`;for(;t;){let n=t.ec;if(n){for(let t=0;t<n.length;t++)if(n[t](e,i,a)===!1)return}t=t.parent}if(o){We(),cn(o,null,10,[e,i,a]),Ge();return}}dn(e,r,a,i,s)}function dn(e,t,n,r=!0,i=!1){if(i)throw e;console.error(e)}var fn=[],P=-1,pn=[],mn=null,hn=0,gn=Promise.resolve(),_n=null;function vn(e){let t=_n||gn;return e?t.then(this?e.bind(this):e):t}function yn(e){let t=P+1,n=fn.length;for(;t<n;){let r=t+n>>>1,i=fn[r],a=Tn(i);a<e||a===e&&i.flags&2?t=r+1:n=r}return t}function bn(e){if(!(e.flags&1)){let t=Tn(e),n=fn[fn.length-1];!n||!(e.flags&2)&&t>=Tn(n)?fn.push(e):fn.splice(yn(t),0,e),e.flags|=1,xn()}}function xn(){_n||=gn.then(En)}function Sn(e){d(e)?pn.push(...e):mn&&e.id===-1?mn.splice(hn+1,0,e):e.flags&1||(pn.push(e),e.flags|=1),xn()}function Cn(e,t,n=P+1){for(;n<fn.length;n++){let t=fn[n];if(t&&t.flags&2){if(e&&t.id!==e.uid)continue;fn.splice(n,1),n--,t.flags&4&&(t.flags&=-2),t(),t.flags&4||(t.flags&=-2)}}}function wn(e){if(pn.length){let e=[...new Set(pn)].sort((e,t)=>Tn(e)-Tn(t));if(pn.length=0,mn){mn.push(...e);return}for(mn=e,hn=0;hn<mn.length;hn++){let e=mn[hn];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}mn=null,hn=0}}var Tn=e=>e.id==null?e.flags&2?-1:1/0:e.id;function En(e){try{for(P=0;P<fn.length;P++){let e=fn[P];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),cn(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;P<fn.length;P++){let e=fn[P];e&&(e.flags&=-2)}P=-1,fn.length=0,wn(e),_n=null,(fn.length||pn.length)&&En(e)}}var Dn=null,On=null;function kn(e){let t=Dn;return Dn=e,On=e&&e.type.__scopeId||null,t}function An(e,t=Dn,n){if(!t||e._n)return e;let r=(...n)=>{r._d&&Fi(-1);let i=kn(t),a;try{a=e(...n)}finally{kn(i),r._d&&Fi(1)}return a};return r._n=!0,r._c=!0,r._d=!0,r}function jn(e,n){if(Dn===null)return e;let r=ya(Dn),i=e.dirs||=[];for(let e=0;e<n.length;e++){let[a,o,s,c=t]=n[e];a&&(h(a)&&(a={mounted:a,updated:a}),a.deep&&sn(o),i.push({dir:a,instance:r,value:o,oldValue:void 0,arg:s,modifiers:c}))}return e}function Mn(e,t,n,r){let i=e.dirs,a=t&&t.dirs;for(let o=0;o<i.length;o++){let s=i[o];a&&(s.oldValue=a[o].value);let c=s.dir[r];c&&(We(),ln(c,n,8,[e.el,s,e,t]),Ge())}}function Nn(e,t){if(ra){let n=ra.provides,r=ra.parent&&ra.parent.provides;r===n&&(n=ra.provides=Object.create(r)),n[e]=t}}function Pn(e,t,n=!1){let r=ia();if(r||Rr){let i=Rr?Rr._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(i&&e in i)return i[e];if(arguments.length>1)return n&&h(t)?t.call(r&&r.proxy):t}}var Fn=Symbol.for(`v-scx`),In=()=>Pn(Fn);function Ln(e,t,n){return Rn(e,t,n)}function Rn(e,n,i=t){let{immediate:a,deep:o,flush:c,once:l}=i,u=s({},i),d=n&&a||!n&&c!==`post`,f;if(ua){if(c===`sync`){let e=In();f=e.__watcherHandles||=[]}else if(!d){let e=()=>{};return e.stop=r,e.resume=r,e.pause=r,e}}let p=ra;u.call=(e,t,n)=>ln(e,p,t,n);let m=!1;c===`post`?u.scheduler=e=>{mi(e,p&&p.suspense)}:c!==`sync`&&(m=!0,u.scheduler=(e,t)=>{t?e():bn(e)}),u.augmentJob=e=>{n&&(e.flags|=4),m&&(e.flags|=2,p&&(e.id=p.uid,e.i=p))};let h=on(e,n,u);return ua&&(f?f.push(h):d&&h()),h}function zn(e,t,n){let r=this.proxy,i=g(e)?e.includes(`.`)?Bn(r,e):()=>r[e]:e.bind(r,r),a;h(t)?a=t:(a=t.handler,n=t);let o=sa(this),s=Rn(i,a.bind(r),n);return o(),s}function Bn(e,t){let n=t.split(`.`);return()=>{let t=e;for(let e=0;e<n.length&&t;e++)t=t[n[e]];return t}}var Vn=Symbol(`_vte`),Hn=e=>e.__isTeleport,Un=Symbol(`_leaveCb`);function Wn(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Wn(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Gn(e){e.ids=[e.ids[0]+ e.ids[2]+++`-`,0,0]}var Kn=new WeakMap;function qn(e,n,r,a,o=!1){if(d(e)){e.forEach((e,t)=>qn(e,n&&(d(n)?n[t]:n),r,a,o));return}if(Yn(a)&&!o){a.shapeFlag&512&&a.type.__asyncResolved&&a.component.subTree.component&&qn(e,n,r,a.component.subTree);return}let s=a.shapeFlag&4?ya(a.component):a.el,l=o?null:s,{i:f,r:p}=e,m=n&&n.r,_=f.refs===t?f.refs={}:f.refs,v=f.setupState,y=M(v),b=v===t?i:e=>u(y,e),x=e=>!0;if(m!=null&&m!==p){if(Jn(n),g(m))_[m]=null,b(m)&&(v[m]=null);else if(N(m)){x(m)&&(m.value=null);let e=n;e.k&&(_[e.k]=null)}}if(h(p))cn(p,f,12,[l,_]);else{let t=g(p),n=N(p);if(t||n){let i=()=>{if(e.f){let n=t?b(p)?v[p]:_[p]:x(p)||!e.k?p.value:_[e.k];if(o)d(n)&&c(n,s);else if(d(n))n.includes(s)||n.push(s);else if(t)_[p]=[s],b(p)&&(v[p]=_[p]);else{let t=[s];x(p)&&(p.value=t),e.k&&(_[e.k]=t)}}else t?(_[p]=l,b(p)&&(v[p]=l)):n&&(x(p)&&(p.value=l),e.k&&(_[e.k]=l))};if(l){let t=()=>{i(),Kn.delete(e)};t.id=-1,Kn.set(e,t),mi(t,r)}else Jn(e),i()}}}function Jn(e){let t=Kn.get(e);t&&(t.flags|=8,Kn.delete(e))}ue().requestIdleCallback,ue().cancelIdleCallback;var Yn=e=>!!e.type.__asyncLoader,Xn=e=>e.type.__isKeepAlive;function Zn(e,t){$n(e,`a`,t)}function Qn(e,t){$n(e,`da`,t)}function $n(e,t,n=ra){let r=e.__wdc||=()=>{let t=n;for(;t;){if(t.isDeactivated)return;t=t.parent}return e()};if(tr(t,r,n),n){let e=n.parent;for(;e&&e.parent;)Xn(e.parent.vnode)&&er(r,t,n,e),e=e.parent}}function er(e,t,n,r){let i=tr(t,e,r,!0);cr(()=>{c(r[t],i)},n)}function tr(e,t,n=ra,r=!1){if(n){let i=n[e]||(n[e]=[]),a=t.__weh||=(...r)=>{We();let i=sa(n),a=ln(t,n,e,r);return i(),Ge(),a};return r?i.unshift(a):i.push(a),a}}var nr=e=>(t,n=ra)=>{(!ua||e===`sp`)&&tr(e,(...e)=>t(...e),n)},rr=nr(`bm`),ir=nr(`m`),ar=nr(`bu`),or=nr(`u`),sr=nr(`bum`),cr=nr(`um`),lr=nr(`sp`),ur=nr(`rtg`),dr=nr(`rtc`);function fr(e,t=ra){tr(`ec`,e,t)}var pr=Symbol.for(`v-ndc`);function mr(e,t,n,r){let i,a=n&&n[r],o=d(e);if(o||g(e)){let n=o&&Bt(e),r=!1,s=!1;n&&(r=!Ht(e),s=Vt(e),e=it(e)),i=Array(e.length);for(let n=0,o=e.length;n<o;n++)i[n]=t(r?s?Kt(Gt(e[n])):Gt(e[n]):e[n],n,void 0,a&&a[n])}else if(typeof e==`number`){i=Array(e);for(let n=0;n<e;n++)i[n]=t(n+1,n,void 0,a&&a[n])}else if(v(e))if(e[Symbol.iterator])i=Array.from(e,(e,n)=>t(e,n,void 0,a&&a[n]));else{let n=Object.keys(e);i=Array(n.length);for(let r=0,o=n.length;r<o;r++){let o=n[r];i[r]=t(e[o],o,r,a&&a[r])}}else i=[];return n&&(n[r]=i),i}var hr=e=>e?la(e)?ya(e):hr(e.parent):null,gr=s(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>hr(e.parent),$root:e=>hr(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Tr(e),$forceUpdate:e=>e.f||=()=>{bn(e.update)},$nextTick:e=>e.n||=vn.bind(e.proxy),$watch:e=>zn.bind(e)}),_r=(e,n)=>e!==t&&!e.__isScriptSetup&&u(e,n),vr={get({_:e},n){if(n===`__v_skip`)return!0;let{ctx:r,setupState:i,data:a,props:o,accessCache:s,type:c,appContext:l}=e;if(n[0]!==`$`){let e=s[n];if(e!==void 0)switch(e){case 1:return i[n];case 2:return a[n];case 4:return r[n];case 3:return o[n]}else if(_r(i,n))return s[n]=1,i[n];else if(a!==t&&u(a,n))return s[n]=2,a[n];else if(u(o,n))return s[n]=3,o[n];else if(r!==t&&u(r,n))return s[n]=4,r[n];else br&&(s[n]=0)}let d=gr[n],f,p;if(d)return n===`$attrs`&&tt(e.attrs,`get`,``),d(e);if((f=c.__cssModules)&&(f=f[n]))return f;if(r!==t&&u(r,n))return s[n]=4,r[n];if(p=l.config.globalProperties,u(p,n))return p[n]},set({_:e},n,r){let{data:i,setupState:a,ctx:o}=e;return _r(a,n)?(a[n]=r,!0):i!==t&&u(i,n)?(i[n]=r,!0):u(e.props,n)||n[0]===`$`&&n.slice(1)in e?!1:(o[n]=r,!0)},has({_:{data:e,setupState:n,accessCache:r,ctx:i,appContext:a,props:o,type:s}},c){let l;return!!(r[c]||e!==t&&c[0]!==`$`&&u(e,c)||_r(n,c)||u(o,c)||u(i,c)||u(gr,c)||u(a.config.globalProperties,c)||(l=s.__cssModules)&&l[c])},defineProperty(e,t,n){return n.get==null?u(n,`value`)&&this.set(e,t,n.value,null):e._.accessCache[t]=0,Reflect.defineProperty(e,t,n)}};function yr(e){return d(e)?e.reduce((e,t)=>(e[t]=null,e),{}):e}var br=!0;function xr(e){let t=Tr(e),n=e.proxy,i=e.ctx;br=!1,t.beforeCreate&&Cr(t.beforeCreate,e,`bc`);let{data:a,computed:o,methods:s,watch:c,provide:l,inject:u,created:f,beforeMount:p,mounted:m,beforeUpdate:g,updated:_,activated:y,deactivated:b,beforeDestroy:x,beforeUnmount:ee,destroyed:te,unmounted:S,render:ne,renderTracked:re,renderTriggered:C,errorCaptured:w,serverPrefetch:ie,expose:T,inheritAttrs:E,components:ae,directives:oe,filters:se}=t;if(u&&Sr(u,i,null),s)for(let e in s){let t=s[e];h(t)&&(i[e]=t.bind(n))}if(a){let t=a.call(n,n);v(t)&&(e.data=Lt(t))}if(br=!0,o)for(let e in o){let t=o[e],a=xa({get:h(t)?t.bind(n,n):h(t.get)?t.get.bind(n,n):r,set:!h(t)&&h(t.set)?t.set.bind(n):r});Object.defineProperty(i,e,{enumerable:!0,configurable:!0,get:()=>a.value,set:e=>a.value=e})}if(c)for(let e in c)wr(c[e],i,n,e);if(l){let e=h(l)?l.call(n):l;Reflect.ownKeys(e).forEach(t=>{Nn(t,e[t])})}f&&Cr(f,e,`c`);function D(e,t){d(t)?t.forEach(t=>e(t.bind(n))):t&&e(t.bind(n))}if(D(rr,p),D(ir,m),D(ar,g),D(or,_),D(Zn,y),D(Qn,b),D(fr,w),D(dr,re),D(ur,C),D(sr,ee),D(cr,S),D(lr,ie),d(T))if(T.length){let t=e.exposed||={};T.forEach(e=>{Object.defineProperty(t,e,{get:()=>n[e],set:t=>n[e]=t,enumerable:!0})})}else e.exposed||={};ne&&e.render===r&&(e.render=ne),E!=null&&(e.inheritAttrs=E),ae&&(e.components=ae),oe&&(e.directives=oe),ie&&Gn(e)}function Sr(e,t,n=r){for(let n in d(e)&&(e=Ar(e)),e){let r=e[n],i;i=v(r)?`default`in r?Pn(r.from||n,r.default,!0):Pn(r.from||n):Pn(r),N(i)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:e=>i.value=e}):t[n]=i}}function Cr(e,t,n){ln(d(e)?e.map(e=>e.bind(t.proxy)):e.bind(t.proxy),t,n)}function wr(e,t,n,r){let i=r.includes(`.`)?Bn(n,r):()=>n[r];if(g(e)){let n=t[e];h(n)&&Ln(i,n)}else if(h(e))Ln(i,e.bind(n));else if(v(e))if(d(e))e.forEach(e=>wr(e,t,n,r));else{let r=h(e.handler)?e.handler.bind(n):t[e.handler];h(r)&&Ln(i,r,e)}}function Tr(e){let t=e.type,{mixins:n,extends:r}=t,{mixins:i,optionsCache:a,config:{optionMergeStrategies:o}}=e.appContext,s=a.get(t),c;return s?c=s:!i.length&&!n&&!r?c=t:(c={},i.length&&i.forEach(e=>Er(c,e,o,!0)),Er(c,t,o)),v(t)&&a.set(t,c),c}function Er(e,t,n,r=!1){let{mixins:i,extends:a}=t;for(let o in a&&Er(e,a,n,!0),i&&i.forEach(t=>Er(e,t,n,!0)),t)if(!(r&&o===`expose`)){let r=Dr[o]||n&&n[o];e[o]=r?r(e[o],t[o]):t[o]}return e}var Dr={data:Or,props:Nr,emits:Nr,methods:Mr,computed:Mr,beforeCreate:jr,created:jr,beforeMount:jr,mounted:jr,beforeUpdate:jr,updated:jr,beforeDestroy:jr,beforeUnmount:jr,destroyed:jr,unmounted:jr,activated:jr,deactivated:jr,errorCaptured:jr,serverPrefetch:jr,components:Mr,directives:Mr,watch:Pr,provide:Or,inject:kr};function Or(e,t){return t?e?function(){return s(h(e)?e.call(this,this):e,h(t)?t.call(this,this):t)}:t:e}function kr(e,t){return Mr(Ar(e),Ar(t))}function Ar(e){if(d(e)){let t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function jr(e,t){return e?[...new Set([].concat(e,t))]:t}function Mr(e,t){return e?s(Object.create(null),e,t):t}function Nr(e,t){return e?d(e)&&d(t)?[...new Set([...e,...t])]:s(Object.create(null),yr(e),yr(t??{})):t}function Pr(e,t){if(!e)return t;if(!t)return e;let n=s(Object.create(null),e);for(let r in t)n[r]=jr(e[r],t[r]);return n}function Fr(){return{app:null,config:{isNativeTag:i,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}var Ir=0;function Lr(e,t){return function(n,r=null){h(n)||(n=s({},n)),r!=null&&!v(r)&&(r=null);let i=Fr(),a=new WeakSet,o=[],c=!1,l=i.app={_uid:Ir++,_component:n,_props:r,_container:null,_context:i,_instance:null,version:Sa,get config(){return i.config},set config(e){},use(e,...t){return a.has(e)||(e&&h(e.install)?(a.add(e),e.install(l,...t)):h(e)&&(a.add(e),e(l,...t))),l},mixin(e){return i.mixins.includes(e)||i.mixins.push(e),l},component(e,t){return t?(i.components[e]=t,l):i.components[e]},directive(e,t){return t?(i.directives[e]=t,l):i.directives[e]},mount(a,o,s){if(!c){let u=l._ceVNode||Hi(n,r);return u.appContext=i,s===!0?s=`svg`:s===!1&&(s=void 0),o&&t?t(u,a):e(u,a,s),c=!0,l._container=a,a.__vue_app__=l,ya(u.component)}},onUnmount(e){o.push(e)},unmount(){c&&(ln(o,l._instance,16),e(null,l._container),delete l._container.__vue_app__)},provide(e,t){return i.provides[e]=t,l},runWithContext(e){let t=Rr;Rr=l;try{return e()}finally{Rr=t}}};return l}}var Rr=null,zr=(e,t)=>t===`modelValue`||t===`model-value`?e.modelModifiers:e[`${t}Modifiers`]||e[`${w(t)}Modifiers`]||e[`${T(t)}Modifiers`];function Br(e,n,...r){if(e.isUnmounted)return;let i=e.vnode.props||t,a=r,o=n.startsWith(`update:`),s=o&&zr(i,n.slice(7));s&&(s.trim&&(a=r.map(e=>g(e)?e.trim():e)),s.number&&(a=r.map(ce)));let c,l=i[c=ae(n)]||i[c=ae(w(n))];!l&&o&&(l=i[c=ae(T(n))]),l&&ln(l,e,6,a);let u=i[c+`Once`];if(u){if(!e.emitted)e.emitted={};else if(e.emitted[c])return;e.emitted[c]=!0,ln(u,e,6,a)}}var Vr=new WeakMap;function Hr(e,t,n=!1){let r=n?Vr:t.emitsCache,i=r.get(e);if(i!==void 0)return i;let a=e.emits,o={},c=!1;if(!h(e)){let r=e=>{let n=Hr(e,t,!0);n&&(c=!0,s(o,n))};!n&&t.mixins.length&&t.mixins.forEach(r),e.extends&&r(e.extends),e.mixins&&e.mixins.forEach(r)}return!a&&!c?(v(e)&&r.set(e,null),null):(d(a)?a.forEach(e=>o[e]=null):s(o,a),v(e)&&r.set(e,o),o)}function Ur(e,t){return!e||!a(t)?!1:(t=t.slice(2).replace(/Once$/,``),u(e,t[0].toLowerCase()+t.slice(1))||u(e,T(t))||u(e,t))}function Wr(e){let{type:t,vnode:n,proxy:r,withProxy:i,propsOptions:[a],slots:s,attrs:c,emit:l,render:u,renderCache:d,props:f,data:p,setupState:m,ctx:h,inheritAttrs:g}=e,_=kn(e),v,y;try{if(n.shapeFlag&4){let e=i||r,t=e;v=Yi(u.call(t,e,d,f,m,p,h)),y=c}else{let e=t;v=Yi(e.length>1?e(f,{attrs:c,slots:s,emit:l}):e(f,null)),y=t.props?c:Gr(c)}}catch(t){ji.length=0,un(t,e,1),v=Hi(ki)}let b=v;if(y&&g!==!1){let e=Object.keys(y),{shapeFlag:t}=b;e.length&&t&7&&(a&&e.some(o)&&(y=Kr(y,a)),b=Gi(b,y,!1,!0))}return n.dirs&&(b=Gi(b,null,!1,!0),b.dirs=b.dirs?b.dirs.concat(n.dirs):n.dirs),n.transition&&Wn(b,n.transition),v=b,kn(_),v}var Gr=e=>{let t;for(let n in e)(n===`class`||n===`style`||a(n))&&((t||={})[n]=e[n]);return t},Kr=(e,t)=>{let n={};for(let r in e)(!o(r)||!(r.slice(9)in t))&&(n[r]=e[r]);return n};function qr(e,t,n){let{props:r,children:i,component:a}=e,{props:o,children:s,patchFlag:c}=t,l=a.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return r?Jr(r,o,l):!!o;if(c&8){let e=t.dynamicProps;for(let t=0;t<e.length;t++){let n=e[t];if(o[n]!==r[n]&&!Ur(l,n))return!0}}}else return(i||s)&&(!s||!s.$stable)?!0:r===o?!1:r?o?Jr(r,o,l):!0:!!o;return!1}function Jr(e,t,n){let r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let i=0;i<r.length;i++){let a=r[i];if(t[a]!==e[a]&&!Ur(n,a))return!0}return!1}function Yr({vnode:e,parent:t},n){for(;t;){let r=t.subTree;if(r.suspense&&r.suspense.activeBranch===e&&(r.el=e.el),r===e)(e=t.vnode).el=n,t=t.parent;else break}}var Xr={},Zr=()=>Object.create(Xr),Qr=e=>Object.getPrototypeOf(e)===Xr;function $r(e,t,n,r=!1){let i={},a=Zr();for(let n in e.propsDefaults=Object.create(null),ti(e,t,i,a),e.propsOptions[0])n in i||(i[n]=void 0);n?e.props=r?i:Rt(i):e.type.props?e.props=i:e.props=a,e.attrs=a}function ei(e,t,n,r){let{props:i,attrs:a,vnode:{patchFlag:o}}=e,s=M(i),[c]=e.propsOptions,l=!1;if((r||o>0)&&!(o&16)){if(o&8){let n=e.vnode.dynamicProps;for(let r=0;r<n.length;r++){let o=n[r];if(Ur(e.emitsOptions,o))continue;let d=t[o];if(c)if(u(a,o))d!==a[o]&&(a[o]=d,l=!0);else{let t=w(o);i[t]=ni(c,s,t,d,e,!1)}else d!==a[o]&&(a[o]=d,l=!0)}}}else{ti(e,t,i,a)&&(l=!0);let r;for(let a in s)(!t||!u(t,a)&&((r=T(a))===a||!u(t,r)))&&(c?n&&(n[a]!==void 0||n[r]!==void 0)&&(i[a]=ni(c,s,a,void 0,e,!0)):delete i[a]);if(a!==s)for(let e in a)(!t||!u(t,e))&&(delete a[e],l=!0)}l&&nt(e.attrs,`set`,``)}function ti(e,n,r,i){let[a,o]=e.propsOptions,s=!1,c;if(n)for(let t in n){if(ne(t))continue;let l=n[t],d;a&&u(a,d=w(t))?!o||!o.includes(d)?r[d]=l:(c||={})[d]=l:Ur(e.emitsOptions,t)||(!(t in i)||l!==i[t])&&(i[t]=l,s=!0)}if(o){let n=M(r),i=c||t;for(let t=0;t<o.length;t++){let s=o[t];r[s]=ni(a,n,s,i[s],e,!u(i,s))}}return s}function ni(e,t,n,r,i,a){let o=e[n];if(o!=null){let e=u(o,`default`);if(e&&r===void 0){let e=o.default;if(o.type!==Function&&!o.skipFactory&&h(e)){let{propsDefaults:a}=i;if(n in a)r=a[n];else{let o=sa(i);r=a[n]=e.call(null,t),o()}}else r=e;i.ce&&i.ce._setProp(n,r)}o[0]&&(a&&!e?r=!1:o[1]&&(r===``||r===T(n))&&(r=!0))}return r}var ri=new WeakMap;function ii(e,r,i=!1){let a=i?ri:r.propsCache,o=a.get(e);if(o)return o;let c=e.props,l={},f=[],p=!1;if(!h(e)){let t=e=>{p=!0;let[t,n]=ii(e,r,!0);s(l,t),n&&f.push(...n)};!i&&r.mixins.length&&r.mixins.forEach(t),e.extends&&t(e.extends),e.mixins&&e.mixins.forEach(t)}if(!c&&!p)return v(e)&&a.set(e,n),n;if(d(c))for(let e=0;e<c.length;e++){let n=w(c[e]);ai(n)&&(l[n]=t)}else if(c)for(let e in c){let t=w(e);if(ai(t)){let n=c[e],r=l[t]=d(n)||h(n)?{type:n}:s({},n),i=r.type,a=!1,o=!0;if(d(i))for(let e=0;e<i.length;++e){let t=i[e],n=h(t)&&t.name;if(n===`Boolean`){a=!0;break}else n===`String`&&(o=!1)}else a=h(i)&&i.name===`Boolean`;r[0]=a,r[1]=o,(a||u(r,`default`))&&f.push(t)}}let m=[l,f];return v(e)&&a.set(e,m),m}function ai(e){return e[0]!==`$`&&!ne(e)}var oi=e=>e===`_`||e===`_ctx`||e===`$stable`,si=e=>d(e)?e.map(Yi):[Yi(e)],ci=(e,t,n)=>{if(t._n)return t;let r=An((...e)=>si(t(...e)),n);return r._c=!1,r},li=(e,t,n)=>{let r=e._ctx;for(let n in e){if(oi(n))continue;let i=e[n];if(h(i))t[n]=ci(n,i,r);else if(i!=null){let e=si(i);t[n]=()=>e}}},ui=(e,t)=>{let n=si(t);e.slots.default=()=>n},di=(e,t,n)=>{for(let r in t)(n||!oi(r))&&(e[r]=t[r])},fi=(e,t,n)=>{let r=e.slots=Zr();if(e.vnode.shapeFlag&32){let e=t._;e?(di(r,t,n),n&&D(r,`_`,e,!0)):li(t,r)}else t&&ui(e,t)},pi=(e,n,r)=>{let{vnode:i,slots:a}=e,o=!0,s=t;if(i.shapeFlag&32){let e=n._;e?r&&e===1?o=!1:di(a,n,r):(o=!n.$stable,li(n,a)),s=n}else n&&(ui(e,n),s={default:1});if(o)for(let e in a)!oi(e)&&s[e]==null&&delete a[e]},mi=Ei;function hi(e){return gi(e)}function gi(e,i){let a=ue();a.__VUE__=!0;let{insert:o,remove:s,patchProp:c,createElement:l,createText:u,createComment:d,setText:f,setElementText:p,parentNode:m,nextSibling:h,setScopeId:g=r,insertStaticContent:_}=e,v=(e,t,n,r=null,i=null,a=null,o=void 0,s=null,c=!!t.dynamicChildren)=>{if(e===t)return;e&&!zi(e,t)&&(r=be(e),he(e,i,a,!0),e=null),t.patchFlag===-2&&(c=!1,t.dynamicChildren=null);let{type:l,ref:u,shapeFlag:d}=t;switch(l){case Oi:y(e,t,n,r);break;case ki:b(e,t,n,r);break;case Ai:e??x(t,n,r,o);break;case Di:ae(e,t,n,r,i,a,o,s,c);break;default:d&1?S(e,t,n,r,i,a,o,s,c):d&6?oe(e,t,n,r,i,a,o,s,c):(d&64||d&128)&&l.process(e,t,n,r,i,a,o,s,c,k)}u!=null&&i?qn(u,e&&e.ref,a,t||e,!t):u==null&&e&&e.ref!=null&&qn(e.ref,null,a,e,!0)},y=(e,t,n,r)=>{if(e==null)o(t.el=u(t.children),n,r);else{let n=t.el=e.el;t.children!==e.children&&f(n,t.children)}},b=(e,t,n,r)=>{e==null?o(t.el=d(t.children||``),n,r):t.el=e.el},x=(e,t,n,r)=>{[e.el,e.anchor]=_(e.children,t,n,r,e.el,e.anchor)},ee=({el:e,anchor:t},n,r)=>{let i;for(;e&&e!==t;)i=h(e),o(e,n,r),e=i;o(t,n,r)},te=({el:e,anchor:t})=>{let n;for(;e&&e!==t;)n=h(e),s(e),e=n;s(t)},S=(e,t,n,r,i,a,o,s,c)=>{if(t.type===`svg`?o=`svg`:t.type===`math`&&(o=`mathml`),e==null)re(t,n,r,i,a,o,s,c);else{let n=e.el&&e.el._isVueCE?e.el:null;try{n&&n._beginPatch(),ie(e,t,i,a,o,s,c)}finally{n&&n._endPatch()}}},re=(e,t,n,r,i,a,s,u)=>{let d,f,{props:m,shapeFlag:h,transition:g,dirs:_}=e;if(d=e.el=l(e.type,a,m&&m.is,m),h&8?p(d,e.children):h&16&&w(e.children,d,null,r,i,_i(e,a),s,u),_&&Mn(e,null,r,`created`),C(d,e,e.scopeId,s,r),m){for(let e in m)e!==`value`&&!ne(e)&&c(d,e,null,m[e],a,r);`value`in m&&c(d,`value`,null,m.value,a),(f=m.onVnodeBeforeMount)&&$i(f,r,e)}_&&Mn(e,null,r,`beforeMount`);let v=yi(i,g);v&&g.beforeEnter(d),o(d,t,n),((f=m&&m.onVnodeMounted)||v||_)&&mi(()=>{f&&$i(f,r,e),v&&g.enter(d),_&&Mn(e,null,r,`mounted`)},i)},C=(e,t,n,r,i)=>{if(n&&g(e,n),r)for(let t=0;t<r.length;t++)g(e,r[t]);if(i){let n=i.subTree;if(t===n||Ti(n.type)&&(n.ssContent===t||n.ssFallback===t)){let t=i.vnode;C(e,t,t.scopeId,t.slotScopeIds,i.parent)}}},w=(e,t,n,r,i,a,o,s,c=0)=>{for(let l=c;l<e.length;l++)v(null,e[l]=s?Xi(e[l]):Yi(e[l]),t,n,r,i,a,o,s)},ie=(e,n,r,i,a,o,s)=>{let l=n.el=e.el,{patchFlag:u,dynamicChildren:d,dirs:f}=n;u|=e.patchFlag&16;let m=e.props||t,h=n.props||t,g;if(r&&vi(r,!1),(g=h.onVnodeBeforeUpdate)&&$i(g,r,n,e),f&&Mn(n,e,r,`beforeUpdate`),r&&vi(r,!0),(m.innerHTML&&h.innerHTML==null||m.textContent&&h.textContent==null)&&p(l,``),d?T(e.dynamicChildren,d,l,r,i,_i(n,a),o):s||fe(e,n,l,null,r,i,_i(n,a),o,!1),u>0){if(u&16)E(l,m,h,r,a);else if(u&2&&m.class!==h.class&&c(l,`class`,null,h.class,a),u&4&&c(l,`style`,m.style,h.style,a),u&8){let e=n.dynamicProps;for(let t=0;t<e.length;t++){let n=e[t],i=m[n],o=h[n];(o!==i||n===`value`)&&c(l,n,i,o,a,r)}}u&1&&e.children!==n.children&&p(l,n.children)}else !s&&d==null&&E(l,m,h,r,a);((g=h.onVnodeUpdated)||f)&&mi(()=>{g&&$i(g,r,n,e),f&&Mn(n,e,r,`updated`)},i)},T=(e,t,n,r,i,a,o)=>{for(let s=0;s<t.length;s++){let c=e[s],l=t[s];v(c,l,c.el&&(c.type===Di||!zi(c,l)||c.shapeFlag&198)?m(c.el):n,null,r,i,a,o,!0)}},E=(e,n,r,i,a)=>{if(n!==r){if(n!==t)for(let t in n)!ne(t)&&!(t in r)&&c(e,t,n[t],null,a,i);for(let t in r){if(ne(t))continue;let o=r[t],s=n[t];o!==s&&t!==`value`&&c(e,t,s,o,a,i)}`value`in r&&c(e,`value`,n.value,r.value,a)}},ae=(e,t,n,r,i,a,s,c,l)=>{let d=t.el=e?e.el:u(``),f=t.anchor=e?e.anchor:u(``),{patchFlag:p,dynamicChildren:m,slotScopeIds:h}=t;h&&(c=c?c.concat(h):h),e==null?(o(d,n,r),o(f,n,r),w(t.children||[],n,f,i,a,s,c,l)):p>0&&p&64&&m&&e.dynamicChildren&&e.dynamicChildren.length===m.length?(T(e.dynamicChildren,m,n,i,a,s,c),(t.key!=null||i&&t===i.subTree)&&bi(e,t,!0)):fe(e,t,n,f,i,a,s,c,l)},oe=(e,t,n,r,i,a,o,s,c)=>{t.slotScopeIds=s,e==null?t.shapeFlag&512?i.ctx.activate(t,n,r,o,c):D(t,n,r,i,a,o,c):ce(e,t,c)},D=(e,t,n,r,i,a,o)=>{let s=e.component=na(e,r,i);if(Xn(e)&&(s.ctx.renderer=k),da(s,!1,o),s.asyncDep){if(i&&i.registerDep(s,le,o),!e.el){let r=s.subTree=Hi(ki);b(null,r,t,n),e.placeholder=r.el}}else le(s,e,t,n,i,a,o)},ce=(e,t,n)=>{let r=t.component=e.component;if(qr(e,t,n))if(r.asyncDep&&!r.asyncResolved){de(r,t,n);return}else r.next=t,r.update();else t.el=e.el,r.vnode=t},le=(e,t,n,r,i,a,o)=>{let s=()=>{if(e.isMounted){let{next:t,bu:n,u:r,parent:c,vnode:l}=e;{let n=Si(e);if(n){t&&(t.el=l.el,de(e,t,o)),n.asyncDep.then(()=>{e.isUnmounted||s()});return}}let u=t,d;vi(e,!1),t?(t.el=l.el,de(e,t,o)):t=l,n&&se(n),(d=t.props&&t.props.onVnodeBeforeUpdate)&&$i(d,c,t,l),vi(e,!0);let f=Wr(e),p=e.subTree;e.subTree=f,v(p,f,m(p.el),be(p),e,i,a),t.el=f.el,u===null&&Yr(e,f.el),r&&mi(r,i),(d=t.props&&t.props.onVnodeUpdated)&&mi(()=>$i(d,c,t,l),i)}else{let o,{el:s,props:c}=t,{bm:l,m:u,parent:d,root:f,type:p}=e,m=Yn(t);if(vi(e,!1),l&&se(l),!m&&(o=c&&c.onVnodeBeforeMount)&&$i(o,d,t),vi(e,!0),s&&we){let t=()=>{e.subTree=Wr(e),we(s,e.subTree,e,i,null)};m&&p.__asyncHydrate?p.__asyncHydrate(s,e,t):t()}else{f.ce&&f.ce._def.shadowRoot!==!1&&f.ce._injectChildStyle(p);let o=e.subTree=Wr(e);v(null,o,n,r,e,i,a),t.el=o.el}if(u&&mi(u,i),!m&&(o=c&&c.onVnodeMounted)){let e=t;mi(()=>$i(o,d,e),i)}(t.shapeFlag&256||d&&Yn(d.vnode)&&d.vnode.shapeFlag&256)&&e.a&&mi(e.a,i),e.isMounted=!0,t=n=r=null}};e.scope.on();let c=e.effect=new ke(s);e.scope.off();let l=e.update=c.run.bind(c),u=e.job=c.runIfDirty.bind(c);u.i=e,u.id=e.uid,c.scheduler=()=>bn(u),vi(e,!0),l()},de=(e,t,n)=>{t.component=e;let r=e.vnode.props;e.vnode=t,e.next=null,ei(e,t.props,r,n),pi(e,t.children,n),We(),Cn(e),Ge()},fe=(e,t,n,r,i,a,o,s,c=!1)=>{let l=e&&e.children,u=e?e.shapeFlag:0,d=t.children,{patchFlag:f,shapeFlag:m}=t;if(f>0){if(f&128){O(l,d,n,r,i,a,o,s,c);return}else if(f&256){pe(l,d,n,r,i,a,o,s,c);return}}m&8?(u&16&&ye(l,i,a),d!==l&&p(n,d)):u&16?m&16?O(l,d,n,r,i,a,o,s,c):ye(l,i,a,!0):(u&8&&p(n,``),m&16&&w(d,n,r,i,a,o,s,c))},pe=(e,t,r,i,a,o,s,c,l)=>{e||=n,t||=n;let u=e.length,d=t.length,f=Math.min(u,d),p;for(p=0;p<f;p++){let n=t[p]=l?Xi(t[p]):Yi(t[p]);v(e[p],n,r,null,a,o,s,c,l)}u>d?ye(e,a,o,!0,!1,f):w(t,r,i,a,o,s,c,l,f)},O=(e,t,r,i,a,o,s,c,l)=>{let u=0,d=t.length,f=e.length-1,p=d-1;for(;u<=f&&u<=p;){let n=e[u],i=t[u]=l?Xi(t[u]):Yi(t[u]);if(zi(n,i))v(n,i,r,null,a,o,s,c,l);else break;u++}for(;u<=f&&u<=p;){let n=e[f],i=t[p]=l?Xi(t[p]):Yi(t[p]);if(zi(n,i))v(n,i,r,null,a,o,s,c,l);else break;f--,p--}if(u>f){if(u<=p){let e=p+1,n=e<d?t[e].el:i;for(;u<=p;)v(null,t[u]=l?Xi(t[u]):Yi(t[u]),r,n,a,o,s,c,l),u++}}else if(u>p)for(;u<=f;)he(e[u],a,o,!0),u++;else{let m=u,h=u,g=new Map;for(u=h;u<=p;u++){let e=t[u]=l?Xi(t[u]):Yi(t[u]);e.key!=null&&g.set(e.key,u)}let _,y=0,b=p-h+1,x=!1,ee=0,te=Array(b);for(u=0;u<b;u++)te[u]=0;for(u=m;u<=f;u++){let n=e[u];if(y>=b){he(n,a,o,!0);continue}let i;if(n.key!=null)i=g.get(n.key);else for(_=h;_<=p;_++)if(te[_-h]===0&&zi(n,t[_])){i=_;break}i===void 0?he(n,a,o,!0):(te[i-h]=u+1,i>=ee?ee=i:x=!0,v(n,t[i],r,null,a,o,s,c,l),y++)}let S=x?xi(te):n;for(_=S.length-1,u=b-1;u>=0;u--){let e=h+u,n=t[e],f=t[e+1],p=e+1<d?f.el||wi(f):i;te[u]===0?v(null,n,r,p,a,o,s,c,l):x&&(_<0||u!==S[_]?me(n,r,p,2):_--)}}},me=(e,t,n,r,i=null)=>{let{el:a,type:c,transition:l,children:u,shapeFlag:d}=e;if(d&6){me(e.component.subTree,t,n,r);return}if(d&128){e.suspense.move(t,n,r);return}if(d&64){c.move(e,t,n,k);return}if(c===Di){o(a,t,n);for(let e=0;e<u.length;e++)me(u[e],t,n,r);o(e.anchor,t,n);return}if(c===Ai){ee(e,t,n);return}if(r!==2&&d&1&&l)if(r===0)l.beforeEnter(a),o(a,t,n),mi(()=>l.enter(a),i);else{let{leave:r,delayLeave:i,afterLeave:c}=l,u=()=>{e.ctx.isUnmounted?s(a):o(a,t,n)},d=()=>{a._isLeaving&&a[Un](!0),r(a,()=>{u(),c&&c()})};i?i(a,u,d):d()}else o(a,t,n)},he=(e,t,n,r=!1,i=!1)=>{let{type:a,props:o,ref:s,children:c,dynamicChildren:l,shapeFlag:u,patchFlag:d,dirs:f,cacheIndex:p}=e;if(d===-2&&(i=!1),s!=null&&(We(),qn(s,null,n,e,!0),Ge()),p!=null&&(t.renderCache[p]=void 0),u&256){t.ctx.deactivate(e);return}let m=u&1&&f,h=!Yn(e),g;if(h&&(g=o&&o.onVnodeBeforeUnmount)&&$i(g,t,e),u&6)ve(e.component,n,r);else{if(u&128){e.suspense.unmount(n,r);return}m&&Mn(e,null,t,`beforeUnmount`),u&64?e.type.remove(e,t,n,k,r):l&&!l.hasOnce&&(a!==Di||d>0&&d&64)?ye(l,t,n,!1,!0):(a===Di&&d&384||!i&&u&16)&&ye(c,t,n),r&&ge(e)}(h&&(g=o&&o.onVnodeUnmounted)||m)&&mi(()=>{g&&$i(g,t,e),m&&Mn(e,null,t,`unmounted`)},n)},ge=e=>{let{type:t,el:n,anchor:r,transition:i}=e;if(t===Di){_e(n,r);return}if(t===Ai){te(e);return}let a=()=>{s(n),i&&!i.persisted&&i.afterLeave&&i.afterLeave()};if(e.shapeFlag&1&&i&&!i.persisted){let{leave:t,delayLeave:r}=i,o=()=>t(n,a);r?r(e.el,a,o):o()}else a()},_e=(e,t)=>{let n;for(;e!==t;)n=h(e),s(e),e=n;s(t)},ve=(e,t,n)=>{let{bum:r,scope:i,job:a,subTree:o,um:s,m:c,a:l}=e;Ci(c),Ci(l),r&&se(r),i.stop(),a&&(a.flags|=8,he(o,e,t,n)),s&&mi(s,t),mi(()=>{e.isUnmounted=!0},t)},ye=(e,t,n,r=!1,i=!1,a=0)=>{for(let o=a;o<e.length;o++)he(e[o],t,n,r,i)},be=e=>{if(e.shapeFlag&6)return be(e.component.subTree);if(e.shapeFlag&128)return e.suspense.next();let t=h(e.anchor||e.el),n=t&&t[Vn];return n?h(n):t},xe=!1,Se=(e,t,n)=>{let r;e==null?t._vnode&&(he(t._vnode,null,null,!0),r=t._vnode.component):v(t._vnode||null,e,t,null,null,null,n),t._vnode=e,xe||=(xe=!0,Cn(r),wn(),!1)},k={p:v,um:he,m:me,r:ge,mt:D,mc:w,pc:fe,pbc:T,n:be,o:e},Ce,we;return i&&([Ce,we]=i(k)),{render:Se,hydrate:Ce,createApp:Lr(Se,Ce)}}function _i({type:e,props:t},n){return n===`svg`&&e===`foreignObject`||n===`mathml`&&e===`annotation-xml`&&t&&t.encoding&&t.encoding.includes(`html`)?void 0:n}function vi({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function yi(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function bi(e,t,n=!1){let r=e.children,i=t.children;if(d(r)&&d(i))for(let t=0;t<r.length;t++){let a=r[t],o=i[t];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=i[t]=Xi(i[t]),o.el=a.el),!n&&o.patchFlag!==-2&&bi(a,o)),o.type===Oi&&(o.patchFlag===-1?o.__elIndex=t+(e.type===Di?1:0):o.el=a.el),o.type===ki&&!o.el&&(o.el=a.el)}}function xi(e){let t=e.slice(),n=[0],r,i,a,o,s,c=e.length;for(r=0;r<c;r++){let c=e[r];if(c!==0){if(i=n[n.length-1],e[i]<c){t[r]=i,n.push(r);continue}for(a=0,o=n.length-1;a<o;)s=a+o>>1,e[n[s]]<c?a=s+1:o=s;c<e[n[a]]&&(a>0&&(t[r]=n[a-1]),n[a]=r)}}for(a=n.length,o=n[a-1];a-- >0;)n[a]=o,o=t[o];return n}function Si(e){let t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Si(t)}function Ci(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function wi(e){if(e.placeholder)return e.placeholder;let t=e.component;return t?wi(t.subTree):null}var Ti=e=>e.__isSuspense;function Ei(e,t){t&&t.pendingBranch?d(e)?t.effects.push(...e):t.effects.push(e):Sn(e)}var Di=Symbol.for(`v-fgt`),Oi=Symbol.for(`v-txt`),ki=Symbol.for(`v-cmt`),Ai=Symbol.for(`v-stc`),ji=[],Mi=null;function F(e=!1){ji.push(Mi=e?null:[])}function Ni(){ji.pop(),Mi=ji[ji.length-1]||null}var Pi=1;function Fi(e,t=!1){Pi+=e,e<0&&Mi&&t&&(Mi.hasOnce=!0)}function Ii(e){return e.dynamicChildren=Pi>0?Mi||n:null,Ni(),Pi>0&&Mi&&Mi.push(e),e}function I(e,t,n,r,i,a){return Ii(L(e,t,n,r,i,a,!0))}function Li(e,t,n,r,i){return Ii(Hi(e,t,n,r,i,!0))}function Ri(e){return e?e.__v_isVNode===!0:!1}function zi(e,t){return e.type===t.type&&e.key===t.key}var Bi=({key:e})=>e??null,Vi=({ref:e,ref_key:t,ref_for:n})=>(typeof e==`number`&&(e=``+e),e==null?null:g(e)||N(e)||h(e)?{i:Dn,r:e,k:t,f:!!n}:e);function L(e,t=null,n=null,r=0,i=null,a=e===Di?0:1,o=!1,s=!1){let c={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Bi(t),ref:t&&Vi(t),scopeId:On,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Dn};return s?(Zi(c,n),a&128&&e.normalize(c)):n&&(c.shapeFlag|=g(n)?8:16),Pi>0&&!o&&Mi&&(c.patchFlag>0||a&6)&&c.patchFlag!==32&&Mi.push(c),c}var Hi=Ui;function Ui(e,t=null,n=null,r=0,i=null,a=!1){if((!e||e===pr)&&(e=ki),Ri(e)){let r=Gi(e,t,!0);return n&&Zi(r,n),Pi>0&&!a&&Mi&&(r.shapeFlag&6?Mi[Mi.indexOf(e)]=r:Mi.push(r)),r.patchFlag=-2,r}if(ba(e)&&(e=e.__vccOpts),t){t=Wi(t);let{class:e,style:n}=t;e&&!g(e)&&(t.class=he(e)),v(n)&&(Ut(n)&&!d(n)&&(n=s({},n)),t.style=de(n))}let o=g(e)?1:Ti(e)?128:Hn(e)?64:v(e)?4:h(e)?2:0;return L(e,t,n,r,i,o,a,!0)}function Wi(e){return e?Ut(e)||Qr(e)?s({},e):e:null}function Gi(e,t,n=!1,r=!1){let{props:i,ref:a,patchFlag:o,children:s,transition:c}=e,l=t?Qi(i||{},t):i,u={__v_isVNode:!0,__v_skip:!0,type:e.type,props:l,key:l&&Bi(l),ref:t&&t.ref?n&&a?d(a)?a.concat(Vi(t)):[a,Vi(t)]:Vi(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:s,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Di?o===-1?16:o|16:o,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:c,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Gi(e.ssContent),ssFallback:e.ssFallback&&Gi(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return c&&r&&Wn(u,c.clone(u)),u}function Ki(e=` `,t=0){return Hi(Oi,null,e,t)}function qi(e,t){let n=Hi(Ai,null,e);return n.staticCount=t,n}function Ji(e=``,t=!1){return t?(F(),Li(ki,null,e)):Hi(ki,null,e)}function Yi(e){return e==null||typeof e==`boolean`?Hi(ki):d(e)?Hi(Di,null,e.slice()):Ri(e)?Xi(e):Hi(Oi,null,String(e))}function Xi(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Gi(e)}function Zi(e,t){let n=0,{shapeFlag:r}=e;if(t==null)t=null;else if(d(t))n=16;else if(typeof t==`object`)if(r&65){let n=t.default;n&&(n._c&&(n._d=!1),Zi(e,n()),n._c&&(n._d=!0));return}else{n=32;let r=t._;!r&&!Qr(t)?t._ctx=Dn:r===3&&Dn&&(Dn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else h(t)?(t={default:t,_ctx:Dn},n=32):(t=String(t),r&64?(n=16,t=[Ki(t)]):n=8);e.children=t,e.shapeFlag|=n}function Qi(...e){let t={};for(let n=0;n<e.length;n++){let r=e[n];for(let e in r)if(e===`class`)t.class!==r.class&&(t.class=he([t.class,r.class]));else if(e===`style`)t.style=de([t.style,r.style]);else if(a(e)){let n=t[e],i=r[e];i&&n!==i&&!(d(n)&&n.includes(i))&&(t[e]=n?[].concat(n,i):i)}else e!==``&&(t[e]=r[e])}return t}function $i(e,t,n,r=null){ln(e,t,7,[n,r])}var ea=Fr(),ta=0;function na(e,n,r){let i=e.type,a=(n?n.appContext:e.appContext)||ea,o={uid:ta++,vnode:e,type:i,parent:n,appContext:a,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Ee(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(a.provides),ids:n?n.ids:[``,0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ii(i,a),emitsOptions:Hr(i,a),emit:null,emitted:null,propsDefaults:t,inheritAttrs:i.inheritAttrs,ctx:t,data:t,props:t,attrs:t,slots:t,refs:t,setupState:t,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=n?n.root:o,o.emit=Br.bind(null,o),e.ce&&e.ce(o),o}var ra=null,ia=()=>ra||Dn,aa,oa;{let e=ue(),t=(t,n)=>{let r;return(r=e[t])||(r=e[t]=[]),r.push(n),e=>{r.length>1?r.forEach(t=>t(e)):r[0](e)}};aa=t(`__VUE_INSTANCE_SETTERS__`,e=>ra=e),oa=t(`__VUE_SSR_SETTERS__`,e=>ua=e)}var sa=e=>{let t=ra;return aa(e),e.scope.on(),()=>{e.scope.off(),aa(t)}},ca=()=>{ra&&ra.scope.off(),aa(null)};function la(e){return e.vnode.shapeFlag&4}var ua=!1;function da(e,t=!1,n=!1){t&&oa(t);let{props:r,children:i}=e.vnode,a=la(e);$r(e,r,a,t),fi(e,i,n||t);let o=a?fa(e,t):void 0;return t&&oa(!1),o}function fa(e,t){let n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,vr);let{setup:r}=n;if(r){We();let n=e.setupContext=r.length>1?va(e):null,i=sa(e),a=cn(r,e,0,[e.props,n]),o=y(a);if(Ge(),i(),(o||e.sp)&&!Yn(e)&&Gn(e),o){if(a.then(ca,ca),t)return a.then(n=>{pa(e,n,t)}).catch(t=>{un(t,e,0)});e.asyncDep=a}else pa(e,a,t)}else ga(e,t)}function pa(e,t,n){h(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:v(t)&&(e.setupState=Qt(t)),ga(e,n)}var ma,ha;function ga(e,t,n){let i=e.type;if(!e.render){if(!t&&ma&&!i.render){let t=i.template||Tr(e).template;if(t){let{isCustomElement:n,compilerOptions:r}=e.appContext.config,{delimiters:a,compilerOptions:o}=i;i.render=ma(t,s(s({isCustomElement:n,delimiters:a},r),o))}}e.render=i.render||r,ha&&ha(e)}{let t=sa(e);We();try{xr(e)}finally{Ge(),t()}}}var _a={get(e,t){return tt(e,`get`,``),e[t]}};function va(e){return{attrs:new Proxy(e.attrs,_a),slots:e.slots,emit:e.emit,expose:t=>{e.exposed=t||{}}}}function ya(e){return e.exposed?e.exposeProxy||=new Proxy(Qt(Wt(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in gr)return gr[n](e)},has(e,t){return t in e||t in gr}}):e.proxy}function ba(e){return h(e)&&`__vccOpts`in e}var xa=(e,t)=>en(e,t,ua),Sa=`3.5.26`,Ca=void 0,wa=typeof window<`u`&&window.trustedTypes;if(wa)try{Ca=wa.createPolicy(`vue`,{createHTML:e=>e})}catch{}var Ta=Ca?e=>Ca.createHTML(e):e=>e,Ea=`http://www.w3.org/2000/svg`,Da=`http://www.w3.org/1998/Math/MathML`,Oa=typeof document<`u`?document:null,ka=Oa&&Oa.createElement(`template`),Aa={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{let t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,r)=>{let i=t===`svg`?Oa.createElementNS(Ea,e):t===`mathml`?Oa.createElementNS(Da,e):n?Oa.createElement(e,{is:n}):Oa.createElement(e);return e===`select`&&r&&r.multiple!=null&&i.setAttribute(`multiple`,r.multiple),i},createText:e=>Oa.createTextNode(e),createComment:e=>Oa.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Oa.querySelector(e),setScopeId(e,t){e.setAttribute(t,``)},insertStaticContent(e,t,n,r,i,a){let o=n?n.previousSibling:t.lastChild;if(i&&(i===a||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),n),!(i===a||!(i=i.nextSibling)););else{ka.innerHTML=Ta(r===`svg`?`<svg>${e}</svg>`:r===`mathml`?`<math>${e}</math>`:e);let i=ka.content;if(r===`svg`||r===`mathml`){let e=i.firstChild;for(;e.firstChild;)i.appendChild(e.firstChild);i.removeChild(e)}t.insertBefore(i,n)}return[o?o.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},ja=Symbol(`_vtc`);function Ma(e,t,n){let r=e[ja];r&&(t=(t?[t,...r]:[...r]).join(` `)),t==null?e.removeAttribute(`class`):n?e.setAttribute(`class`,t):e.className=t}var Na=Symbol(`_vod`),Pa=Symbol(`_vsh`),Fa={name:`show`,beforeMount(e,{value:t},{transition:n}){e[Na]=e.style.display===`none`?``:e.style.display,n&&t?n.beforeEnter(e):Ia(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:r}){!t!=!n&&(r?t?(r.beforeEnter(e),Ia(e,!0),r.enter(e)):r.leave(e,()=>{Ia(e,!1)}):Ia(e,t))},beforeUnmount(e,{value:t}){Ia(e,t)}};function Ia(e,t){e.style.display=t?e[Na]:`none`,e[Pa]=!t}var La=Symbol(``),Ra=/(?:^|;)\s*display\s*:/;function za(e,t,n){let r=e.style,i=g(n),a=!1;if(n&&!i){if(t)if(g(t))for(let e of t.split(`;`)){let t=e.slice(0,e.indexOf(`:`)).trim();n[t]??Va(r,t,``)}else for(let e in t)n[e]??Va(r,e,``);for(let e in n)e===`display`&&(a=!0),Va(r,e,n[e])}else if(i){if(t!==n){let e=r[La];e&&(n+=`;`+e),r.cssText=n,a=Ra.test(n)}}else t&&e.removeAttribute(`style`);Na in e&&(e[Na]=a?r.display:``,e[Pa]&&(r.display=`none`))}var Ba=/\s*!important$/;function Va(e,t,n){if(d(n))n.forEach(n=>Va(e,t,n));else if(n??=``,t.startsWith(`--`))e.setProperty(t,n);else{let r=Wa(e,t);Ba.test(n)?e.setProperty(T(r),n.replace(Ba,``),`important`):e[r]=n}}var Ha=[`Webkit`,`Moz`,`ms`],Ua={};function Wa(e,t){let n=Ua[t];if(n)return n;let r=w(t);if(r!==`filter`&&r in e)return Ua[t]=r;r=E(r);for(let n=0;n<Ha.length;n++){let i=Ha[n]+r;if(i in e)return Ua[t]=i}return t}var Ga=`http://www.w3.org/1999/xlink`;function Ka(e,t,n,r,i,a=_e(t)){r&&t.startsWith(`xlink:`)?n==null?e.removeAttributeNS(Ga,t.slice(6,t.length)):e.setAttributeNS(Ga,t,n):n==null||a&&!ve(n)?e.removeAttribute(t):e.setAttribute(t,a?``:_(n)?String(n):n)}function qa(e,t,n,r,i){if(t===`innerHTML`||t===`textContent`){n!=null&&(e[t]=t===`innerHTML`?Ta(n):n);return}let a=e.tagName;if(t===`value`&&a!==`PROGRESS`&&!a.includes(`-`)){let r=a===`OPTION`?e.getAttribute(`value`)||``:e.value,i=n==null?e.type===`checkbox`?`on`:``:String(n);(r!==i||!(`_value`in e))&&(e.value=i),n??e.removeAttribute(t),e._value=n;return}let o=!1;if(n===``||n==null){let r=typeof e[t];r===`boolean`?n=ve(n):n==null&&r===`string`?(n=``,o=!0):r===`number`&&(n=0,o=!0)}try{e[t]=n}catch{}o&&e.removeAttribute(i||t)}function Ja(e,t,n,r){e.addEventListener(t,n,r)}function Ya(e,t,n,r){e.removeEventListener(t,n,r)}var Xa=Symbol(`_vei`);function Za(e,t,n,r,i=null){let a=e[Xa]||(e[Xa]={}),o=a[t];if(r&&o)o.value=r;else{let[n,s]=$a(t);r?Ja(e,n,a[t]=ro(r,i),s):o&&(Ya(e,n,o,s),a[t]=void 0)}}var Qa=/(?:Once|Passive|Capture)$/;function $a(e){let t;if(Qa.test(e)){t={};let n;for(;n=e.match(Qa);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===`:`?e.slice(3):T(e.slice(2)),t]}var eo=0,to=Promise.resolve(),no=()=>eo||=(to.then(()=>eo=0),Date.now());function ro(e,t){let n=e=>{if(!e._vts)e._vts=Date.now();else if(e._vts<=n.attached)return;ln(io(e,n.value),t,5,[e])};return n.value=e,n.attached=no(),n}function io(e,t){if(d(t)){let n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(e=>t=>!t._stopped&&e&&e(t))}else return t}var ao=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,oo=(e,t,n,r,i,s)=>{let c=i===`svg`;t===`class`?Ma(e,r,c):t===`style`?za(e,n,r):a(t)?o(t)||Za(e,t,n,r,s):(t[0]===`.`?(t=t.slice(1),!0):t[0]===`^`?(t=t.slice(1),!1):so(e,t,r,c))?(qa(e,t,r),!e.tagName.includes(`-`)&&(t===`value`||t===`checked`||t===`selected`)&&Ka(e,t,r,c,s,t!==`value`)):e._isVueCE&&(/[A-Z]/.test(t)||!g(r))?qa(e,w(t),r,s,t):(t===`true-value`?e._trueValue=r:t===`false-value`&&(e._falseValue=r),Ka(e,t,r,c))};function so(e,t,n,r){if(r)return!!(t===`innerHTML`||t===`textContent`||t in e&&ao(t)&&h(n));if(t===`spellcheck`||t===`draggable`||t===`translate`||t===`autocorrect`||t===`sandbox`&&e.tagName===`IFRAME`||t===`form`||t===`list`&&e.tagName===`INPUT`||t===`type`&&e.tagName===`TEXTAREA`)return!1;if(t===`width`||t===`height`){let t=e.tagName;if(t===`IMG`||t===`VIDEO`||t===`CANVAS`||t===`SOURCE`)return!1}return ao(t)&&g(n)?!1:t in e}var co=e=>{let t=e.props[`onUpdate:modelValue`]||!1;return d(t)?e=>se(t,e):t};function lo(e){e.target.composing=!0}function uo(e){let t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event(`input`)))}var fo=Symbol(`_assign`);function po(e,t,n){return t&&(e=e.trim()),n&&(e=ce(e)),e}var mo={created(e,{modifiers:{lazy:t,trim:n,number:r}},i){e[fo]=co(i);let a=r||i.props&&i.props.type===`number`;Ja(e,t?`change`:`input`,t=>{t.target.composing||e[fo](po(e.value,n,a))}),(n||a)&&Ja(e,`change`,()=>{e.value=po(e.value,n,a)}),t||(Ja(e,`compositionstart`,lo),Ja(e,`compositionend`,uo),Ja(e,`change`,uo))},mounted(e,{value:t}){e.value=t??``},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:r,trim:i,number:a}},o){if(e[fo]=co(o),e.composing)return;let s=(a||e.type===`number`)&&!/^0\d/.test(e.value)?ce(e.value):e.value,c=t??``;s!==c&&(document.activeElement===e&&e.type!==`range`&&(r&&t===n||i&&e.value.trim()===c)||(e.value=c))}},ho={deep:!0,created(e,{value:t,modifiers:{number:n}},r){let i=p(t);Ja(e,`change`,()=>{let t=Array.prototype.filter.call(e.options,e=>e.selected).map(e=>n?ce(_o(e)):_o(e));e[fo](e.multiple?i?new Set(t):t:t[0]),e._assigning=!0,vn(()=>{e._assigning=!1})}),e[fo]=co(r)},mounted(e,{value:t}){go(e,t)},beforeUpdate(e,t,n){e[fo]=co(n)},updated(e,{value:t}){e._assigning||go(e,t)}};function go(e,t){let n=e.multiple,r=d(t);if(!(n&&!r&&!p(t))){for(let i=0,a=e.options.length;i<a;i++){let a=e.options[i],o=_o(a);if(n)if(r){let e=typeof o;e===`string`||e===`number`?a.selected=t.some(e=>String(e)===String(o)):a.selected=xe(t,o)>-1}else a.selected=t.has(o);else if(be(_o(a),t)){e.selectedIndex!==i&&(e.selectedIndex=i);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function _o(e){return`_value`in e?e._value:e.value}var vo=s({patchProp:oo},Aa),yo;function bo(){return yo||=hi(vo)}var xo=((...e)=>{let t=bo().createApp(...e),{mount:n}=t;return t.mount=e=>{let r=Co(e);if(!r)return;let i=t._component;!h(i)&&!i.render&&!i.template&&(i.template=r.innerHTML),r.nodeType===1&&(r.textContent=``);let a=n(r,!1,So(r));return r instanceof Element&&(r.removeAttribute(`v-cloak`),r.setAttribute(`data-v-app`,``)),a},t});function So(e){if(e instanceof SVGElement)return`svg`;if(typeof MathMLElement==`function`&&e instanceof MathMLElement)return`mathml`}function Co(e){return g(e)?document.querySelector(e):e}var wo=()=>void 0,To=function(e){let t=[],n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=i&63|128):(i&64512)==55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)==56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=i&63|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=i&63|128)}return t},Eo=function(e){let t=[],n=0,r=0;for(;n<e.length;){let i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){let a=e[n++];t[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){let a=e[n++],o=e[n++],s=e[n++],c=((i&7)<<18|(a&63)<<12|(o&63)<<6|s&63)-65536;t[r++]=String.fromCharCode(55296+(c>>10)),t[r++]=String.fromCharCode(56320+(c&1023))}else{let a=e[n++],o=e[n++];t[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return t.join(``)},Do={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789`,get ENCODED_VALS(){return this.ENCODED_VALS_BASE+`+/=`},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+`-_.`},HAS_NATIVE_SUPPORT:typeof atob==`function`,encodeByteArray(e,t){if(!Array.isArray(e))throw Error(`encodeByteArray takes an array as a parameter`);this.init_();let n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){let i=e[t],a=t+1<e.length,o=a?e[t+1]:0,s=t+2<e.length,c=s?e[t+2]:0,l=i>>2,u=(i&3)<<4|o>>4,d=(o&15)<<2|c>>6,f=c&63;s||(f=64,a||(d=64)),r.push(n[l],n[u],n[d],n[f])}return r.join(``)},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(To(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):Eo(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();let n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){let i=n[e.charAt(t++)],a=t<e.length?n[e.charAt(t)]:0;++t;let o=t<e.length?n[e.charAt(t)]:64;++t;let s=t<e.length?n[e.charAt(t)]:64;if(++t,i==null||a==null||o==null||s==null)throw new Oo;let c=i<<2|a>>4;if(r.push(c),o!==64){let e=a<<4&240|o>>2;if(r.push(e),s!==64){let e=o<<6&192|s;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},Oo=class extends Error{constructor(){super(...arguments),this.name=`DecodeBase64StringError`}},ko=function(e){let t=To(e);return Do.encodeByteArray(t,!0)},Ao=function(e){return ko(e).replace(/\./g,``)},jo=function(e){try{return Do.decodeString(e,!0)}catch(e){console.error(`base64Decode failed: `,e)}return null};function Mo(){if(typeof self<`u`)return self;if(typeof window<`u`)return window;if(typeof global<`u`)return global;throw Error(`Unable to locate global object.`)}var No=()=>Mo().__FIREBASE_DEFAULTS__,Po=()=>{if(typeof process>`u`)return;let e={}.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},Fo=()=>{if(typeof document>`u`)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let t=e&&jo(e[1]);return t&&JSON.parse(t)},Io=()=>{try{return wo()||No()||Po()||Fo()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},Lo=e=>Io()?.emulatorHosts?.[e],Ro=e=>{let t=Lo(e);if(!t)return;let n=t.lastIndexOf(`:`);if(n<=0||n+1===t.length)throw Error(`Invalid host ${t} with no separate hostname and port!`);let r=parseInt(t.substring(n+1),10);return t[0]===`[`?[t.substring(1,n-1),r]:[t.substring(0,n),r]},zo=()=>Io()?.config,Bo=e=>Io()?.[`_${e}`],Vo=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e==`function`&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}};function Ho(e){try{return(e.startsWith(`http://`)||e.startsWith(`https://`)?new URL(e).hostname:e).endsWith(`.cloudworkstations.dev`)}catch{return!1}}async function Uo(e){return(await fetch(e,{credentials:`include`})).ok}function Wo(e,t){if(e.uid)throw Error(`The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.`);let n={alg:`none`,type:`JWT`},r=t||`demo-project`,i=e.iat||0,a=e.sub||e.user_id;if(!a)throw Error(`mockUserToken must contain 'sub' or 'user_id' field!`);let o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:`custom`,identities:{}},...e};return[Ao(JSON.stringify(n)),Ao(JSON.stringify(o)),``].join(`.`)}var Go={};function Ko(){let e={prod:[],emulator:[]};for(let t of Object.keys(Go))Go[t]?e.emulator.push(t):e.prod.push(t);return e}function qo(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement(`div`),t.setAttribute(`id`,e),n=!0),{created:n,element:t}}var Jo=!1;function Yo(e,t){if(typeof window>`u`||typeof document>`u`||!Ho(window.location.host)||Go[e]===t||Go[e]||Jo)return;Go[e]=t;function n(e){return`__firebase__banner__${e}`}let r=`__firebase__banner`,i=Ko().prod.length>0;function a(){let e=document.getElementById(r);e&&e.remove()}function o(e){e.style.display=`flex`,e.style.background=`#7faaf0`,e.style.position=`fixed`,e.style.bottom=`5px`,e.style.left=`5px`,e.style.padding=`.5em`,e.style.borderRadius=`5px`,e.style.alignItems=`center`}function s(e,t){e.setAttribute(`width`,`24`),e.setAttribute(`id`,t),e.setAttribute(`height`,`24`),e.setAttribute(`viewBox`,`0 0 24 24`),e.setAttribute(`fill`,`none`),e.style.marginLeft=`-6px`}function c(){let e=document.createElement(`span`);return e.style.cursor=`pointer`,e.style.marginLeft=`16px`,e.style.fontSize=`24px`,e.innerHTML=` &times;`,e.onclick=()=>{Jo=!0,a()},e}function l(e,t){e.setAttribute(`id`,t),e.innerText=`Learn more`,e.href=`https://firebase.google.com/docs/studio/preview-apps#preview-backend`,e.setAttribute(`target`,`__blank`),e.style.paddingLeft=`5px`,e.style.textDecoration=`underline`}function u(){let e=qo(r),t=n(`text`),a=document.getElementById(t)||document.createElement(`span`),u=n(`learnmore`),d=document.getElementById(u)||document.createElement(`a`),f=n(`preprendIcon`),p=document.getElementById(f)||document.createElementNS(`http://www.w3.org/2000/svg`,`svg`);if(e.created){let t=e.element;o(t),l(d,u);let n=c();s(p,f),t.append(p,a,d,n),document.body.appendChild(t)}i?(a.innerText=`Preview backend disconnected.`,p.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(p.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,a.innerText=`Preview backend running in this workspace.`),a.setAttribute(`id`,t)}document.readyState===`loading`?window.addEventListener(`DOMContentLoaded`,u):u()}function Xo(){return typeof navigator<`u`&&typeof navigator.userAgent==`string`?navigator.userAgent:``}function Zo(){return typeof window<`u`&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xo())}function Qo(){let e=Io()?.forceEnvironment;if(e===`node`)return!0;if(e===`browser`)return!1;try{return Object.prototype.toString.call(global.process)===`[object process]`}catch{return!1}}function $o(){return typeof navigator<`u`&&navigator.userAgent===`Cloudflare-Workers`}function es(){let e=typeof chrome==`object`?chrome.runtime:typeof browser==`object`?browser.runtime:void 0;return typeof e==`object`&&e.id!==void 0}function ts(){return typeof navigator==`object`&&navigator.product===`ReactNative`}function ns(){let e=Xo();return e.indexOf(`MSIE `)>=0||e.indexOf(`Trident/`)>=0}function rs(){return!Qo()&&!!navigator.userAgent&&navigator.userAgent.includes(`Safari`)&&!navigator.userAgent.includes(`Chrome`)}function is(){try{return typeof indexedDB==`object`}catch{return!1}}function as(){return new Promise((e,t)=>{try{let n=!0,r=`validate-browser-context-for-indexeddb-analytics-module`,i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{t(i.error?.message||``)}}catch(e){t(e)}})}var os=`FirebaseError`,ss=class e extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=os,Object.setPrototypeOf(this,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,cs.prototype.create)}},cs=class{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){let n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],a=i?ls(i,n):`Error`;return new ss(r,`${this.serviceName}: ${a} (${r}).`,n)}};function ls(e,t){return e.replace(us,(e,n)=>{let r=t[n];return r==null?`<${n}?>`:String(r)})}var us=/\{\$([^}]+)}/g;function ds(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function fs(e,t){if(e===t)return!0;let n=Object.keys(e),r=Object.keys(t);for(let i of n){if(!r.includes(i))return!1;let n=e[i],a=t[i];if(ps(n)&&ps(a)){if(!fs(n,a))return!1}else if(n!==a)return!1}for(let e of r)if(!n.includes(e))return!1;return!0}function ps(e){return typeof e==`object`&&!!e}function ms(e){let t=[];for(let[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+`=`+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+`=`+encodeURIComponent(r));return t.length?`&`+t.join(`&`):``}function hs(e){let t={};return e.replace(/^\?/,``).split(`&`).forEach(e=>{if(e){let[n,r]=e.split(`=`);t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function gs(e){let t=e.indexOf(`?`);if(!t)return``;let n=e.indexOf(`#`,t);return e.substring(t,n>0?n:void 0)}function _s(e,t){let n=new vs(e,t);return n.subscribe.bind(n)}var vs=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(e===void 0&&t===void 0&&n===void 0)throw Error(`Missing Observer.`);r=ys(e,[`next`,`error`,`complete`])?e:{next:e,error:t,complete:n},r.next===void 0&&(r.next=bs),r.error===void 0&&(r.error=bs),r.complete===void 0&&(r.complete=bs);let i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],--this.observerCount,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(e){typeof console<`u`&&console.error&&console.error(e)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function ys(e,t){if(typeof e!=`object`||!e)return!1;for(let n of t)if(n in e&&typeof e[n]==`function`)return!0;return!1}function bs(){}function xs(e){return e&&e._delegate?e._delegate:e}var Ss=class{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode=`LAZY`,this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}},Cs=`[DEFAULT]`,ws=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let e=new Vo;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{let n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(e){if(n)return null;throw e}else if(n)return null;else throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(Es(e))try{this.getOrInitializeService({instanceIdentifier:Cs})}catch{}for(let[e,t]of this.instancesDeferred.entries()){let n=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch{}}}}clearInstance(e=Cs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>`INTERNAL`in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>`_delete`in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Cs){return this.instances.has(e)}getOptions(e=Cs){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(let[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(r);return r}onInit(e,t){let n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);let i=this.instances.get(n);return i&&e(i,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){let n=this.onInitCallbacks.get(t);if(n)for(let r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Ts(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Cs){return this.component?this.component.multipleInstances?e:Cs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!==`EXPLICIT`}};function Ts(e){return e===Cs?void 0:e}function Es(e){return e.instantiationMode===`EAGER`}var Ds=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new ws(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}},Os=[],R;(function(e){e[e.DEBUG=0]=`DEBUG`,e[e.VERBOSE=1]=`VERBOSE`,e[e.INFO=2]=`INFO`,e[e.WARN=3]=`WARN`,e[e.ERROR=4]=`ERROR`,e[e.SILENT=5]=`SILENT`})(R||={});var ks={debug:R.DEBUG,verbose:R.VERBOSE,info:R.INFO,warn:R.WARN,error:R.ERROR,silent:R.SILENT},As=R.INFO,js={[R.DEBUG]:`log`,[R.VERBOSE]:`log`,[R.INFO]:`info`,[R.WARN]:`warn`,[R.ERROR]:`error`},Ms=(e,t,...n)=>{if(t<e.logLevel)return;let r=new Date().toISOString(),i=js[t];if(i)console[i](`[${r}]  ${e.name}:`,...n);else throw Error(`Attempted to log a message with an invalid logType (value: ${t})`)},Ns=class{constructor(e){this.name=e,this._logLevel=As,this._logHandler=Ms,this._userLogHandler=null,Os.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in R))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e==`string`?ks[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!=`function`)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,R.DEBUG,...e),this._logHandler(this,R.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,R.VERBOSE,...e),this._logHandler(this,R.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,R.INFO,...e),this._logHandler(this,R.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,R.WARN,...e),this._logHandler(this,R.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,R.ERROR,...e),this._logHandler(this,R.ERROR,...e)}},Ps=(e,t)=>t.some(t=>e instanceof t),Fs,Is;function Ls(){return Fs||=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]}function Rs(){return Is||=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey]}var zs=new WeakMap,Bs=new WeakMap,Vs=new WeakMap,Hs=new WeakMap,Us=new WeakMap;function Ws(e){let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener(`success`,i),e.removeEventListener(`error`,a)},i=()=>{t(Xs(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener(`success`,i),e.addEventListener(`error`,a)});return t.then(t=>{t instanceof IDBCursor&&zs.set(t,e)}).catch(()=>{}),Us.set(t,e),t}function Gs(e){if(Bs.has(e))return;let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener(`complete`,i),e.removeEventListener(`error`,a),e.removeEventListener(`abort`,a)},i=()=>{t(),r()},a=()=>{n(e.error||new DOMException(`AbortError`,`AbortError`)),r()};e.addEventListener(`complete`,i),e.addEventListener(`error`,a),e.addEventListener(`abort`,a)});Bs.set(e,t)}var Ks={get(e,t,n){if(e instanceof IDBTransaction){if(t===`done`)return Bs.get(e);if(t===`objectStoreNames`)return e.objectStoreNames||Vs.get(e);if(t===`store`)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Xs(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t===`done`||t===`store`)?!0:t in e}};function qs(e){Ks=e(Ks)}function Js(e){return e===IDBDatabase.prototype.transaction&&!(`objectStoreNames`in IDBTransaction.prototype)?function(t,...n){let r=e.call(Zs(this),t,...n);return Vs.set(r,t.sort?t.sort():[t]),Xs(r)}:Rs().includes(e)?function(...t){return e.apply(Zs(this),t),Xs(zs.get(this))}:function(...t){return Xs(e.apply(Zs(this),t))}}function Ys(e){return typeof e==`function`?Js(e):(e instanceof IDBTransaction&&Gs(e),Ps(e,Ls())?new Proxy(e,Ks):e)}function Xs(e){if(e instanceof IDBRequest)return Ws(e);if(Hs.has(e))return Hs.get(e);let t=Ys(e);return t!==e&&(Hs.set(e,t),Us.set(t,e)),t}var Zs=e=>Us.get(e);function Qs(e,t,{blocked:n,upgrade:r,blocking:i,terminated:a}={}){let o=indexedDB.open(e,t),s=Xs(o);return r&&o.addEventListener(`upgradeneeded`,e=>{r(Xs(o.result),e.oldVersion,e.newVersion,Xs(o.transaction),e)}),n&&o.addEventListener(`blocked`,e=>n(e.oldVersion,e.newVersion,e)),s.then(e=>{a&&e.addEventListener(`close`,()=>a()),i&&e.addEventListener(`versionchange`,e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}var $s=[`get`,`getKey`,`getAll`,`getAllKeys`,`count`],ec=[`put`,`add`,`delete`,`clear`],tc=new Map;function nc(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t==`string`))return;if(tc.get(t))return tc.get(t);let n=t.replace(/FromIndex$/,``),r=t!==n,i=ec.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||$s.includes(n)))return;let a=async function(e,...t){let a=this.transaction(e,i?`readwrite`:`readonly`),o=a.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&a.done]))[0]};return tc.set(t,a),a}qs(e=>({...e,get:(t,n,r)=>nc(t,n)||e.get(t,n,r),has:(t,n)=>!!nc(t,n)||e.has(t,n)}));var rc=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(ic(e)){let t=e.getImmediate();return`${t.library}/${t.version}`}else return null}).filter(e=>e).join(` `)}};function ic(e){return e.getComponent()?.type===`VERSION`}var ac=`@firebase/app`,oc=`0.14.6`,sc=new Ns(`@firebase/app`),cc=`@firebase/app-compat`,lc=`@firebase/analytics-compat`,uc=`@firebase/analytics`,dc=`@firebase/app-check-compat`,fc=`@firebase/app-check`,pc=`@firebase/auth`,mc=`@firebase/auth-compat`,hc=`@firebase/database`,gc=`@firebase/data-connect`,_c=`@firebase/database-compat`,vc=`@firebase/functions`,yc=`@firebase/functions-compat`,bc=`@firebase/installations`,xc=`@firebase/installations-compat`,Sc=`@firebase/messaging`,Cc=`@firebase/messaging-compat`,wc=`@firebase/performance`,Tc=`@firebase/performance-compat`,Ec=`@firebase/remote-config`,Dc=`@firebase/remote-config-compat`,Oc=`@firebase/storage`,kc=`@firebase/storage-compat`,Ac=`@firebase/firestore`,jc=`@firebase/ai`,Mc=`@firebase/firestore-compat`,Nc=`firebase`,Pc=`12.6.0`,Fc=`[DEFAULT]`,Ic={[ac]:`fire-core`,[cc]:`fire-core-compat`,[uc]:`fire-analytics`,[lc]:`fire-analytics-compat`,[fc]:`fire-app-check`,[dc]:`fire-app-check-compat`,[pc]:`fire-auth`,[mc]:`fire-auth-compat`,[hc]:`fire-rtdb`,[gc]:`fire-data-connect`,[_c]:`fire-rtdb-compat`,[vc]:`fire-fn`,[yc]:`fire-fn-compat`,[bc]:`fire-iid`,[xc]:`fire-iid-compat`,[Sc]:`fire-fcm`,[Cc]:`fire-fcm-compat`,[wc]:`fire-perf`,[Tc]:`fire-perf-compat`,[Ec]:`fire-rc`,[Dc]:`fire-rc-compat`,[Oc]:`fire-gcs`,[kc]:`fire-gcs-compat`,[Ac]:`fire-fst`,[Mc]:`fire-fst-compat`,[jc]:`fire-vertex`,"fire-js":`fire-js`,[Nc]:`fire-js-all`},Lc=new Map,Rc=new Map,zc=new Map;function Bc(e,t){try{e.container.addComponent(t)}catch(n){sc.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Vc(e){let t=e.name;if(zc.has(t))return sc.debug(`There were multiple attempts to register component ${t}.`),!1;zc.set(t,e);for(let t of Lc.values())Bc(t,e);for(let t of Rc.values())Bc(t,e);return!0}function Hc(e,t){let n=e.container.getProvider(`heartbeat`).getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Uc(e){return e==null?!1:e.settings!==void 0}var Wc=new cs(`app`,`Firebase`,{"no-app":`No Firebase App '{$appName}' has been created - call initializeApp() first`,"bad-app-name":`Illegal App name: '{$appName}'`,"duplicate-app":`Firebase App named '{$appName}' already exists with different options or config`,"app-deleted":`Firebase App named '{$appName}' already deleted`,"server-app-deleted":`Firebase Server App has been deleted`,"no-options":`Need to provide options, when not being deployed to hosting via source.`,"invalid-app-argument":`firebase.{$appName}() takes either no argument or a Firebase App instance.`,"invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":`Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.`,"idb-get":`Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.`,"idb-set":`Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.`,"idb-delete":`Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.`,"finalization-registry-not-supported":`FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.`,"invalid-server-app-environment":`FirebaseServerApp is not for use in browser environments.`}),Gc=class{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ss(`app`,()=>this,`PUBLIC`))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Wc.create(`app-deleted`,{appName:this._name})}},Kc=Pc;function qc(e,t={}){let n=e;typeof t!=`object`&&(t={name:t});let r={name:Fc,automaticDataCollectionEnabled:!0,...t},i=r.name;if(typeof i!=`string`||!i)throw Wc.create(`bad-app-name`,{appName:String(i)});if(n||=zo(),!n)throw Wc.create(`no-options`);let a=Lc.get(i);if(a){if(fs(n,a.options)&&fs(r,a.config))return a;throw Wc.create(`duplicate-app`,{appName:i})}let o=new Ds(i);for(let e of zc.values())o.addComponent(e);let s=new Gc(n,r,o);return Lc.set(i,s),s}function Jc(e=Fc){let t=Lc.get(e);if(!t&&e===`[DEFAULT]`&&zo())return qc();if(!t)throw Wc.create(`no-app`,{appName:e});return t}function Yc(e,t,n){let r=Ic[e]??e;n&&(r+=`-${n}`);let i=r.match(/\s|\//),a=t.match(/\s|\//);if(i||a){let e=[`Unable to register library "${r}" with version "${t}":`];i&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&e.push(`and`),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),sc.warn(e.join(` `));return}Vc(new Ss(`${r}-version`,()=>({library:r,version:t}),`VERSION`))}var Xc=`firebase-heartbeat-database`,Zc=1,Qc=`firebase-heartbeat-store`,$c=null;function el(){return $c||=Qs(Xc,Zc,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Qc)}catch(e){console.warn(e)}}}}).catch(e=>{throw Wc.create(`idb-open`,{originalErrorMessage:e.message})}),$c}async function tl(e){try{let t=(await el()).transaction(Qc),n=await t.objectStore(Qc).get(rl(e));return await t.done,n}catch(e){if(e instanceof ss)sc.warn(e.message);else{let t=Wc.create(`idb-get`,{originalErrorMessage:e?.message});sc.warn(t.message)}}}async function nl(e,t){try{let n=(await el()).transaction(Qc,`readwrite`);await n.objectStore(Qc).put(t,rl(e)),await n.done}catch(e){if(e instanceof ss)sc.warn(e.message);else{let t=Wc.create(`idb-set`,{originalErrorMessage:e?.message});sc.warn(t.message)}}}function rl(e){return`${e.name}!${e.options.appId}`}var il=1024,al=30,ol=class{constructor(e){this.container=e,this._heartbeatsCache=null,this._storage=new ll(this.container.getProvider(`app`).getImmediate()),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{let e=this.container.getProvider(`platform-logger`).getImmediate().getPlatformInfoString(),t=sl();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===t||this._heartbeatsCache.heartbeats.some(e=>e.date===t))return;if(this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats.length>al){let e=dl(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){sc.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return``;let e=sl(),{heartbeatsToSend:t,unsentEntries:n}=cl(this._heartbeatsCache.heartbeats),r=Ao(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return sc.warn(e),``}}};function sl(){return new Date().toISOString().substring(0,10)}function cl(e,t=il){let n=[],r=e.slice();for(let i of e){let e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),ul(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),ul(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}var ll=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return is()?as().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let e=await tl(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return nl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return nl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}else return}};function ul(e){return Ao(JSON.stringify({version:2,heartbeats:e})).length}function dl(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}function fl(e){Vc(new Ss(`platform-logger`,e=>new rc(e),`PRIVATE`)),Vc(new Ss(`heartbeat`,e=>new ol(e),`PRIVATE`)),Yc(ac,oc,e),Yc(ac,oc,`esm2020`),Yc(`fire-js`,``)}fl(``),Yc(`firebase`,`12.7.0`,`app`);var pl=typeof globalThis<`u`?globalThis:typeof window<`u`?window:typeof global<`u`?global:typeof self<`u`?self:{},ml={},hl,gl;(function(){var e;function t(e,t){function n(){}n.prototype=t.prototype,e.F=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.D=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(e,t,n){n||=0;let r=Array(16);if(typeof t==`string`)for(var i=0;i<16;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;i<16;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];let a=e.g[3],o;o=t+(a^n&(i^a))+r[0]+3614090360&4294967295,t=n+(o<<7&4294967295|o>>>25),o=a+(i^t&(n^i))+r[1]+3905402710&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[2]+606105819&4294967295,i=a+(o<<17&4294967295|o>>>15),o=n+(t^i&(a^t))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(a^n&(i^a))+r[4]+4118548399&4294967295,t=n+(o<<7&4294967295|o>>>25),o=a+(i^t&(n^i))+r[5]+1200080426&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[6]+2821735955&4294967295,i=a+(o<<17&4294967295|o>>>15),o=n+(t^i&(a^t))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(a^n&(i^a))+r[8]+1770035416&4294967295,t=n+(o<<7&4294967295|o>>>25),o=a+(i^t&(n^i))+r[9]+2336552879&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[10]+4294925233&4294967295,i=a+(o<<17&4294967295|o>>>15),o=n+(t^i&(a^t))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(a^n&(i^a))+r[12]+1804603682&4294967295,t=n+(o<<7&4294967295|o>>>25),o=a+(i^t&(n^i))+r[13]+4254626195&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[14]+2792965006&4294967295,i=a+(o<<17&4294967295|o>>>15),o=n+(t^i&(a^t))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(i^a&(n^i))+r[1]+4129170786&4294967295,t=n+(o<<5&4294967295|o>>>27),o=a+(n^i&(t^n))+r[6]+3225465664&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[11]+643717713&4294967295,i=a+(o<<14&4294967295|o>>>18),o=n+(a^t&(i^a))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(i^a&(n^i))+r[5]+3593408605&4294967295,t=n+(o<<5&4294967295|o>>>27),o=a+(n^i&(t^n))+r[10]+38016083&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[15]+3634488961&4294967295,i=a+(o<<14&4294967295|o>>>18),o=n+(a^t&(i^a))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(i^a&(n^i))+r[9]+568446438&4294967295,t=n+(o<<5&4294967295|o>>>27),o=a+(n^i&(t^n))+r[14]+3275163606&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[3]+4107603335&4294967295,i=a+(o<<14&4294967295|o>>>18),o=n+(a^t&(i^a))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(i^a&(n^i))+r[13]+2850285829&4294967295,t=n+(o<<5&4294967295|o>>>27),o=a+(n^i&(t^n))+r[2]+4243563512&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[7]+1735328473&4294967295,i=a+(o<<14&4294967295|o>>>18),o=n+(a^t&(i^a))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(n^i^a)+r[5]+4294588738&4294967295,t=n+(o<<4&4294967295|o>>>28),o=a+(t^n^i)+r[8]+2272392833&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[11]+1839030562&4294967295,i=a+(o<<16&4294967295|o>>>16),o=n+(i^a^t)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(n^i^a)+r[1]+2763975236&4294967295,t=n+(o<<4&4294967295|o>>>28),o=a+(t^n^i)+r[4]+1272893353&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[7]+4139469664&4294967295,i=a+(o<<16&4294967295|o>>>16),o=n+(i^a^t)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(n^i^a)+r[13]+681279174&4294967295,t=n+(o<<4&4294967295|o>>>28),o=a+(t^n^i)+r[0]+3936430074&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[3]+3572445317&4294967295,i=a+(o<<16&4294967295|o>>>16),o=n+(i^a^t)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(n^i^a)+r[9]+3654602809&4294967295,t=n+(o<<4&4294967295|o>>>28),o=a+(t^n^i)+r[12]+3873151461&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[15]+530742520&4294967295,i=a+(o<<16&4294967295|o>>>16),o=n+(i^a^t)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(i^(n|~a))+r[0]+4096336452&4294967295,t=n+(o<<6&4294967295|o>>>26),o=a+(n^(t|~i))+r[7]+1126891415&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[14]+2878612391&4294967295,i=a+(o<<15&4294967295|o>>>17),o=n+(a^(i|~t))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=t+(i^(n|~a))+r[12]+1700485571&4294967295,t=n+(o<<6&4294967295|o>>>26),o=a+(n^(t|~i))+r[3]+2399980690&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[10]+4293915773&4294967295,i=a+(o<<15&4294967295|o>>>17),o=n+(a^(i|~t))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=t+(i^(n|~a))+r[8]+1873313359&4294967295,t=n+(o<<6&4294967295|o>>>26),o=a+(n^(t|~i))+r[15]+4264355552&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[6]+2734768916&4294967295,i=a+(o<<15&4294967295|o>>>17),o=n+(a^(i|~t))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=t+(i^(n|~a))+r[4]+4149444226&4294967295,t=n+(o<<6&4294967295|o>>>26),o=a+(n^(t|~i))+r[11]+3174756917&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[2]+718787259&4294967295,i=a+(o<<15&4294967295|o>>>17),o=n+(a^(i|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+a&4294967295}r.prototype.v=function(e,t){t===void 0&&(t=e.length);let n=t-this.blockSize,r=this.C,a=this.h,o=0;for(;o<t;){if(a==0)for(;o<=n;)i(this,e,o),o+=this.blockSize;if(typeof e==`string`){for(;o<t;)if(r[a++]=e.charCodeAt(o++),a==this.blockSize){i(this,r),a=0;break}}else for(;o<t;)if(r[a++]=e[o++],a==this.blockSize){i(this,r),a=0;break}}this.h=a,this.o+=t},r.prototype.A=function(){var e=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=this.o*8;for(var n=e.length-8;n<e.length;++n)e[n]=t&255,t/=256;for(this.v(e),e=Array(16),t=0,n=0;n<4;++n)for(let r=0;r<32;r+=8)e[t++]=this.g[n]>>>r&255;return e};function a(e,t){var n=s;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}function o(e,t){this.h=t;let n=[],r=!0;for(let i=e.length-1;i>=0;i--){let a=e[i]|0;r&&a==t||(n[i]=a,r=!1)}this.g=n}var s={};function c(e){return-128<=e&&e<128?a(e,function(e){return new o([e|0],e<0?-1:0)}):new o([e|0],e<0?-1:0)}function l(e){if(isNaN(e)||!isFinite(e))return d;if(e<0)return g(l(-e));let t=[],n=1;for(let r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new o(t,0)}function u(e,t){if(e.length==0)throw Error(`number format error: empty string`);if(t||=10,t<2||36<t)throw Error(`radix out of range: `+t);if(e.charAt(0)==`-`)return g(u(e.substring(1),t));if(e.indexOf(`-`)>=0)throw Error(`number format error: interior "-" character`);let n=l(t**8),r=d;for(let a=0;a<e.length;a+=8){var i=Math.min(8,e.length-a);let o=parseInt(e.substring(a,a+i),t);i<8?(i=l(t**+i),r=r.j(i).add(l(o))):(r=r.j(n),r=r.add(l(o)))}return r}var d=c(0),f=c(1),p=c(16777216);e=o.prototype,e.m=function(){if(h(this))return-g(this).m();let e=0,t=1;for(let n=0;n<this.g.length;n++){let r=this.i(n);e+=(r>=0?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(e||=10,e<2||36<e)throw Error(`radix out of range: `+e);if(m(this))return`0`;if(h(this))return`-`+g(this).toString(e);let t=l(e**6);var n=this;let r=``;for(;;){let i=b(n,t).g;n=_(n,i.j(t));let a=((n.g.length>0?n.g[0]:n.h)>>>0).toString(e);if(n=i,m(n))return a+r;for(;a.length<6;)a=`0`+a;r=a+r}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h};function m(e){if(e.h!=0)return!1;for(let t=0;t<e.g.length;t++)if(e.g[t]!=0)return!1;return!0}function h(e){return e.h==-1}e.l=function(e){return e=_(this,e),h(e)?-1:m(e)?0:1};function g(e){let t=e.g.length,n=[];for(let r=0;r<t;r++)n[r]=~e.g[r];return new o(n,~e.h).add(f)}e.abs=function(){return h(this)?g(this):this},e.add=function(e){let t=Math.max(this.g.length,e.g.length),n=[],r=0;for(let i=0;i<=t;i++){let t=r+(this.i(i)&65535)+(e.i(i)&65535),a=(t>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);r=a>>>16,t&=65535,a&=65535,n[i]=a<<16|t}return new o(n,n[n.length-1]&-2147483648?-1:0)};function _(e,t){return e.add(g(t))}e.j=function(e){if(m(this)||m(e))return d;if(h(this))return h(e)?g(this).j(g(e)):g(g(this).j(e));if(h(e))return g(this.j(g(e)));if(this.l(p)<0&&e.l(p)<0)return l(this.m()*e.m());let t=this.g.length+e.g.length,n=[];for(var r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(let t=0;t<e.g.length;t++){let i=this.i(r)>>>16,a=this.i(r)&65535,o=e.i(t)>>>16,s=e.i(t)&65535;n[2*r+2*t]+=a*s,v(n,2*r+2*t),n[2*r+2*t+1]+=i*s,v(n,2*r+2*t+1),n[2*r+2*t+1]+=a*o,v(n,2*r+2*t+1),n[2*r+2*t+2]+=i*o,v(n,2*r+2*t+2)}for(e=0;e<t;e++)n[e]=n[2*e+1]<<16|n[2*e];for(e=t;e<2*t;e++)n[e]=0;return new o(n,0)};function v(e,t){for(;(e[t]&65535)!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function y(e,t){this.g=e,this.h=t}function b(e,t){if(m(t))throw Error(`division by zero`);if(m(e))return new y(d,d);if(h(e))return t=b(g(e),t),new y(g(t.g),g(t.h));if(h(t))return t=b(e,g(t)),new y(g(t.g),t.h);if(e.g.length>30){if(h(e)||h(t))throw Error(`slowDivide_ only works with positive integers.`);for(var n=f,r=t;r.l(e)<=0;)n=x(n),r=x(r);var i=ee(n,1),a=ee(r,1);for(r=ee(r,2),n=ee(n,2);!m(r);){var o=a.add(r);o.l(e)<=0&&(i=i.add(n),a=o),r=ee(r,1),n=ee(n,1)}return t=_(e,i.j(t)),new y(i,t)}for(i=d;e.l(t)>=0;){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=Math.ceil(Math.log(n)/Math.LN2),r=r<=48?1:2**(r-48),a=l(n),o=a.j(t);h(o)||o.l(e)>0;)n-=r,a=l(n),o=a.j(t);m(a)&&(a=f),i=i.add(a),e=_(e,o)}return new y(i,e)}e.B=function(e){return b(this,e).h},e.and=function(e){let t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new o(n,this.h&e.h)},e.or=function(e){let t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new o(n,this.h|e.h)},e.xor=function(e){let t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new o(n,this.h^e.h)};function x(e){let t=e.g.length+1,n=[];for(let r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new o(n,e.h)}function ee(e,t){let n=t>>5;t%=32;let r=e.g.length-n,i=[];for(let a=0;a<r;a++)i[a]=t>0?e.i(a+n)>>>t|e.i(a+n+1)<<32-t:e.i(a+n);return new o(i,e.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,gl=ml.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=u,hl=ml.Integer=o}).apply(pl===void 0?typeof self<`u`?self:typeof window<`u`?window:{}:pl);var _l=typeof globalThis<`u`?globalThis:typeof window<`u`?window:typeof global<`u`?global:typeof self<`u`?self:{},vl={},yl,bl,xl,Sl,Cl,wl,Tl,El;(function(){var e,t=Object.defineProperty;function n(e){e=[typeof globalThis==`object`&&globalThis,e,typeof window==`object`&&window,typeof self==`object`&&self,typeof _l==`object`&&_l];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error(`Cannot find global object`)}var r=n(this);function i(e,n){if(n)a:{var i=r;e=e.split(`.`);for(var a=0;a<e.length-1;a++){var o=e[a];if(!(o in i))break a;i=i[o]}e=e[e.length-1],a=i[e],n=n(a),n!=a&&n!=null&&t(i,e,{configurable:!0,writable:!0,value:n})}}i(`Symbol.dispose`,function(e){return e||Symbol(`Symbol.dispose`)}),i(`Array.prototype.values`,function(e){return e||function(){return this[Symbol.iterator]()}}),i(`Object.entries`,function(e){return e||function(e){var t=[],n;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push([n,e[n]]);return t}});var a=a||{},o=this||self;function s(e){var t=typeof e;return t==`object`&&e!=null||t==`function`}function c(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){return l=c,l.apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Ob=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}var f=typeof AsyncContext<`u`&&typeof AsyncContext.Snapshot==`function`?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function p(e){let t=e.length;if(t>0){let n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function m(e,t){for(let t=1;t<arguments.length;t++){let r=arguments[t];var n=typeof r;if(n=n==`object`?r?Array.isArray(r)?`array`:n:`null`:n,n==`array`||n==`object`&&typeof r.length==`number`){n=e.length||0;let t=r.length||0;e.length=n+t;for(let i=0;i<t;i++)e[n+i]=r[i]}else e.push(r)}}class h{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function g(e){o.setTimeout(()=>{throw e},0)}function _(){var e=te;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}class v{constructor(){this.h=this.g=null}add(e,t){let n=y.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}var y=new h(()=>new b,e=>e.reset());class b{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let x,ee=!1,te=new v,S=()=>{let e=Promise.resolve(void 0);x=()=>{e.then(ne)}};function ne(){for(var e;e=_();){try{e.h.call(e.g)}catch(e){g(e)}var t=y;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}ee=!1}function re(){this.u=this.u,this.C=this.C}re.prototype.u=!1,re.prototype.dispose=function(){this.u||(this.u=!0,this.N())},re.prototype[Symbol.dispose]=function(){this.dispose()},re.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function C(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}C.prototype.h=function(){this.defaultPrevented=!0};var w=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},`passive`,{get:function(){e=!0}});try{let e=()=>{};o.addEventListener(`test`,e,t),o.removeEventListener(`test`,e,t)}catch{}return e}();function ie(e){return/^[\s\xa0]*$/.test(e)}function T(e,t){C.call(this,e?e.type:``),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key=``,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType=``,this.i=null,e&&this.init(e,t)}d(T,C),T.prototype.init=function(e,t){let n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget,t||(n==`mouseover`?t=e.fromElement:n==`mouseout`&&(t=e.toElement)),this.relatedTarget=t,r?(this.clientX=r.clientX===void 0?r.pageX:r.clientX,this.clientY=r.clientY===void 0?r.pageY:r.clientY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=e.clientX===void 0?e.pageX:e.clientX,this.clientY=e.clientY===void 0?e.pageY:e.clientY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||``,this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&T.Z.h.call(this)},T.prototype.h=function(){T.Z.h.call(this);let e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var E=`closure_listenable_`+(Math.random()*1e6|0),ae=0;function oe(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++ae,this.da=this.fa=!1}function se(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function D(e,t,n){for(let r in e)t.call(n,e[r],r,e)}function ce(e,t){for(let n in e)t.call(void 0,e[n],n,e)}function le(e){let t={};for(let n in e)t[n]=e[n];return t}let ue=`constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf`.split(` `);function de(e,t){let n,r;for(let t=1;t<arguments.length;t++){for(n in r=arguments[t],r)e[n]=r[n];for(let t=0;t<ue.length;t++)n=ue[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function fe(e){this.src=e,this.g={},this.h=0}fe.prototype.add=function(e,t,n,r,i){let a=e.toString();e=this.g[a],e||(e=this.g[a]=[],this.h++);let o=O(e,t,r,i);return o>-1?(t=e[o],n||(t.fa=!1)):(t=new oe(t,this.src,a,!!r,i),t.fa=n,e.push(t)),t};function pe(e,t){let n=t.type;if(n in e.g){var r=e.g[n],i=Array.prototype.indexOf.call(r,t,void 0),a;(a=i>=0)&&Array.prototype.splice.call(r,i,1),a&&(se(t),e.g[n].length==0&&(delete e.g[n],e.h--))}}function O(e,t,n,r){for(let i=0;i<e.length;++i){let a=e[i];if(!a.da&&a.listener==t&&a.capture==!!n&&a.ha==r)return i}return-1}var me=`closure_lm_`+(Math.random()*1e6|0),he={};function ge(e,t,n,r,i){if(r&&r.once)return ye(e,t,n,r,i);if(Array.isArray(t)){for(let a=0;a<t.length;a++)ge(e,t[a],n,r,i);return null}return n=Te(n),e&&e[E]?e.J(t,n,s(r)?!!r.capture:!!r,i):_e(e,t,n,!1,r,i)}function _e(e,t,n,r,i,a){if(!t)throw Error(`Invalid event type`);let o=s(i)?!!i.capture:!!i,c=Ce(e);if(c||(e[me]=c=new fe(e)),n=c.add(t,n,r,o,a),n.proxy)return n;if(r=ve(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)w||(i=o),i===void 0&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Se(t.toString()),r);else if(e.addListener&&e.removeListener)e.addListener(r);else throw Error(`addEventListener and attachEvent are unavailable.`);return n}function ve(){function e(n){return t.call(e.src,e.listener,n)}let t=k;return e}function ye(e,t,n,r,i){if(Array.isArray(t)){for(let a=0;a<t.length;a++)ye(e,t[a],n,r,i);return null}return n=Te(n),e&&e[E]?e.K(t,n,s(r)?!!r.capture:!!r,i):_e(e,t,n,!0,r,i)}function be(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)be(e,t[a],n,r,i);else r=s(r)?!!r.capture:!!r,n=Te(n),e&&e[E]?(e=e.i,a=String(t).toString(),a in e.g&&(t=e.g[a],n=O(t,n,r,i),n>-1&&(se(t[n]),Array.prototype.splice.call(t,n,1),t.length==0&&(delete e.g[a],e.h--)))):(e&&=Ce(e))&&(t=e.g[t.toString()],e=-1,t&&(e=O(t,n,r,i)),(n=e>-1?t[e]:null)&&xe(n))}function xe(e){if(typeof e!=`number`&&e&&!e.da){var t=e.src;if(t&&t[E])pe(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Se(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Ce(t))?(pe(n,e),n.h==0&&(n.src=null,t[me]=null)):se(e)}}}function Se(e){return e in he?he[e]:he[e]=`on`+e}function k(e,t){if(e.da)e=!0;else{t=new T(t,this);let n=e.listener,r=e.ha||e.src;e.fa&&xe(e),e=n.call(r,t)}return e}function Ce(e){return e=e[me],e instanceof fe?e:null}var we=`__closure_events_fn_`+(Math.random()*1e9>>>0);function Te(e){return typeof e==`function`?e:(e[we]||(e[we]=function(t){return e.handleEvent(t)}),e[we])}function Ee(){re.call(this),this.i=new fe(this),this.M=this,this.G=null}d(Ee,re),Ee.prototype[E]=!0,Ee.prototype.removeEventListener=function(e,t,n,r){be(this,e,t,n,r)};function De(e,t){var n,r=e.G;if(r)for(n=[];r;r=r.G)n.push(r);if(e=e.M,r=t.type||t,typeof t==`string`)t=new C(t,e);else if(t instanceof C)t.target=t.target||e;else{var i=t;t=new C(r,e),de(t,i)}i=!0;let a,o;if(n)for(o=n.length-1;o>=0;o--)a=t.g=n[o],i=A(a,r,!0,t)&&i;if(a=t.g=e,i=A(a,r,!0,t)&&i,i=A(a,r,!1,t)&&i,n)for(o=0;o<n.length;o++)a=t.g=n[o],i=A(a,r,!1,t)&&i}Ee.prototype.N=function(){if(Ee.Z.N.call(this),this.i){var e=this.i;for(let t in e.g){let n=e.g[t];for(let e=0;e<n.length;e++)se(n[e]);delete e.g[t],e.h--}}this.G=null},Ee.prototype.J=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Ee.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};function A(e,t,n,r){if(t=e.i.g[String(t)],!t)return!0;t=t.concat();let i=!0;for(let a=0;a<t.length;++a){let o=t[a];if(o&&!o.da&&o.capture==n){let t=o.listener,n=o.ha||o.src;o.fa&&pe(e.i,o),i=t.call(n,r)!==!1&&i}}return i&&!r.defaultPrevented}function Oe(e,t){if(typeof e!=`function`)if(e&&typeof e.handleEvent==`function`)e=l(e.handleEvent,e);else throw Error(`Invalid listener argument`);return Number(t)>2147483647?-1:o.setTimeout(e,t||0)}function ke(e){e.g=Oe(()=>{e.g=null,e.i&&(e.i=!1,ke(e))},e.l);let t=e.h;e.h=null,e.m.apply(null,t)}class Ae extends re{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ke(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function je(e){re.call(this),this.h=e,this.g={}}d(je,re);var Me=[];function Ne(e){D(e.g,function(e,t){this.g.hasOwnProperty(t)&&xe(e)},e),e.g={}}je.prototype.N=function(){je.Z.N.call(this),Ne(this)},je.prototype.handleEvent=function(){throw Error(`EventHandler.handleEvent not implemented`)};var Pe=o.JSON.stringify,Fe=o.JSON.parse,Ie=class{stringify(e){return o.JSON.stringify(e,void 0)}parse(e){return o.JSON.parse(e,void 0)}};function Le(){}function Re(){}var ze={OPEN:`a`,hb:`b`,ERROR:`c`,tb:`d`};function Be(){C.call(this,`d`)}d(Be,C);function Ve(){C.call(this,`c`)}d(Ve,C);var He={},Ue=null;function We(){return Ue||=new Ee}He.Ia=`serverreachability`;function Ge(e){C.call(this,He.Ia,e)}d(Ge,C);function Ke(e){let t=We();De(t,new Ge(t))}He.STAT_EVENT=`statevent`;function qe(e,t){C.call(this,He.STAT_EVENT,e),this.stat=t}d(qe,C);function Je(e){let t=We();De(t,new qe(t,e))}He.Ja=`timingevent`;function Ye(e,t){C.call(this,He.Ja,e),this.size=t}d(Ye,C);function Xe(e,t){if(typeof e!=`function`)throw Error(`Fn must not be null and must be a function`);return o.setTimeout(function(){e()},t)}function Ze(){this.g=!0}Ze.prototype.ua=function(){this.g=!1};function Qe(e,t,n,r,i,a){e.info(function(){if(e.g)if(a){var o=``,s=a.split(`&`);for(let e=0;e<s.length;e++){var c=s[e].split(`=`);if(c.length>1){let e=c[0];c=c[1];let t=e.split(`_`);o=t.length>=2&&t[1]==`type`?o+(e+`=`+c+`&`):o+(e+`=redacted&`)}}}else o=null;else o=a;return`XMLHTTP REQ (`+r+`) [attempt `+i+`]: `+t+`
`+n+`
`+o})}function $e(e,t,n,r,i,a,o){e.info(function(){return`XMLHTTP RESP (`+r+`) [ attempt `+i+`]: `+t+`
`+n+`
`+a+` `+o})}function et(e,t,n,r){e.info(function(){return`XMLHTTP TEXT (`+t+`): `+nt(e,n)+(r?` `+r:``)})}function tt(e,t){e.info(function(){return`TIMEOUT: `+t})}Ze.prototype.info=function(){};function nt(e,t){if(!e.g)return t;if(!t)return null;try{let a=JSON.parse(t);if(a){for(e=0;e<a.length;e++)if(Array.isArray(a[e])){var n=a[e];if(!(n.length<2)){var r=n[1];if(Array.isArray(r)&&!(r.length<1)){var i=r[0];if(i!=`noop`&&i!=`stop`&&i!=`close`)for(let e=1;e<r.length;e++)r[e]=``}}}}return Pe(a)}catch{return t}}var rt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},it={ib:`complete`,Fb:`success`,ERROR:`error`,Ga:`abort`,xb:`ready`,yb:`readystatechange`,TIMEOUT:`timeout`,sb:`incrementaldata`,wb:`progress`,lb:`downloadprogress`,Nb:`uploadprogress`},at;function ot(){}d(ot,Le),ot.prototype.g=function(){return new XMLHttpRequest},at=new ot;function st(e){return encodeURIComponent(String(e))}function ct(e){var t=1;e=e.split(`:`);let n=[];for(;t>0&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(`:`)),n}function lt(e,t,n,r){this.j=e,this.i=t,this.l=n,this.S=r||1,this.V=new je(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ut}function ut(){this.i=null,this.g=``,this.h=!1}var dt={},ft={};function pt(e,t,n){e.M=1,e.A=zt(Ft(t)),e.u=n,e.R=!0,mt(e,null)}function mt(e,t){e.F=Date.now(),vt(e),e.B=Ft(e.A);var n=e.B,r=e.S;Array.isArray(r)||(r=[String(r)]),Zt(n.i,`t`,r),e.C=0,n=e.j.L,e.h=new ut,e.g=Hn(e.j,n?t:null,!e.u),e.P>0&&(e.O=new Ae(l(e.Y,e,e.g),e.P)),t=e.V,n=e.g,r=e.ba;var i=`readystatechange`;Array.isArray(i)||(i&&(Me[0]=i.toString()),i=Me);for(let e=0;e<i.length;e++){let a=ge(n,i[e],r||t.handleEvent,!1,t.h||t);if(!a)break;t.g[a.key]=a}t=e.J?le(e.J):{},e.u?(e.v||=`POST`,t[`Content-Type`]=`application/x-www-form-urlencoded`,e.g.ea(e.B,e.v,e.u,t)):(e.v=`GET`,e.g.ea(e.B,e.v,null,t)),Ke(),Qe(e.i,e.v,e.B,e.l,e.S,e.u)}lt.prototype.ba=function(e){e=e.target;let t=this.O;t&&yn(e)==3?t.j():this.Y(e)},lt.prototype.Y=function(e){try{if(e==this.g)a:{let s=yn(this.g),c=this.g.ya(),l=this.g.ca();if(!(s<3)&&(s!=3||this.g&&(this.h.h||this.g.la()||bn(this.g)))){this.K||s!=4||c==7||Ke(c==8||l<=0?3:2),bt(this);var t=this.g.ca();this.X=t;var n=ht(this);if(this.o=t==200,$e(this.i,this.v,this.B,this.l,this.S,s,t),this.o){if(this.U&&!this.L){b:{if(this.g){var r,i=this.g;if((r=i.g?i.g.getResponseHeader(`X-HTTP-Initial-Response`):null)&&!ie(r)){var a=r;break b}}a=null}if(e=a)et(this.i,this.l,e,`Initial handshake response via X-HTTP-Initial-Response`),this.L=!0,Ct(this,e);else{this.o=!1,this.m=3,Je(12),St(this),xt(this);break a}}if(this.R){e=!0;let t;for(;!this.K&&this.C<n.length;)if(t=_t(this,n),t==ft){s==4&&(this.m=4,Je(14),e=!1),et(this.i,this.l,null,`[Incomplete Response]`);break}else if(t==dt){this.m=4,Je(15),et(this.i,this.l,n,`[Invalid Chunk]`),e=!1;break}else et(this.i,this.l,t,null),Ct(this,t);if(gt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),s!=4||n.length!=0||this.h.h||(this.m=1,Je(16),e=!1),this.o=this.o&&e,!e)et(this.i,this.l,n,`[Invalid Chunked Response]`),St(this),xt(this);else if(n.length>0&&!this.W){this.W=!0;var o=this.j;o.g==this&&o.aa&&!o.P&&(o.j.info(`Great, no buffering proxy detected. Bytes received: `+n.length),Pn(o),o.P=!0,Je(11))}}else et(this.i,this.l,n,null),Ct(this,n);s==4&&St(this),this.o&&!this.K&&(s==4?Ln(this.j,this):(this.o=!1,vt(this)))}else xn(this.g),t==400&&n.indexOf(`Unknown SID`)>0?(this.m=3,Je(12)):(this.m=0,Je(13)),St(this),xt(this)}}}catch{}};function ht(e){if(!gt(e))return e.g.la();let t=bn(e.g);if(t===``)return``;let n=``,r=t.length,i=yn(e.g)==4;if(!e.h.i){if(typeof TextDecoder>`u`)return St(e),xt(e),``;e.h.i=new o.TextDecoder}for(let a=0;a<r;a++)e.h.h=!0,n+=e.h.i.decode(t[a],{stream:!(i&&a==r-1)});return t.length=0,e.h.g+=n,e.C=0,e.h.g}function gt(e){return e.g?e.v==`GET`&&e.M!=2&&e.j.Aa:!1}function _t(e,t){var n=e.C,r=t.indexOf(`
`,n);return r==-1?ft:(n=Number(t.substring(n,r)),isNaN(n)?dt:(r+=1,r+n>t.length?ft:(t=t.slice(r,r+n),e.C=r+n,t)))}lt.prototype.cancel=function(){this.K=!0,St(this)};function vt(e){e.T=Date.now()+e.H,yt(e,e.H)}function yt(e,t){if(e.D!=null)throw Error(`WatchDog timer not null`);e.D=Xe(l(e.aa,e),t)}function bt(e){e.D&&=(o.clearTimeout(e.D),null)}lt.prototype.aa=function(){this.D=null;let e=Date.now();e-this.T>=0?(tt(this.i,this.B),this.M!=2&&(Ke(),Je(17)),St(this),this.m=2,xt(this)):yt(this,this.T-e)};function xt(e){e.j.I==0||e.K||Ln(e.j,e)}function St(e){bt(e);var t=e.O;t&&typeof t.dispose==`function`&&t.dispose(),e.O=null,Ne(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function Ct(e,t){try{var n=e.j;if(n.I!=0&&(n.g==e||Ot(n.h,e))){if(!e.L&&Ot(n.h,e)&&n.I==3){try{var r=n.Ba.g.parse(t)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){a:if(!n.v){if(n.g)if(n.g.F+3e3<e.F)In(n),Tn(n);else break a;Nn(n),Je(18)}}else n.xa=i[1],0<n.xa-n.K&&i[2]<37500&&n.F&&n.A==0&&!n.C&&(n.C=Xe(l(n.Va,n),6e3));Dt(n.h)<=1&&n.ta&&(n.ta=void 0)}else zn(n,11)}else if((e.L||n.g==e)&&In(n),!ie(t))for(i=n.Ba.g.parse(t),t=0;t<i.length;t++){let l=i[t],u=l[0];if(!(u<=n.K))if(n.K=u,l=l[1],n.I==2)if(l[0]==`c`){n.M=l[1],n.ba=l[2];let t=l[3];t!=null&&(n.ka=t,n.j.info(`VER=`+n.ka));let i=l[4];i!=null&&(n.za=i,n.j.info(`SVER=`+n.za));let u=l[5];u!=null&&typeof u==`number`&&u>0&&(r=1.5*u,n.O=r,n.j.info(`backChannelRequestTimeoutMs_=`+r)),r=n;let d=e.g;if(d){let e=d.g?d.g.getResponseHeader(`X-Client-Wire-Protocol`):null;if(e){var a=r.h;a.g||e.indexOf(`spdy`)==-1&&e.indexOf(`quic`)==-1&&e.indexOf(`h2`)==-1||(a.j=a.l,a.g=new Set,a.h&&=(kt(a,a.h),null))}if(r.G){let e=d.g?d.g.getResponseHeader(`X-HTTP-Session-Id`):null;e&&(r.wa=e,j(r.J,r.G,e))}}n.I=3,n.l&&n.l.ra(),n.aa&&(n.T=Date.now()-e.F,n.j.info(`Handshake RTT: `+n.T+`ms`)),r=n;var o=e;if(r.na=Vn(r,r.L?r.ba:null,r.W),o.L){At(r.h,o);var s=o,c=r.O;c&&(s.H=c),s.D&&(bt(s),vt(s)),r.g=o}else Mn(r);n.i.length>0&&Dn(n)}else l[0]!=`stop`&&l[0]!=`close`||zn(n,7);else n.I==3&&(l[0]==`stop`||l[0]==`close`?l[0]==`stop`?zn(n,7):wn(n):l[0]!=`noop`&&n.l&&n.l.qa(l),n.A=0)}}Ke(4)}catch{}}var wt=class{constructor(e,t){this.g=e,this.map=t}};function Tt(e){this.l=e||10,o.PerformanceNavigationTiming?(e=o.performance.getEntriesByType(`navigation`),e=e.length>0&&(e[0].nextHopProtocol==`hq`||e[0].nextHopProtocol==`h2`)):e=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Et(e){return e.h?!0:e.g?e.g.size>=e.j:!1}function Dt(e){return e.h?1:e.g?e.g.size:0}function Ot(e,t){return e.h?e.h==t:e.g?e.g.has(t):!1}function kt(e,t){e.g?e.g.add(t):e.h=t}function At(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}Tt.prototype.cancel=function(){if(this.i=jt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let e of this.g.values())e.cancel();this.g.clear()}};function jt(e){if(e.h!=null)return e.i.concat(e.h.G);if(e.g!=null&&e.g.size!==0){let t=e.i;for(let n of e.g.values())t=t.concat(n.G);return t}return p(e.i)}var Mt=RegExp(`^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$`);function Nt(e,t){if(e){e=e.split(`&`);for(let n=0;n<e.length;n++){let r=e[n].indexOf(`=`),i,a=null;r>=0?(i=e[n].substring(0,r),a=e[n].substring(r+1)):i=e[n],t(i,a?decodeURIComponent(a.replace(/\+/g,` `)):``)}}}function Pt(e){this.g=this.o=this.j=``,this.u=null,this.m=this.h=``,this.l=!1;let t;e instanceof Pt?(this.l=e.l,It(this,e.j),this.o=e.o,this.g=e.g,Lt(this,e.u),this.h=e.h,Rt(this,Qt(e.i)),this.m=e.m):e&&(t=String(e).match(Mt))?(this.l=!1,It(this,t[1]||``,!0),this.o=Bt(t[2]||``),this.g=Bt(t[3]||``,!0),Lt(this,t[4]),this.h=Bt(t[5]||``,!0),Rt(this,t[6]||``,!0),this.m=Bt(t[7]||``)):(this.l=!1,this.i=new N(null,this.l))}Pt.prototype.toString=function(){let e=[];var t=this.j;t&&e.push(Vt(t,Ut,!0),`:`);var n=this.g;return(n||t==`file`)&&(e.push(`//`),(t=this.o)&&e.push(Vt(t,Ut,!0),`@`),e.push(st(n).replace(/%25([0-9a-fA-F]{2})/g,`%$1`)),n=this.u,n!=null&&e.push(`:`,String(n))),(n=this.h)&&(this.g&&n.charAt(0)!=`/`&&e.push(`/`),e.push(Vt(n,n.charAt(0)==`/`?Wt:M,!0))),(n=this.i.toString())&&e.push(`?`,n),(n=this.m)&&e.push(`#`,Vt(n,Kt)),e.join(``)},Pt.prototype.resolve=function(e){let t=Ft(this),n=!!e.j;n?It(t,e.j):n=!!e.o,n?t.o=e.o:n=!!e.g,n?t.g=e.g:n=e.u!=null;var r=e.h;if(n)Lt(t,e.u);else if(n=!!e.h){if(r.charAt(0)!=`/`)if(this.g&&!this.h)r=`/`+r;else{var i=t.h.lastIndexOf(`/`);i!=-1&&(r=t.h.slice(0,i+1)+r)}if(i=r,i==`..`||i==`.`)r=``;else if(i.indexOf(`./`)!=-1||i.indexOf(`/.`)!=-1){r=i.lastIndexOf(`/`,0)==0,i=i.split(`/`);let e=[];for(let t=0;t<i.length;){let n=i[t++];n==`.`?r&&t==i.length&&e.push(``):n==`..`?((e.length>1||e.length==1&&e[0]!=``)&&e.pop(),r&&t==i.length&&e.push(``)):(e.push(n),r=!0)}r=e.join(`/`)}else r=i}return n?t.h=r:n=e.i.toString()!==``,n?Rt(t,Qt(e.i)):n=!!e.m,n&&(t.m=e.m),t};function Ft(e){return new Pt(e)}function It(e,t,n){e.j=n?Bt(t,!0):t,e.j&&=e.j.replace(/:$/,``)}function Lt(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error(`Bad port number `+t);e.u=t}else e.u=null}function Rt(e,t,n){t instanceof N?(e.i=t,en(e.i,e.l)):(n||(t=Vt(t,Gt)),e.i=new N(t,e.l))}function j(e,t,n){e.i.set(t,n)}function zt(e){return j(e,`zx`,Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),e}function Bt(e,t){return e?t?decodeURI(e.replace(/%25/g,`%2525`)):decodeURIComponent(e):``}function Vt(e,t,n){return typeof e==`string`?(e=encodeURI(e).replace(t,Ht),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,`%$1`)),e):null}function Ht(e){return e=e.charCodeAt(0),`%`+(e>>4&15).toString(16)+(e&15).toString(16)}var Ut=/[#\/\?@]/g,M=/[#\?:]/g,Wt=/[#\?]/g,Gt=/[#\?@]/g,Kt=/#/g;function N(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function qt(e){e.g||(e.g=new Map,e.h=0,e.i&&Nt(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g,` `)),n)}))}e=N.prototype,e.add=function(e,t){qt(this),this.i=null,e=$t(this,e);let n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this};function Jt(e,t){qt(e),t=$t(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Yt(e,t){return qt(e),t=$t(e,t),e.g.has(t)}e.forEach=function(e,t){qt(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)};function Xt(e,t){qt(e);let n=[];if(typeof t==`string`)Yt(e,t)&&(n=n.concat(e.g.get($t(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)n=n.concat(e[t]);return n}e.set=function(e,t){return qt(this),this.i=null,e=$t(this,e),Yt(this,e)&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e?(e=Xt(this,e),e.length>0?String(e[0]):t):t};function Zt(e,t,n){Jt(e,t),n.length>0&&(e.i=null,e.g.set($t(e,t),p(n)),e.h+=n.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return``;let e=[],t=Array.from(this.g.keys());for(let r=0;r<t.length;r++){var n=t[r];let i=st(n);n=Xt(this,n);for(let t=0;t<n.length;t++){let r=i;n[t]!==``&&(r+=`=`+st(n[t])),e.push(r)}}return this.i=e.join(`&`)};function Qt(e){let t=new N;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function $t(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function en(e,t){t&&!e.j&&(qt(e),e.i=null,e.g.forEach(function(e,t){let n=t.toLowerCase();t!=n&&(Jt(this,t),Zt(this,n,e))},e)),e.j=t}function tn(e,t){let n=new Ze;if(o.Image){let r=new Image;r.onload=u(rn,n,`TestLoadImage: loaded`,!0,t,r),r.onerror=u(rn,n,`TestLoadImage: error`,!1,t,r),r.onabort=u(rn,n,`TestLoadImage: abort`,!1,t,r),r.ontimeout=u(rn,n,`TestLoadImage: timeout`,!1,t,r),o.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}function nn(e,t){let n=new Ze,r=new AbortController,i=setTimeout(()=>{r.abort(),rn(n,`TestPingServer: timeout`,!1,t)},1e4);fetch(e,{signal:r.signal}).then(e=>{clearTimeout(i),e.ok?rn(n,`TestPingServer: ok`,!0,t):rn(n,`TestPingServer: server error`,!1,t)}).catch(()=>{clearTimeout(i),rn(n,`TestPingServer: error`,!1,t)})}function rn(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch{}}function an(){this.g=new Ie}function on(e){this.i=e.Sb||null,this.h=e.ab||!1}d(on,Le),on.prototype.g=function(){return new sn(this.i,this.h)};function sn(e,t){Ee.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText=``,this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F=`GET`,this.D=``,this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}d(sn,Ee),e=sn.prototype,e.open=function(e,t){if(this.readyState!=0)throw this.abort(),Error(`Error reopening a connection`);this.F=e,this.D=t,this.readyState=1,un(this)},e.send=function(e){if(this.readyState!=1)throw this.abort(),Error(`need to call open() first. `);if(this.v.signal.aborted)throw this.abort(),Error(`Request was aborted.`);this.g=!0;let t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||o).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText=``,this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel(`Request was aborted.`).catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ln(this)),this.readyState=0},e.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,un(this)),this.g&&(this.readyState=3,un(this),this.g)))if(this.responseType===`arraybuffer`)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(o.ReadableStream!==void 0&&`body`in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error(`responseType must be empty for "streamBinaryChunks" mode responses.`);this.response=[]}else this.response=this.responseText=``,this.B=new TextDecoder;cn(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))};function cn(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}e.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array;(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?ln(this):un(this),this.readyState==3&&cn(this)}},e.Oa=function(e){this.g&&(this.response=this.responseText=e,ln(this))},e.Na=function(e){this.g&&(this.response=e,ln(this))},e.ga=function(){this.g&&ln(this)};function ln(e){e.readyState=4,e.l=null,e.j=null,e.B=null,un(e)}e.setRequestHeader=function(e,t){this.A.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||``},e.getAllResponseHeaders=function(){if(!this.h)return``;let e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+`: `+n[1]),n=t.next();return e.join(`\r
`)};function un(e){e.onreadystatechange&&e.onreadystatechange.call(e)}Object.defineProperty(sn.prototype,`withCredentials`,{get:function(){return this.m===`include`},set:function(e){this.m=e?`include`:`same-origin`}});function dn(e){let t=``;return D(e,function(e,n){t+=n,t+=`:`,t+=e,t+=`\r
`}),t}function fn(e,t,n){a:{for(r in n){var r=!1;break a}r=!0}r||(n=dn(n),typeof e==`string`||j(e,t,n))}function P(e){Ee.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D=``,this.o=0,this.l=``,this.j=this.B=this.v=this.A=!1,this.m=null,this.F=``,this.H=!1}d(P,Ee);var pn=/^https?$/i,mn=[`POST`,`PUT`];e=P.prototype,e.Fa=function(e){this.H=e},e.ea=function(e,t,n,r){if(this.g)throw Error(`[goog.net.XhrIo] Object is active with another request=`+this.D+`; newUri=`+e);t=t?t.toUpperCase():`GET`,this.D=e,this.l=``,this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():at.g(),this.g.onreadystatechange=f(l(this.Ca,this));try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(e){hn(this,e);return}if(e=n||``,n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys==`function`&&typeof r.get==`function`)for(let e of r.keys())n.set(e,r.get(e));else throw Error(`Unknown input type for opt_headers: `+String(r));r=Array.from(n.keys()).find(e=>e.toLowerCase()==`content-type`),i=o.FormData&&e instanceof o.FormData,!(Array.prototype.indexOf.call(mn,t,void 0)>=0)||r||i||n.set(`Content-Type`,`application/x-www-form-urlencoded;charset=utf-8`);for(let[e,t]of n)this.g.setRequestHeader(e,t);this.F&&(this.g.responseType=this.F),`withCredentials`in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&=(clearTimeout(this.m),null),this.v=!0,this.g.send(e),this.v=!1}catch(e){hn(this,e)}};function hn(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,gn(e),vn(e)}function gn(e){e.A||(e.A=!0,De(e,`complete`),De(e,`error`))}e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,De(this,`complete`),De(this,`abort`),vn(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),vn(this,!0)),P.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?_n(this):this.Xa())},e.Xa=function(){_n(this)};function _n(e){if(e.h&&a!==void 0){if(e.v&&yn(e)==4)setTimeout(e.Ca.bind(e),0);else if(De(e,`readystatechange`),yn(e)==4){e.h=!1;try{let a=e.ca();a:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break a;default:t=!1}var n;if(!(n=t)){var r;if(r=a===0){let t=String(e.D).match(Mt)[1]||null;!t&&o.self&&o.self.location&&(t=o.self.location.protocol.slice(0,-1)),r=!pn.test(t?t.toLowerCase():``)}n=r}if(n)De(e,`complete`),De(e,`success`);else{e.o=6;try{var i=yn(e)>2?e.g.statusText:``}catch{i=``}e.l=i+` [`+e.ca()+`]`,gn(e)}}finally{vn(e)}}}}function vn(e,t){if(e.g){e.m&&=(clearTimeout(e.m),null);let n=e.g;e.g=null,t||De(e,`ready`);try{n.onreadystatechange=null}catch{}}}e.isActive=function(){return!!this.g};function yn(e){return e.g?e.g.readyState:0}e.ca=function(){try{return yn(this)>2?this.g.status:-1}catch{return-1}},e.la=function(){try{return this.g?this.g.responseText:``}catch{return``}},e.La=function(e){if(this.g){var t=this.g.responseText;return e&&t.indexOf(e)==0&&(t=t.substring(e.length)),Fe(t)}};function bn(e){try{if(!e.g)return null;if(`response`in e.g)return e.g.response;switch(e.F){case``:case`text`:return e.g.responseText;case`arraybuffer`:if(`mozResponseArrayBuffer`in e.g)return e.g.mozResponseArrayBuffer}return null}catch{return null}}function xn(e){let t={};e=(e.g&&yn(e)>=2&&e.g.getAllResponseHeaders()||``).split(`\r
`);for(let r=0;r<e.length;r++){if(ie(e[r]))continue;var n=ct(e[r]);let i=n[0];if(n=n[1],typeof n!=`string`)continue;n=n.trim();let a=t[i]||[];t[i]=a,a.push(n)}ce(t,function(e){return e.join(`, `)})}e.ya=function(){return this.o},e.Ha=function(){return typeof this.l==`string`?this.l:String(this.l)};function Sn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Cn(e){this.za=0,this.i=[],this.j=new Ze,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Sn(`failFast`,!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Sn(`baseRetryDelayMs`,5e3,e),this.Za=Sn(`retryDelaySeedMs`,1e4,e),this.Ta=Sn(`forwardChannelMaxRetries`,2,e),this.va=Sn(`forwardChannelRequestTimeoutMs`,2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M=``,this.h=new Tt(e&&e.concurrentRequestLimit),this.Ba=new an,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}e=Cn.prototype,e.ka=8,e.I=1,e.connect=function(e,t,n,r){Je(0),this.W=e,this.H=t||{},n&&r!==void 0&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.J=Vn(this,null,this.W),Dn(this)};function wn(e){if(En(e),e.I==3){var t=e.V++,n=Ft(e.J);if(j(n,`SID`,e.M),j(n,`RID`,t),j(n,`TYPE`,`terminate`),An(e,n),t=new lt(e,e.j,t),t.M=2,t.A=zt(Ft(n)),n=!1,o.navigator&&o.navigator.sendBeacon)try{n=o.navigator.sendBeacon(t.A.toString(),``)}catch{}!n&&o.Image&&(new Image().src=t.A,n=!0),n||(t.g=Hn(t.j,null),t.g.ea(t.A)),t.F=Date.now(),vt(t)}Bn(e)}function Tn(e){e.g&&=(Pn(e),e.g.cancel(),null)}function En(e){Tn(e),e.v&&=(o.clearTimeout(e.v),null),In(e),e.h.cancel(),e.m&&=(typeof e.m==`number`&&o.clearTimeout(e.m),null)}function Dn(e){if(!Et(e.h)&&!e.m){e.m=!0;var t=e.Ea;x||S(),ee||=(x(),!0),te.add(t,e),e.D=0}}function On(e,t){return Dt(e.h)>=e.h.j-(e.m?1:0)?!1:e.m?(e.i=t.G.concat(e.i),!0):e.I==1||e.I==2||e.D>=(e.Sa?0:e.Ta)?!1:(e.m=Xe(l(e.Ea,e,t),Rn(e,e.D)),e.D++,!0)}e.Ea=function(e){if(this.m)if(this.m=null,this.I==1){if(!e){this.V=Math.floor(Math.random()*1e5),e=this.V++;let i=new lt(this,this.j,e),a=this.o;if(this.U&&(a?(a=le(a),de(a,this.U)):a=this.U),this.u!==null||this.R||(i.J=a,a=null),this.S)a:{for(var t=0,n=0;n<this.i.length;n++){b:{var r=this.i[n];if(`__data__`in r.map&&(r=r.map.__data__,typeof r==`string`)){r=r.length;break b}r=void 0}if(r===void 0)break;if(t+=r,t>4096){t=n;break a}if(t===4096||n===this.i.length-1){t=n+1;break a}}t=1e3}else t=1e3;t=jn(this,i,t),n=Ft(this.J),j(n,`RID`,e),j(n,`CVER`,22),this.G&&j(n,`X-HTTP-Session-Id`,this.G),An(this,n),a&&(this.R?t=`headers=`+st(dn(a))+`&`+t:this.u&&fn(n,this.u,a)),kt(this.h,i),this.Ra&&j(n,`TYPE`,`init`),this.S?(j(n,`$req`,t),j(n,`SID`,`null`),i.U=!0,pt(i,n,null)):pt(i,n,t),this.I=2}}else this.I==3&&(e?kn(this,e):this.i.length==0||Et(this.h)||kn(this))};function kn(e,t){var n=t?t.l:e.V++;let r=Ft(e.J);j(r,`SID`,e.M),j(r,`RID`,n),j(r,`AID`,e.K),An(e,r),e.u&&e.o&&fn(r,e.u,e.o),n=new lt(e,e.j,n,e.D+1),e.u===null&&(n.J=e.o),t&&(e.i=t.G.concat(e.i)),t=jn(e,n,1e3),n.H=Math.round(e.va*.5)+Math.round(e.va*.5*Math.random()),kt(e.h,n),pt(n,r,t)}function An(e,t){e.H&&D(e.H,function(e,n){j(t,n,e)}),e.l&&D({},function(e,n){j(t,n,e)})}function jn(e,t,n){n=Math.min(e.i.length,n);let r=e.l?l(e.l.Ka,e.l,e):null;a:{var i=e.i;let t=-1;for(;;){let e=[`count=`+n];t==-1?n>0?(t=i[0].g,e.push(`ofs=`+t)):t=0:e.push(`ofs=`+t);let c=!0;for(let l=0;l<n;l++){var a=i[l].g;let n=i[l].map;if(a-=t,a<0)t=Math.max(0,i[l].g-100),c=!1;else try{a=`req`+a+`_`||``;try{var o=n instanceof Map?n:Object.entries(n);for(let[t,n]of o){let r=n;s(n)&&(r=Pe(n)),e.push(a+t+`=`+encodeURIComponent(r))}}catch(t){throw e.push(a+`type=_badmap`),t}}catch{r&&r(n)}}if(c){o=e.join(`&`);break a}}o=void 0}return e=e.i.splice(0,n),t.G=e,o}function Mn(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;x||S(),ee||=(x(),!0),te.add(t,e),e.A=0}}function Nn(e){return e.g||e.v||e.A>=3?!1:(e.Y++,e.v=Xe(l(e.Da,e),Rn(e,e.A)),e.A++,!0)}e.Da=function(){if(this.v=null,Fn(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var e=4*this.T;this.j.info(`BP detection timer enabled: `+e),this.B=Xe(l(this.Wa,this),e)}},e.Wa=function(){this.B&&(this.B=null,this.j.info(`BP detection timeout reached.`),this.j.info(`Buffering proxy detected and switch to long-polling!`),this.F=!1,this.P=!0,Je(10),Tn(this),Fn(this))};function Pn(e){e.B!=null&&(o.clearTimeout(e.B),e.B=null)}function Fn(e){e.g=new lt(e,e.j,`rpc`,e.Y),e.u===null&&(e.g.J=e.o),e.g.P=0;var t=Ft(e.na);j(t,`RID`,`rpc`),j(t,`SID`,e.M),j(t,`AID`,e.K),j(t,`CI`,e.F?`0`:`1`),!e.F&&e.ia&&j(t,`TO`,e.ia),j(t,`TYPE`,`xmlhttp`),An(e,t),e.u&&e.o&&fn(t,e.u,e.o),e.O&&(e.g.H=e.O);var n=e.g;e=e.ba,n.M=1,n.A=zt(Ft(t)),n.u=null,n.R=!0,mt(n,e)}e.Va=function(){this.C!=null&&(this.C=null,Tn(this),Nn(this),Je(19))};function In(e){e.C!=null&&(o.clearTimeout(e.C),e.C=null)}function Ln(e,t){var n=null;if(e.g==t){In(e),Pn(e),e.g=null;var r=2}else if(Ot(e.h,t))n=t.G,At(e.h,t),r=1;else return;if(e.I!=0){if(t.o)if(r==1){n=t.u?t.u.length:0,t=Date.now()-t.F;var i=e.D;r=We(),De(r,new Ye(r,n)),Dn(e)}else Mn(e);else if(i=t.m,i==3||i==0&&t.X>0||!(r==1&&On(e,t)||r==2&&Nn(e)))switch(n&&n.length>0&&(t=e.h,t.i=t.i.concat(n)),i){case 1:zn(e,5);break;case 4:zn(e,10);break;case 3:zn(e,6);break;default:zn(e,2)}}}function Rn(e,t){let n=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(n*=2),n*t}function zn(e,t){if(e.j.info(`Error code `+t),t==2){var n=l(e.bb,e),r=e.Ua;let t=!r;r=new Pt(r||`//www.google.com/images/cleardot.gif`),o.location&&o.location.protocol==`http`||It(r,`https`),zt(r),t?tn(r.toString(),n):nn(r.toString(),n)}else Je(2);e.I=0,e.l&&e.l.pa(t),Bn(e),En(e)}e.bb=function(e){e?(this.j.info(`Successfully pinged google.com`),Je(2)):(this.j.info(`Failed to ping google.com`),Je(1))};function Bn(e){if(e.I=0,e.ja=[],e.l){let t=jt(e.h);(t.length!=0||e.i.length!=0)&&(m(e.ja,t),m(e.ja,e.i),e.h.i.length=0,p(e.i),e.i.length=0),e.l.oa()}}function Vn(e,t,n){var r=n instanceof Pt?Ft(n):new Pt(n);if(r.g!=``)t&&(r.g=t+`.`+r.g),Lt(r,r.u);else{var i=o.location;r=i.protocol,t=t?t+`.`+i.hostname:i.hostname,i=+i.port;let e=new Pt(null);r&&It(e,r),t&&(e.g=t),i&&Lt(e,i),n&&(e.h=n),r=e}return n=e.G,t=e.wa,n&&t&&j(r,n,t),j(r,`VER`,e.ka),An(e,r),r}function Hn(e,t,n){if(t&&!e.L)throw Error(`Can't create secondary domain capable XhrIo object.`);return t=e.Aa&&!e.ma?new P(new on({ab:n})):new P(e.ma),t.Fa(e.L),t}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Un(){}e=Un.prototype,e.ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){};function Wn(){}Wn.prototype.g=function(e,t){return new Gn(e,t)};function Gn(e,t){Ee.call(this),this.g=new Cn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e[`X-Client-Protocol`]=`webchannel`:e={"X-Client-Protocol":`webchannel`}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e[`X-WebChannel-Content-Type`]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e[`X-WebChannel-Client-Profile`]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!ie(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t&&=t.httpSessionIdParam)&&!ie(t)&&(this.g.G=t,e=this.h,e!==null&&t in e&&(e=this.h,t in e&&delete e[t])),this.j=new Jn(this)}d(Gn,Ee),Gn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Gn.prototype.close=function(){wn(this.g)},Gn.prototype.o=function(e){var t=this.g;if(typeof e==`string`){var n={};n.__data__=e,e=n}else this.v&&(n={},n.__data__=Pe(e),e=n);t.i.push(new wt(t.Ya++,e)),t.I==3&&Dn(t)},Gn.prototype.N=function(){this.g.l=null,delete this.j,wn(this.g),delete this.g,Gn.Z.N.call(this)};function Kn(e){Be.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){a:{for(let n in t){e=n;break a}e=void 0}(this.i=e)&&(e=this.i,t=t!==null&&e in t?t[e]:void 0),this.data=t}else this.data=e}d(Kn,Be);function qn(){Ve.call(this),this.status=1}d(qn,Ve);function Jn(e){this.g=e}d(Jn,Un),Jn.prototype.ra=function(){De(this.g,`a`)},Jn.prototype.qa=function(e){De(this.g,new Kn(e))},Jn.prototype.pa=function(e){De(this.g,new qn)},Jn.prototype.oa=function(){De(this.g,`b`)},Wn.prototype.createWebChannel=Wn.prototype.g,Gn.prototype.send=Gn.prototype.o,Gn.prototype.open=Gn.prototype.m,Gn.prototype.close=Gn.prototype.close,El=vl.createWebChannelTransport=function(){return new Wn},Tl=vl.getStatEventTarget=function(){return We()},wl=vl.Event=He,Cl=vl.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},rt.NO_ERROR=0,rt.TIMEOUT=8,rt.HTTP_ERROR=6,Sl=vl.ErrorCode=rt,it.COMPLETE=`complete`,xl=vl.EventType=it,Re.EventType=ze,ze.OPEN=`a`,ze.CLOSE=`b`,ze.ERROR=`c`,ze.MESSAGE=`d`,Ee.prototype.listen=Ee.prototype.J,bl=vl.WebChannel=Re,vl.FetchXmlHttpFactory=on,P.prototype.listenOnce=P.prototype.K,P.prototype.getLastError=P.prototype.Ha,P.prototype.getLastErrorCode=P.prototype.ya,P.prototype.getStatus=P.prototype.ca,P.prototype.getResponseJson=P.prototype.La,P.prototype.getResponseText=P.prototype.la,P.prototype.send=P.prototype.ea,P.prototype.setWithCredentials=P.prototype.Fa,yl=vl.XhrIo=P}).apply(_l===void 0?typeof self<`u`?self:typeof window<`u`?window:{}:_l);var Dl=`@firebase/firestore`,Ol=`4.9.3`,kl=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?`uid:`+this.uid:`anonymous-user`}isEqual(e){return e.uid===this.uid}};kl.UNAUTHENTICATED=new kl(null),kl.GOOGLE_CREDENTIALS=new kl(`google-credentials-uid`),kl.FIRST_PARTY=new kl(`first-party-uid`),kl.MOCK_USER=new kl(`mock-user`);var Al=`12.7.0`,jl=new Ns(`@firebase/firestore`);function Ml(){return jl.logLevel}function z(e,...t){if(jl.logLevel<=R.DEBUG){let n=t.map(Fl);jl.debug(`Firestore (${Al}): ${e}`,...n)}}function Nl(e,...t){if(jl.logLevel<=R.ERROR){let n=t.map(Fl);jl.error(`Firestore (${Al}): ${e}`,...n)}}function Pl(e,...t){if(jl.logLevel<=R.WARN){let n=t.map(Fl);jl.warn(`Firestore (${Al}): ${e}`,...n)}}function Fl(e){if(typeof e==`string`)return e;try{return function(e){return JSON.stringify(e)}(e)}catch{return e}}function B(e,t,n){let r=`Unexpected state`;typeof t==`string`?r=t:n=t,Il(e,r,n)}function Il(e,t,n){let r=`FIRESTORE (${Al}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(n!==void 0)try{r+=` CONTEXT: `+JSON.stringify(n)}catch{r+=` CONTEXT: `+n}throw Nl(r),Error(r)}function V(e,t,n,r){let i=`Unexpected state`;typeof n==`string`?i=n:r=n,e||Il(t,i,r)}function H(e,t){return e}var U={OK:`ok`,CANCELLED:`cancelled`,UNKNOWN:`unknown`,INVALID_ARGUMENT:`invalid-argument`,DEADLINE_EXCEEDED:`deadline-exceeded`,NOT_FOUND:`not-found`,ALREADY_EXISTS:`already-exists`,PERMISSION_DENIED:`permission-denied`,UNAUTHENTICATED:`unauthenticated`,RESOURCE_EXHAUSTED:`resource-exhausted`,FAILED_PRECONDITION:`failed-precondition`,ABORTED:`aborted`,OUT_OF_RANGE:`out-of-range`,UNIMPLEMENTED:`unimplemented`,INTERNAL:`internal`,UNAVAILABLE:`unavailable`,DATA_LOSS:`data-loss`},W=class extends ss{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}},Ll=class{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}},Rl=class{constructor(e,t){this.user=t,this.type=`OAuth`,this.headers=new Map,this.headers.set(`Authorization`,`Bearer ${e}`)}},zl=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(kl.UNAUTHENTICATED)))}shutdown(){}},Bl=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}},Vl=class{constructor(e){this.t=e,this.currentUser=kl.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){V(this.o===void 0,42304);let n=this.i,r=e=>this.i===n?Promise.resolve():(n=this.i,t(e)),i=new Ll;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ll,e.enqueueRetryable((()=>r(this.currentUser)))};let a=()=>{let t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{z(`FirebaseAuthCredentialsProvider`,`Auth detected`),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){let e=this.t.getImmediate({optional:!0});e?o(e):(z(`FirebaseAuthCredentialsProvider`,`Auth not yet detected`),i.resolve(),i=new Ll)}}),0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i===e?t?(V(typeof t.accessToken==`string`,31837,{l:t}),new Rl(t.accessToken,this.currentUser)):null:(z(`FirebaseAuthCredentialsProvider`,`getToken aborted due to token change.`),this.getToken()))):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return V(e===null||typeof e==`string`,2055,{h:e}),new kl(e)}},Hl=class{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type=`FirstParty`,this.user=kl.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set(`X-Goog-AuthUser`,this.P);let e=this.R();return e&&this.A.set(`Authorization`,e),this.T&&this.A.set(`X-Goog-Iam-Authorization-Token`,this.T),this.A}},Ul=class{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new Hl(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(kl.FIRST_PARTY)))}shutdown(){}invalidateToken(){}},Wl=class{constructor(e){this.value=e,this.type=`AppCheck`,this.headers=new Map,e&&e.length>0&&this.headers.set(`x-firebase-appcheck`,this.value)}},Gl=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Uc(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){V(this.o===void 0,3512);let n=e=>{e.error!=null&&z(`FirebaseAppCheckTokenProvider`,`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);let n=e.token!==this.m;return this.m=e.token,z(`FirebaseAppCheckTokenProvider`,`Received ${n?`new`:`existing`} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};let r=e=>{z(`FirebaseAppCheckTokenProvider`,`AppCheck detected`),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){let e=this.V.getImmediate({optional:!0});e?r(e):z(`FirebaseAppCheckTokenProvider`,`AppCheck not yet detected`)}}),0)}getToken(){if(this.p)return Promise.resolve(new Wl(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(V(typeof e.token==`string`,44558,{tokenResult:e}),this.m=e.token,new Wl(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function Kl(e){let t=typeof self<`u`&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues==`function`)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}var ql=class{static newId(){let e=``;for(;e.length<20;){let t=Kl(40);for(let n=0;n<t.length;++n)e.length<20&&t[n]<248&&(e+=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789`.charAt(t[n]%62))}return e}};function G(e,t){return e<t?-1:e>t?1:0}function Jl(e,t){let n=Math.min(e.length,t.length);for(let r=0;r<n;r++){let n=e.charAt(r),i=t.charAt(r);if(n!==i)return Zl(n)===Zl(i)?G(n,i):Zl(n)?1:-1}return G(e.length,t.length)}var Yl=55296,Xl=57343;function Zl(e){let t=e.charCodeAt(0);return t>=Yl&&t<=Xl}function Ql(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}var $l=`__name__`,eu=class e{constructor(e,t,n){t===void 0?t=0:t>e.length&&B(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&B(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(t){return e.comparator(this,t)===0}child(t){let n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((e=>{n.push(e)})):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){let r=Math.min(t.length,n.length);for(let i=0;i<r;i++){let r=e.compareSegments(t.get(i),n.get(i));if(r!==0)return r}return G(t.length,n.length)}static compareSegments(t,n){let r=e.isNumericId(t),i=e.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?e.extractNumericId(t).compare(e.extractNumericId(n)):Jl(t,n)}static isNumericId(e){return e.startsWith(`__id`)&&e.endsWith(`__`)}static extractNumericId(e){return hl.fromString(e.substring(4,e.length-2))}},K=class e extends eu{construct(t,n,r){return new e(t,n,r)}canonicalString(){return this.toArray().join(`/`)}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join(`/`)}static fromString(...t){let n=[];for(let e of t){if(e.indexOf(`//`)>=0)throw new W(U.INVALID_ARGUMENT,`Invalid segment (${e}). Paths must not contain // in them.`);n.push(...e.split(`/`).filter((e=>e.length>0)))}return new e(n)}static emptyPath(){return new e([])}},tu=/^[_a-zA-Z][_a-zA-Z0-9]*$/,nu=class e extends eu{construct(t,n,r){return new e(t,n,r)}static isValidIdentifier(e){return tu.test(e)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,`\\\\`).replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(`.`)}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===$l}static keyField(){return new e([$l])}static fromServerFormat(t){let n=[],r=``,i=0,a=()=>{if(r.length===0)throw new W(U.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=``},o=!1;for(;i<t.length;){let e=t[i];if(e===`\\`){if(i+1===t.length)throw new W(U.INVALID_ARGUMENT,`Path has trailing escape character: `+t);let e=t[i+1];if(e!==`\\`&&e!==`.`&&e!=="`")throw new W(U.INVALID_ARGUMENT,`Path has invalid escape sequence: `+t);r+=e,i+=2}else e==="`"?(o=!o,i++):e!==`.`||o?(r+=e,i++):(a(),i++)}if(a(),o)throw new W(U.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)}static emptyPath(){return new e([])}},q=class e{constructor(e){this.path=e}static fromPath(t){return new e(K.fromString(t))}static fromName(t){return new e(K.fromString(t).popFirst(5))}static empty(){return new e(K.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&K.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return K.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(t){return new e(new K(t.slice()))}};function ru(e,t,n){if(!n)throw new W(U.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function iu(e,t,n,r){if(!0===t&&!0===r)throw new W(U.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function au(e){if(!q.isDocumentKey(e))throw new W(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function ou(e){if(q.isDocumentKey(e))throw new W(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function su(e){return typeof e==`object`&&!!e&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function cu(e){if(e===void 0)return`undefined`;if(e===null)return`null`;if(typeof e==`string`)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e==`number`||typeof e==`boolean`)return``+e;if(typeof e==`object`){if(e instanceof Array)return`an array`;{let t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:`an object`}}return typeof e==`function`?`a function`:B(12329,{type:typeof e})}function lu(e,t){if(`_delegate`in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new W(U.INVALID_ARGUMENT,`Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?`);{let n=cu(e);throw new W(U.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function uu(e,t){let n={typeString:e};return t&&(n.value=t),n}function du(e,t){if(!su(e))throw new W(U.INVALID_ARGUMENT,`JSON must be an object`);let n;for(let r in t)if(t[r]){let i=t[r].typeString,a=`value`in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}let o=e[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&o!==a.value){n=`Expected '${r}' field to equal '${a.value}'`;break}}if(n)throw new W(U.INVALID_ARGUMENT,n);return!0}var fu=-62135596800,pu=1e6,mu=class e{static now(){return e.fromMillis(Date.now())}static fromDate(t){return e.fromMillis(t.getTime())}static fromMillis(t){let n=Math.floor(t/1e3);return new e(n,Math.floor((t-1e3*n)*pu))}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0||t>=1e9)throw new W(U.INVALID_ARGUMENT,`Timestamp nanoseconds out of range: `+t);if(e<fu||e>=253402300800)throw new W(U.INVALID_ARGUMENT,`Timestamp seconds out of range: `+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/pu}_compareTo(e){return this.seconds===e.seconds?G(this.nanoseconds,e.nanoseconds):G(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return`Timestamp(seconds=`+this.seconds+`, nanoseconds=`+this.nanoseconds+`)`}toJSON(){return{type:e._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(du(t,e._jsonSchema))return new e(t.seconds,t.nanoseconds)}valueOf(){let e=this.seconds-fu;return String(e).padStart(12,`0`)+`.`+String(this.nanoseconds).padStart(9,`0`)}};mu._jsonSchemaVersion=`firestore/timestamp/1.0`,mu._jsonSchema={type:uu(`string`,mu._jsonSchemaVersion),seconds:uu(`number`),nanoseconds:uu(`number`)};var J=class e{static fromTimestamp(t){return new e(t)}static min(){return new e(new mu(0,0))}static max(){return new e(new mu(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return`SnapshotVersion(`+this.timestamp.toString()+`)`}toTimestamp(){return this.timestamp}},hu=-1,gu=class{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}};gu.UNKNOWN_ID=-1;function _u(e,t){let n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1;return new yu(J.fromTimestamp(r===1e9?new mu(n+1,0):new mu(n,r)),q.empty(),t)}function vu(e){return new yu(e.readTime,e.key,hu)}var yu=class e{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new e(J.min(),q.empty(),hu)}static max(){return new e(J.max(),q.empty(),hu)}};function bu(e,t){let n=e.readTime.compareTo(t.readTime);return n===0?(n=q.comparator(e.documentKey,t.documentKey),n===0?G(e.largestBatchId,t.largestBatchId):n):n}var xu=`The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.`,Su=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}};async function Cu(e){if(e.code!==U.FAILED_PRECONDITION||e.message!==xu)throw e;z(`LocalStore`,`Unexpectedly lost primary lease`)}var Y=class e{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(t,n){return this.callbackAttached&&B(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(((e,r)=>{this.nextCallback=n=>{this.wrapSuccess(t,n).next(e,r)},this.catchCallback=t=>{this.wrapFailure(n,t).next(e,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(t){try{let n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}wrapSuccess(t,n){return t?this.wrapUserFunction((()=>t(n))):e.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction((()=>t(n))):e.reject(n)}static resolve(t){return new e(((e,n)=>{e(t)}))}static reject(t){return new e(((e,n)=>{n(t)}))}static waitFor(t){return new e(((e,n)=>{let r=0,i=0,a=!1;t.forEach((t=>{++r,t.next((()=>{++i,a&&i===r&&e()}),(e=>n(e)))})),a=!0,i===r&&e()}))}static or(t){let n=e.resolve(!1);for(let r of t)n=n.next((t=>t?e.resolve(t):r()));return n}static forEach(e,t){let n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(t,n){return new e(((e,r)=>{let i=t.length,a=Array(i),o=0;for(let s=0;s<i;s++){let c=s;n(t[c]).next((t=>{a[c]=t,++o,o===i&&e(a)}),(e=>r(e)))}}))}static doWhile(t,n){return new e(((e,r)=>{let i=()=>{!0===t()?n().next((()=>{i()}),r):e()};i()}))}};function wu(e){let t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(`.`).slice(0,2).join(`.`):`-1`;return Number(n)}function Tu(e){return e.name===`IndexedDbTransactionError`}var Eu=class{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.ue&&this.ue(e),e}};Eu.ce=-1;var Du=-1;function Ou(e){return e==null}function ku(e){return e===0&&1/e==-1/0}function Au(e){return typeof e==`number`&&Number.isInteger(e)&&!ku(e)&&e<=2**53-1&&e>=-(2**53-1)}var ju=``;function Mu(e){let t=``;for(let n=0;n<e.length;n++)t.length>0&&(t=Pu(t)),t=Nu(e.get(n),t);return Pu(t)}function Nu(e,t){let n=t,r=e.length;for(let t=0;t<r;t++){let r=e.charAt(t);switch(r){case`\0`:n+=``;break;case ju:n+=``;break;default:n+=r}}return n}function Pu(e){return e+ju+``}function Fu(e){let t=0;for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Iu(e,t){for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Lu(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var Ru=class e{constructor(e,t){this.comparator=e,this.root=t||Bu.EMPTY}insert(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Bu.BLACK,null,null))}remove(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Bu.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){let e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(`, `)}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new zu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new zu(this.root,e,this.comparator,!1)}getReverseIterator(){return new zu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new zu(this.root,e,this.comparator,!0)}},zu=class{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Bu=class e{constructor(t,n,r,i,a){this.key=t,this.value=n,this.color=r??e.RED,this.left=i??e.EMPTY,this.right=a??e.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,i,a){return new e(t??this.key,n??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this,i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return e.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(t,i.key)===0){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){let t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){return 2**this.check()<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw B(43730,{key:this.key,value:this.value});if(this.right.isRed())throw B(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw B(27949);return e+(this.isRed()?0:1)}};Bu.EMPTY=null,Bu.RED=!0,Bu.BLACK=!1,Bu.EMPTY=new class{constructor(){this.size=0}get key(){throw B(57766)}get value(){throw B(16141)}get color(){throw B(16727)}get left(){throw B(29726)}get right(){throw B(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new Bu(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Vu=class e{constructor(e){this.comparator=e,this.data=new Ru(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=t===void 0?this.data.getIterator():this.data.getIteratorFrom(t);n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Hu(this.data.getIterator())}getIteratorFrom(e){return new Hu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(t){if(!(t instanceof e)||this.size!==t.size)return!1;let n=this.data.getIterator(),r=t.data.getIterator();for(;n.hasNext();){let e=n.getNext().key,t=r.getNext().key;if(this.comparator(e,t)!==0)return!1}return!0}toArray(){let e=[];return this.forEach((t=>{e.push(t)})),e}toString(){let e=[];return this.forEach((t=>e.push(t))),`SortedSet(`+e.toString()+`)`}copy(t){let n=new e(this.comparator);return n.data=t,n}},Hu=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}},Uu=class e{constructor(e){this.fields=e,e.sort(nu.comparator)}static empty(){return new e([])}unionWith(t){let n=new Vu(nu.comparator);for(let e of this.fields)n=n.add(e);for(let e of t)n=n.add(e);return new e(n.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ql(this.fields,e.fields,((e,t)=>e.isEqual(t)))}},Wu=class extends Error{constructor(){super(...arguments),this.name=`Base64DecodeError`}},Gu=class e{constructor(e){this.binaryString=e}static fromBase64String(t){return new e(function(e){try{return atob(e)}catch(e){throw typeof DOMException<`u`&&e instanceof DOMException?new Wu(`Invalid base64 string: `+e):e}}(t))}static fromUint8Array(t){return new e(function(e){let t=``;for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(t))}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){let t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return G(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Gu.EMPTY_BYTE_STRING=new Gu(``);var Ku=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qu(e){if(V(!!e,39018),typeof e==`string`){let t=0,n=Ku.exec(e);if(V(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+`000000000`).substr(0,9),t=Number(e)}let r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:X(e.seconds),nanos:X(e.nanos)}}function X(e){return typeof e==`number`?e:typeof e==`string`?Number(e):0}function Ju(e){return typeof e==`string`?Gu.fromBase64String(e):Gu.fromUint8Array(e)}var Yu=`server_timestamp`,Xu=`__type__`,Zu=`__previous_value__`,Qu=`__local_write_time__`;function $u(e){return(e?.mapValue?.fields||{})[Xu]?.stringValue===Yu}function ed(e){let t=e.mapValue.fields[Zu];return $u(t)?ed(t):t}function td(e){let t=qu(e.mapValue.fields[Qu].timestampValue);return new mu(t.seconds,t.nanos)}var nd=class{constructor(e,t,n,r,i,a,o,s,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=s,this.useFetchStreams=c,this.isUsingEmulator=l}},rd=`(default)`,id=class e{constructor(e,t){this.projectId=e,this.database=t||rd}static empty(){return new e(``,``)}get isDefaultDatabase(){return this.database===rd}isEqual(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}},ad=`__type__`,od=`__max__`,sd={mapValue:{fields:{__type__:{stringValue:od}}}},cd=`__vector__`,ld=`value`;function ud(e){return`nullValue`in e?0:`booleanValue`in e?1:`integerValue`in e||`doubleValue`in e?2:`timestampValue`in e?3:`stringValue`in e?5:`bytesValue`in e?6:`referenceValue`in e?7:`geoPointValue`in e?8:`arrayValue`in e?9:`mapValue`in e?$u(e)?4:Dd(e)?9007199254740991:Td(e)?10:11:B(28295,{value:e})}function dd(e,t){if(e===t)return!0;let n=ud(e);if(n!==ud(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return td(e).isEqual(td(t));case 3:return function(e,t){if(typeof e.timestampValue==`string`&&typeof t.timestampValue==`string`&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;let n=qu(e.timestampValue),r=qu(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Ju(e.bytesValue).isEqual(Ju(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return X(e.geoPointValue.latitude)===X(t.geoPointValue.latitude)&&X(e.geoPointValue.longitude)===X(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if(`integerValue`in e&&`integerValue`in t)return X(e.integerValue)===X(t.integerValue);if(`doubleValue`in e&&`doubleValue`in t){let n=X(e.doubleValue),r=X(t.doubleValue);return n===r?ku(n)===ku(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Ql(e.arrayValue.values||[],t.arrayValue.values||[],dd);case 10:case 11:return function(e,t){let n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Fu(n)!==Fu(r))return!1;for(let e in n)if(n.hasOwnProperty(e)&&(r[e]===void 0||!dd(n[e],r[e])))return!1;return!0}(e,t);default:return B(52216,{left:e})}}function fd(e,t){return(e.values||[]).find((e=>dd(e,t)))!==void 0}function pd(e,t){if(e===t)return 0;let n=ud(e),r=ud(t);if(n!==r)return G(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return G(e.booleanValue,t.booleanValue);case 2:return function(e,t){let n=X(e.integerValue||e.doubleValue),r=X(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return md(e.timestampValue,t.timestampValue);case 4:return md(td(e),td(t));case 5:return Jl(e.stringValue,t.stringValue);case 6:return function(e,t){let n=Ju(e),r=Ju(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){let n=e.split(`/`),r=t.split(`/`);for(let e=0;e<n.length&&e<r.length;e++){let t=G(n[e],r[e]);if(t!==0)return t}return G(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){let n=G(X(e.latitude),X(t.latitude));return n===0?G(X(e.longitude),X(t.longitude)):n}(e.geoPointValue,t.geoPointValue);case 9:return hd(e.arrayValue,t.arrayValue);case 10:return function(e,t){let n=e.fields||{},r=t.fields||{},i=n[ld]?.arrayValue,a=r[ld]?.arrayValue,o=G(i?.values?.length||0,a?.values?.length||0);return o===0?hd(i,a):o}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===sd.mapValue&&t===sd.mapValue)return 0;if(e===sd.mapValue)return 1;if(t===sd.mapValue)return-1;let n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(let e=0;e<r.length&&e<a.length;++e){let t=Jl(r[e],a[e]);if(t!==0)return t;let o=pd(n[r[e]],i[a[e]]);if(o!==0)return o}return G(r.length,a.length)}(e.mapValue,t.mapValue);default:throw B(23264,{he:n})}}function md(e,t){if(typeof e==`string`&&typeof t==`string`&&e.length===t.length)return G(e,t);let n=qu(e),r=qu(t),i=G(n.seconds,r.seconds);return i===0?G(n.nanos,r.nanos):i}function hd(e,t){let n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){let t=pd(n[e],r[e]);if(t)return t}return G(n.length,r.length)}function gd(e){return _d(e)}function _d(e){return`nullValue`in e?`null`:`booleanValue`in e?``+e.booleanValue:`integerValue`in e?``+e.integerValue:`doubleValue`in e?``+e.doubleValue:`timestampValue`in e?function(e){let t=qu(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):`stringValue`in e?e.stringValue:`bytesValue`in e?function(e){return Ju(e).toBase64()}(e.bytesValue):`referenceValue`in e?function(e){return q.fromName(e).toString()}(e.referenceValue):`geoPointValue`in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):`arrayValue`in e?function(e){let t=`[`,n=!0;for(let r of e.values||[])n?n=!1:t+=`,`,t+=_d(r);return t+`]`}(e.arrayValue):`mapValue`in e?function(e){let t=Object.keys(e.fields||{}).sort(),n=`{`,r=!0;for(let i of t)r?r=!1:n+=`,`,n+=`${i}:${_d(e.fields[i])}`;return n+`}`}(e.mapValue):B(61005,{value:e})}function vd(e){switch(ud(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let t=ed(e);return t?16+vd(t):16;case 5:return 2*e.stringValue.length;case 6:return Ju(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(((e,t)=>e+vd(t)),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return Iu(e.fields,((e,n)=>{t+=e.length+vd(n)})),t}(e.mapValue);default:throw B(13486,{value:e})}}function yd(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function bd(e){return!!e&&`integerValue`in e}function xd(e){return!!e&&`arrayValue`in e}function Sd(e){return!!e&&`nullValue`in e}function Cd(e){return!!e&&`doubleValue`in e&&isNaN(Number(e.doubleValue))}function wd(e){return!!e&&`mapValue`in e}function Td(e){return(e?.mapValue?.fields||{})[ad]?.stringValue===cd}function Ed(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&typeof e.timestampValue==`object`)return{timestampValue:{...e.timestampValue}};if(e.mapValue){let t={mapValue:{fields:{}}};return Iu(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Ed(n))),t}if(e.arrayValue){let t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Ed(e.arrayValue.values[n]);return t}return{...e}}function Dd(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===od}var Od=class e{constructor(e){this.value=e}static empty(){return new e({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!wd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ed(t)}setAll(e){let t=nu.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){let e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Ed(e):r.push(i.lastSegment())}));let i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){let t=this.field(e.popLast());wd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return dd(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];wd(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Iu(t,((t,n)=>e[t]=n));for(let t of n)delete e[t]}clone(){return new e(Ed(this.value))}};function kd(e){let t=[];return Iu(e.fields,((e,n)=>{let r=new nu([e]);if(wd(n)){let e=kd(n.mapValue).fields;if(e.length===0)t.push(r);else for(let n of e)t.push(r.child(n))}else t.push(r)})),new Uu(t)}var Ad=class e{constructor(e,t,n,r,i,a,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(t){return new e(t,0,J.min(),J.min(),J.min(),Od.empty(),0)}static newFoundDocument(t,n,r,i){return new e(t,1,n,J.min(),r,i,0)}static newNoDocument(t,n){return new e(t,2,n,J.min(),J.min(),Od.empty(),0)}static newUnknownDocument(t,n){return new e(t,3,n,J.min(),J.min(),Od.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(J.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Od.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Od.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=J.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new e(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}},jd=class{constructor(e,t){this.position=e,this.inclusive=t}};function Md(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){let a=t[i],o=e.position[i];if(r=a.field.isKeyField()?q.comparator(q.fromName(o.referenceValue),n.key):pd(o,n.data.field(a.field)),a.dir===`desc`&&(r*=-1),r!==0)break}return r}function Nd(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!dd(e.position[n],t.position[n]))return!1;return!0}var Pd=class{constructor(e,t=`asc`){this.field=e,this.dir=t}};function Fd(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}var Id=class{},Ld=class e extends Id{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(t,n,r){return t.isKeyField()?n===`in`||n===`not-in`?this.createKeyFieldInFilter(t,n,r):new Gd(t,n,r):n===`array-contains`?new Yd(t,r):n===`in`?new Xd(t,r):n===`not-in`?new Zd(t,r):n===`array-contains-any`?new Qd(t,r):new e(t,n,r)}static createKeyFieldInFilter(e,t,n){return t===`in`?new Kd(e,n):new qd(e,n)}matches(e){let t=e.data.field(this.field);return this.op===`!=`?t!==null&&t.nullValue===void 0&&this.matchesComparison(pd(t,this.value)):t!==null&&ud(this.value)===ud(t)&&this.matchesComparison(pd(t,this.value))}matchesComparison(e){switch(this.op){case`<`:return e<0;case`<=`:return e<=0;case`==`:return e===0;case`!=`:return e!==0;case`>`:return e>0;case`>=`:return e>=0;default:return B(47266,{operator:this.op})}}isInequality(){return[`<`,`<=`,`>`,`>=`,`!=`,`not-in`].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Rd=class e extends Id{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(t,n){return new e(t,n)}matches(e){return zd(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function zd(e){return e.op===`and`}function Bd(e){return Vd(e)&&zd(e)}function Vd(e){for(let t of e.filters)if(t instanceof Rd)return!1;return!0}function Hd(e){if(e instanceof Ld)return e.field.canonicalString()+e.op.toString()+gd(e.value);if(Bd(e))return e.filters.map((e=>Hd(e))).join(`,`);{let t=e.filters.map((e=>Hd(e))).join(`,`);return`${e.op}(${t})`}}function Ud(e,t){return e instanceof Ld?function(e,t){return t instanceof Ld&&e.op===t.op&&e.field.isEqual(t.field)&&dd(e.value,t.value)}(e,t):e instanceof Rd?function(e,t){return t instanceof Rd&&e.op===t.op&&e.filters.length===t.filters.length?e.filters.reduce(((e,n,r)=>e&&Ud(n,t.filters[r])),!0):!1}(e,t):void B(19439)}function Wd(e){return e instanceof Ld?function(e){return`${e.field.canonicalString()} ${e.op} ${gd(e.value)}`}(e):e instanceof Rd?function(e){return e.op.toString()+` {`+e.getFilters().map(Wd).join(` ,`)+`}`}(e):`Filter`}var Gd=class extends Ld{constructor(e,t,n){super(e,t,n),this.key=q.fromName(n.referenceValue)}matches(e){let t=q.comparator(e.key,this.key);return this.matchesComparison(t)}},Kd=class extends Ld{constructor(e,t){super(e,`in`,t),this.keys=Jd(`in`,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}},qd=class extends Ld{constructor(e,t){super(e,`not-in`,t),this.keys=Jd(`not-in`,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}};function Jd(e,t){return(t.arrayValue?.values||[]).map((e=>q.fromName(e.referenceValue)))}var Yd=class extends Ld{constructor(e,t){super(e,`array-contains`,t)}matches(e){let t=e.data.field(this.field);return xd(t)&&fd(t.arrayValue,this.value)}},Xd=class extends Ld{constructor(e,t){super(e,`in`,t)}matches(e){let t=e.data.field(this.field);return t!==null&&fd(this.value.arrayValue,t)}},Zd=class extends Ld{constructor(e,t){super(e,`not-in`,t)}matches(e){if(fd(this.value.arrayValue,{nullValue:`NULL_VALUE`}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!fd(this.value.arrayValue,t)}},Qd=class extends Ld{constructor(e,t){super(e,`array-contains-any`,t)}matches(e){let t=e.data.field(this.field);return!(!xd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>fd(this.value.arrayValue,e)))}},$d=class{constructor(e,t=null,n=[],r=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=a,this.endAt=o,this.Te=null}};function ef(e,t=null,n=[],r=[],i=null,a=null,o=null){return new $d(e,t,n,r,i,a,o)}function tf(e){let t=H(e);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+=`|cg:`+t.collectionGroup),e+=`|f:`,e+=t.filters.map((e=>Hd(e))).join(`,`),e+=`|ob:`,e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(`,`),Ou(t.limit)||(e+=`|l:`,e+=t.limit),t.startAt&&(e+=`|lb:`,e+=t.startAt.inclusive?`b:`:`a:`,e+=t.startAt.position.map((e=>gd(e))).join(`,`)),t.endAt&&(e+=`|ub:`,e+=t.endAt.inclusive?`a:`:`b:`,e+=t.endAt.position.map((e=>gd(e))).join(`,`)),t.Te=e}return t.Te}function nf(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Fd(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Ud(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Nd(e.startAt,t.startAt)&&Nd(e.endAt,t.endAt)}function rf(e){return q.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}var af=class{constructor(e,t=null,n=[],r=[],i=null,a=`F`,o=null,s=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=s,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}};function of(e,t,n,r,i,a,o,s){return new af(e,t,n,r,i,a,o,s)}function sf(e){return new af(e)}function cf(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function lf(e){return e.collectionGroup!==null}function uf(e){let t=H(e);if(t.Ie===null){t.Ie=[];let e=new Set;for(let n of t.explicitOrderBy)t.Ie.push(n),e.add(n.field.canonicalString());let n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:`asc`;(function(e){let t=new Vu(nu.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t})(t).forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new Pd(r,n))})),e.has(nu.keyField().canonicalString())||t.Ie.push(new Pd(nu.keyField(),n))}return t.Ie}function df(e){let t=H(e);return t.Ee||=ff(t,uf(e)),t.Ee}function ff(e,t){if(e.limitType===`F`)return ef(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{let t=e.dir===`desc`?`asc`:`desc`;return new Pd(e.field,t)}));let n=e.endAt?new jd(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new jd(e.startAt.position,e.startAt.inclusive):null;return ef(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function pf(e,t){let n=e.filters.concat([t]);return new af(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function mf(e,t,n){return new af(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function hf(e,t){return nf(df(e),df(t))&&e.limitType===t.limitType}function gf(e){return`${tf(df(e))}|lt:${e.limitType}`}function _f(e){return`Query(target=${function(e){let t=e.path.canonicalString();return e.collectionGroup!==null&&(t+=` collectionGroup=`+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>Wd(e))).join(`, `)}]`),Ou(e.limit)||(t+=`, limit: `+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(`, `)}]`),e.startAt&&(t+=`, startAt: `,t+=e.startAt.inclusive?`b:`:`a:`,t+=e.startAt.position.map((e=>gd(e))).join(`,`)),e.endAt&&(t+=`, endAt: `,t+=e.endAt.inclusive?`a:`:`b:`,t+=e.endAt.position.map((e=>gd(e))).join(`,`)),`Target(${t})`}(df(e))}; limitType=${e.limitType})`}function vf(e,t){return t.isFoundDocument()&&function(e,t){let n=t.key.path;return e.collectionGroup===null?q.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n):t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n)}(e,t)&&function(e,t){for(let n of uf(e))if(!n.field.isKeyField()&&t.data.field(n.field)===null)return!1;return!0}(e,t)&&function(e,t){for(let n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){let r=Md(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,uf(e),t)||e.endAt&&!function(e,t,n){let r=Md(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,uf(e),t))}(e,t)}function yf(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function bf(e){return(t,n)=>{let r=!1;for(let i of uf(e)){let e=xf(i,t,n);if(e!==0)return e;r||=i.field.isKeyField()}return 0}}function xf(e,t,n){let r=e.field.isKeyField()?q.comparator(t.key,n.key):function(e,t,n){let r=t.data.field(e),i=n.data.field(e);return r!==null&&i!==null?pd(r,i):B(42886)}(e.field,t,n);switch(e.dir){case`asc`:return r;case`desc`:return-1*r;default:return B(19790,{direction:e.dir})}}var Sf=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(let[t,r]of n)if(this.equalsFn(t,e))return r}}has(e){return this.get(e)!==void 0}set(e,t){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Iu(this.inner,((t,n)=>{for(let[t,r]of n)e(t,r)}))}isEmpty(){return Lu(this.inner)}size(){return this.innerSize}},Cf=new Ru(q.comparator);function wf(){return Cf}var Tf=new Ru(q.comparator);function Ef(...e){let t=Tf;for(let n of e)t=t.insert(n.key,n);return t}function Df(e){let t=Tf;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Of(){return Af()}function kf(){return Af()}function Af(){return new Sf((e=>e.toString()),((e,t)=>e.isEqual(t)))}var jf=new Ru(q.comparator),Mf=new Vu(q.comparator);function Z(...e){let t=Mf;for(let n of e)t=t.add(n);return t}var Nf=new Vu(G);function Pf(){return Nf}function Ff(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:`NaN`};if(t===1/0)return{doubleValue:`Infinity`};if(t===-1/0)return{doubleValue:`-Infinity`}}return{doubleValue:ku(t)?`-0`:t}}function If(e){return{integerValue:``+e}}function Lf(e,t){return Au(t)?If(t):Ff(e,t)}var Rf=class{constructor(){this._=void 0}};function zf(e,t,n){return e instanceof Hf?function(e,t){let n={fields:{[Xu]:{stringValue:Yu},[Qu]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&$u(t)&&(t=ed(t)),t&&(n.fields[Zu]=t),{mapValue:n}}(n,t):e instanceof Uf?Wf(e,t):e instanceof Gf?Kf(e,t):function(e,t){let n=Vf(e,t),r=Jf(n)+Jf(e.Ae);return bd(n)&&bd(e.Ae)?If(r):Ff(e.serializer,r)}(e,t)}function Bf(e,t,n){return e instanceof Uf?Wf(e,t):e instanceof Gf?Kf(e,t):n}function Vf(e,t){return e instanceof qf?function(e){return bd(e)||function(e){return!!e&&`doubleValue`in e}(e)}(t)?t:{integerValue:0}:null}var Hf=class extends Rf{},Uf=class extends Rf{constructor(e){super(),this.elements=e}};function Wf(e,t){let n=Yf(t);for(let t of e.elements)n.some((e=>dd(e,t)))||n.push(t);return{arrayValue:{values:n}}}var Gf=class extends Rf{constructor(e){super(),this.elements=e}};function Kf(e,t){let n=Yf(t);for(let t of e.elements)n=n.filter((e=>!dd(e,t)));return{arrayValue:{values:n}}}var qf=class extends Rf{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function Jf(e){return X(e.integerValue||e.doubleValue)}function Yf(e){return xd(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var Xf=class{constructor(e,t){this.field=e,this.transform=t}};function Zf(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Uf&&t instanceof Uf||e instanceof Gf&&t instanceof Gf?Ql(e.elements,t.elements,dd):e instanceof qf&&t instanceof qf?dd(e.Ae,t.Ae):e instanceof Hf&&t instanceof Hf}(e.transform,t.transform)}var Qf=class{constructor(e,t){this.version=e,this.transformResults=t}},$f=class e{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new e}static exists(t){return new e(void 0,t)}static updateTime(t){return new e(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function ep(e,t){return e.updateTime===void 0?e.exists===void 0||e.exists===t.isFoundDocument():t.isFoundDocument()&&t.version.isEqual(e.updateTime)}var tp=class{};function np(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new fp(e.key,$f.none()):new sp(e.key,e.data,$f.none());{let n=e.data,r=Od.empty(),i=new Vu(nu.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);t===null&&e.length>1&&(e=e.popLast(),t=n.field(e)),t===null?r.delete(e):r.set(e,t),i=i.add(e)}return new cp(e.key,r,new Uu(i.toArray()),$f.none())}}function rp(e,t,n){e instanceof sp?function(e,t,n){let r=e.value.clone(),i=up(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof cp?function(e,t,n){if(!ep(e.precondition,t))return void t.convertToUnknownDocument(n.version);let r=up(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(lp(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function ip(e,t,n,r){return e instanceof sp?function(e,t,n,r){if(!ep(e.precondition,t))return n;let i=e.value.clone(),a=dp(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof cp?function(e,t,n,r){if(!ep(e.precondition,t))return n;let i=dp(e.fieldTransforms,r,t),a=t.data;return a.setAll(lp(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),n===null?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return ep(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function ap(e,t){let n=null;for(let r of e.fieldTransforms){let e=t.data.field(r.field),i=Vf(r.transform,e||null);i!=null&&(n===null&&(n=Od.empty()),n.set(r.field,i))}return n||null}function op(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return e===void 0&&t===void 0||!(!e||!t)&&Ql(e,t,((e,t)=>Zf(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}var sp=class extends tp{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},cp=class extends tp{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}};function lp(e){let t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){let r=e.data.field(n);t.set(n,r)}})),t}function up(e,t,n){let r=new Map;V(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let i=0;i<n.length;i++){let a=e[i],o=a.transform,s=t.data.field(a.field);r.set(a.field,Bf(o,s,n[i]))}return r}function dp(e,t,n){let r=new Map;for(let i of e){let e=i.transform,a=n.data.field(i.field);r.set(i.field,zf(e,a,t))}return r}var fp=class extends tp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},pp=class extends tp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}},mp=class{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){let n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){let r=this.mutations[t];r.key.isEqual(e.key)&&rp(r,e,n[t])}}applyToLocalView(e,t){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(t=ip(n,e,t,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(t=ip(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let n=kf();return this.mutations.forEach((r=>{let i=e.get(r.key),a=i.overlayedDocument,o=this.applyToLocalView(a,i.mutatedFields);o=t.has(r.key)?null:o;let s=np(a,o);s!==null&&n.set(r.key,s),a.isValidDocument()||a.convertToNoDocument(J.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Z())}isEqual(e){return this.batchId===e.batchId&&Ql(this.mutations,e.mutations,((e,t)=>op(e,t)))&&Ql(this.baseMutations,e.baseMutations,((e,t)=>op(e,t)))}},hp=class e{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(t,n,r){V(t.mutations.length===r.length,58842,{me:t.mutations.length,fe:r.length});let i=function(){return jf}(),a=t.mutations;for(let e=0;e<a.length;e++)i=i.insert(a[e].key,r[e].version);return new e(t,n,r,i)}},gp=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}},_p=class{constructor(e,t){this.count=e,this.unchangedNames=t}},vp,Q;function yp(e){switch(e){case U.OK:return B(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return B(15467,{code:e})}}function bp(e){if(e===void 0)return Nl(`GRPC error has no .code`),U.UNKNOWN;switch(e){case vp.OK:return U.OK;case vp.CANCELLED:return U.CANCELLED;case vp.UNKNOWN:return U.UNKNOWN;case vp.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case vp.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case vp.INTERNAL:return U.INTERNAL;case vp.UNAVAILABLE:return U.UNAVAILABLE;case vp.UNAUTHENTICATED:return U.UNAUTHENTICATED;case vp.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case vp.NOT_FOUND:return U.NOT_FOUND;case vp.ALREADY_EXISTS:return U.ALREADY_EXISTS;case vp.PERMISSION_DENIED:return U.PERMISSION_DENIED;case vp.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case vp.ABORTED:return U.ABORTED;case vp.OUT_OF_RANGE:return U.OUT_OF_RANGE;case vp.UNIMPLEMENTED:return U.UNIMPLEMENTED;case vp.DATA_LOSS:return U.DATA_LOSS;default:return B(39323,{code:e})}}(Q=vp||={})[Q.OK=0]=`OK`,Q[Q.CANCELLED=1]=`CANCELLED`,Q[Q.UNKNOWN=2]=`UNKNOWN`,Q[Q.INVALID_ARGUMENT=3]=`INVALID_ARGUMENT`,Q[Q.DEADLINE_EXCEEDED=4]=`DEADLINE_EXCEEDED`,Q[Q.NOT_FOUND=5]=`NOT_FOUND`,Q[Q.ALREADY_EXISTS=6]=`ALREADY_EXISTS`,Q[Q.PERMISSION_DENIED=7]=`PERMISSION_DENIED`,Q[Q.UNAUTHENTICATED=16]=`UNAUTHENTICATED`,Q[Q.RESOURCE_EXHAUSTED=8]=`RESOURCE_EXHAUSTED`,Q[Q.FAILED_PRECONDITION=9]=`FAILED_PRECONDITION`,Q[Q.ABORTED=10]=`ABORTED`,Q[Q.OUT_OF_RANGE=11]=`OUT_OF_RANGE`,Q[Q.UNIMPLEMENTED=12]=`UNIMPLEMENTED`,Q[Q.INTERNAL=13]=`INTERNAL`,Q[Q.UNAVAILABLE=14]=`UNAVAILABLE`,Q[Q.DATA_LOSS=15]=`DATA_LOSS`;var xp=null;function Sp(){return new TextEncoder}var Cp=new hl([4294967295,4294967295],0);function wp(e){let t=Sp().encode(e),n=new gl;return n.update(t),new Uint8Array(n.digest())}function Tp(e){let t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new hl([n,r],0),new hl([i,a],0)]}var Ep=class e{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Dp(`Invalid padding: ${t}`);if(n<0||e.length>0&&this.hashCount===0)throw new Dp(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Dp(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=hl.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(hl.fromNumber(n)));return r.compare(Cp)===1&&(r=new hl([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let[t,n]=Tp(wp(e));for(let e=0;e<this.hashCount;e++){let r=this.ye(t,n,e);if(!this.we(r))return!1}return!0}static create(t,n,r){let i=t%8==0?0:8-t%8,a=new e(new Uint8Array(Math.ceil(t/8)),i,n);return r.forEach((e=>a.insert(e))),a}insert(e){if(this.ge===0)return;let[t,n]=Tp(wp(e));for(let e=0;e<this.hashCount;e++){let r=this.ye(t,n,e);this.Se(r)}}Se(e){let t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}},Dp=class extends Error{constructor(){super(...arguments),this.name=`BloomFilterError`}},Op=class e{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,n,r){let i=new Map;return i.set(t,kp.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new e(J.min(),i,new Ru(G),wf(),Z())}},kp=class e{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,n,r){return new e(r,n,Z(),Z(),Z())}},Ap=class{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}},jp=class{constructor(e,t){this.targetId=e,this.Ce=t}},Mp=class{constructor(e,t,n=Gu.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}},Np=class{constructor(){this.ve=0,this.Fe=Ip(),this.Me=Gu.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Z(),t=Z(),n=Z();return this.Fe.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:B(38017,{changeType:i})}})),new kp(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=Ip()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){--this.ve,V(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}},Pp=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=wf(),this.Je=Fp(),this.He=Fp(),this.Ye=new Ru(G)}Ze(e){for(let t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{let n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:B(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((e,n)=>{this.rt(n)&&t(n)}))}st(e){let t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){let i=r.target;if(rf(i))if(n===0){let e=new q(i.path);this.et(t,e,Ad.newNoDocument(e,J.min()))}else V(n===1,20013,{expectedCount:n});else{let r=this._t(t);if(r!==n){let n=this.ut(e),i=n?this.ct(n,e,r):1;if(i!==0){this.it(t);let e=i===2?`TargetPurposeExistenceFilterMismatchBloom`:`TargetPurposeExistenceFilterMismatch`;this.Ye=this.Ye.insert(t,e)}xp?.lt(function(e,t,n,r,i){let a={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},o=t.unchangedNames;return o&&(a.bloomFilter={applied:i===0,hashCount:o?.hashCount??0,bitmapLength:o?.bits?.bitmap?.length??0,padding:o?.bits?.padding??0,mightContain:e=>r?.mightContain(e)??!1}),a}(r,e.Ce,this.Ge.ht(),n,i))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:n=``,padding:r=0},hashCount:i=0}=t,a,o;try{a=Ju(n).toUint8Array()}catch(e){if(e instanceof Wu)return Pl(`Decoding the base64 bloom filter in existence filter failed (`+e.message+`); ignoring the bloom filter and falling back to full re-query.`),null;throw e}try{o=new Ep(a,r,i)}catch(e){return Pl(e instanceof Dp?`BloomFilter error: `:`Applying bloom filter failed: `,e),null}return o.ge===0?null:o}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){let n=this.Ge.getRemoteKeysForTarget(t),r=0;return n.forEach((n=>{let i=this.Ge.ht(),a=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(a)||(this.et(t,n,null),r++)})),r}Tt(e){let t=new Map;this.ze.forEach(((n,r)=>{let i=this.ot(r);if(i){if(n.current&&rf(i.target)){let t=new q(i.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,Ad.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}}));let n=Z();this.He.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{let t=this.ot(e);return!t||t.purpose===`TargetPurposeLimboResolution`||(r=!1,!1)})),r&&(n=n.add(e))})),this.je.forEach(((t,n)=>n.setReadTime(e)));let r=new Op(e,t,this.Ye,this.je,n);return this.je=wf(),this.Je=Fp(),this.He=Fp(),this.Ye=new Ru(G),r}Xe(e,t){if(!this.rt(e))return;let n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;let r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Np,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Vu(G),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Vu(G),this.Je=this.Je.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||z(`WatchChangeAggregator`,`Detected inactive target`,e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Np),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function Fp(){return new Ru(q.comparator)}function Ip(){return new Ru(q.comparator)}var Lp=(()=>({asc:`ASCENDING`,desc:`DESCENDING`}))(),Rp=(()=>({"<":`LESS_THAN`,"<=":`LESS_THAN_OR_EQUAL`,">":`GREATER_THAN`,">=":`GREATER_THAN_OR_EQUAL`,"==":`EQUAL`,"!=":`NOT_EQUAL`,"array-contains":`ARRAY_CONTAINS`,in:`IN`,"not-in":`NOT_IN`,"array-contains-any":`ARRAY_CONTAINS_ANY`}))(),zp=(()=>({and:`AND`,or:`OR`}))(),Bp=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Vp(e,t){return e.useProto3Json||Ou(t)?t:{value:t}}function Hp(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,``).replace(`Z`,``)}.${(`000000000`+t.nanoseconds).slice(-9)}Z`:{seconds:``+t.seconds,nanos:t.nanoseconds}}function Up(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Wp(e,t){return Hp(e,t.toTimestamp())}function Gp(e){return V(!!e,49232),J.fromTimestamp(function(e){let t=qu(e);return new mu(t.seconds,t.nanos)}(e))}function Kp(e,t){return qp(e,t).canonicalString()}function qp(e,t){let n=function(e){return new K([`projects`,e.projectId,`databases`,e.database])}(e).child(`documents`);return t===void 0?n:n.child(t)}function Jp(e){let t=K.fromString(e);return V(_m(t),10190,{key:t.toString()}),t}function Yp(e,t){return Kp(e.databaseId,t.path)}function Xp(e,t){let n=Jp(t);if(n.get(1)!==e.databaseId.projectId)throw new W(U.INVALID_ARGUMENT,`Tried to deserialize key from different project: `+n.get(1)+` vs `+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new W(U.INVALID_ARGUMENT,`Tried to deserialize key from different database: `+n.get(3)+` vs `+e.databaseId.database);return new q(em(n))}function Zp(e,t){return Kp(e.databaseId,t)}function Qp(e){let t=Jp(e);return t.length===4?K.emptyPath():em(t)}function $p(e){return new K([`projects`,e.databaseId.projectId,`databases`,e.databaseId.database]).canonicalString()}function em(e){return V(e.length>4&&e.get(4)===`documents`,29091,{key:e.toString()}),e.popFirst(5)}function tm(e,t,n){return{name:Yp(e,t),fields:n.value.mapValue.fields}}function nm(e,t){let n;if(`targetChange`in t){t.targetChange;let r=function(e){return e===`NO_CHANGE`?0:e===`ADD`?1:e===`REMOVE`?2:e===`CURRENT`?3:e===`RESET`?4:B(39313,{state:e})}(t.targetChange.targetChangeType||`NO_CHANGE`),i=t.targetChange.targetIds||[],a=function(e,t){return e.useProto3Json?(V(t===void 0||typeof t==`string`,58123),Gu.fromBase64String(t||``)):(V(t===void 0||t instanceof Buffer||t instanceof Uint8Array,16193),Gu.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause;n=new Mp(r,i,a,o&&function(e){return new W(e.code===void 0?U.UNKNOWN:bp(e.code),e.message||``)}(o)||null)}else if(`documentChange`in t){t.documentChange;let r=t.documentChange;r.document,r.document.name,r.document.updateTime;let i=Xp(e,r.document.name),a=Gp(r.document.updateTime),o=r.document.createTime?Gp(r.document.createTime):J.min(),s=new Od({mapValue:{fields:r.document.fields}}),c=Ad.newFoundDocument(i,a,o,s);n=new Ap(r.targetIds||[],r.removedTargetIds||[],c.key,c)}else if(`documentDelete`in t){t.documentDelete;let r=t.documentDelete;r.document;let i=Xp(e,r.document),a=r.readTime?Gp(r.readTime):J.min(),o=Ad.newNoDocument(i,a);n=new Ap([],r.removedTargetIds||[],o.key,o)}else if(`documentRemove`in t){t.documentRemove;let r=t.documentRemove;r.document;let i=Xp(e,r.document);n=new Ap([],r.removedTargetIds||[],i,null)}else{if(!(`filter`in t))return B(11601,{Rt:t});{t.filter;let e=t.filter;e.targetId;let{count:r=0,unchangedNames:i}=e,a=new _p(r,i),o=e.targetId;n=new jp(o,a)}}return n}function rm(e,t){let n;if(t instanceof sp)n={update:tm(e,t.key,t.value)};else if(t instanceof fp)n={delete:Yp(e,t.key)};else if(t instanceof cp)n={update:tm(e,t.key,t.data),updateMask:gm(t.fieldMask)};else{if(!(t instanceof pp))return B(16599,{Vt:t.type});n={verify:Yp(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){let n=t.transform;if(n instanceof Hf)return{fieldPath:t.field.canonicalString(),setToServerValue:`REQUEST_TIME`};if(n instanceof Uf)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Gf)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof qf)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw B(20930,{transform:t.transform})}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return t.updateTime===void 0?t.exists===void 0?B(27497):{exists:t.exists}:{updateTime:Wp(e,t.updateTime)}}(e,t.precondition)),n}function im(e,t){return e&&e.length>0?(V(t!==void 0,14353),e.map((e=>function(e,t){let n=e.updateTime?Gp(e.updateTime):Gp(t);return n.isEqual(J.min())&&(n=Gp(t)),new Qf(n,e.transformResults||[])}(e,t)))):[]}function am(e,t){return{documents:[Zp(e,t.path)]}}function om(e,t){let n={structuredQuery:{}},r=t.path,i;t.collectionGroup===null?(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]):(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]),n.parent=Zp(e,i);let a=function(e){if(e.length!==0)return hm(Rd.create(e,`and`))}(t.filters);a&&(n.structuredQuery.where=a);let o=function(e){if(e.length!==0)return e.map((e=>function(e){return{field:pm(e.field),direction:um(e.dir)}}(e)))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);let s=Vp(e,t.limit);return s!==null&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:i}}function sm(e){let t=Qp(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){V(r===1,65062);let e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let a=[];n.where&&(a=function(e){let t=lm(e);return t instanceof Rd&&Bd(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new Pd(mm(e.field),function(e){switch(e){case`ASCENDING`:return`asc`;case`DESCENDING`:return`desc`;default:return}}(e.direction))}(e)))}(n.orderBy));let s=null;n.limit&&(s=function(e){let t;return t=typeof e==`object`?e.value:e,Ou(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){let t=!!e.before;return new jd(e.values||[],t)}(n.startAt));let l=null;return n.endAt&&(l=function(e){let t=!e.before;return new jd(e.values||[],t)}(n.endAt)),of(t,i,o,a,s,`F`,c,l)}function cm(e,t){let n=function(e){switch(e){case`TargetPurposeListen`:return null;case`TargetPurposeExistenceFilterMismatch`:return`existence-filter-mismatch`;case`TargetPurposeExistenceFilterMismatchBloom`:return`existence-filter-mismatch-bloom`;case`TargetPurposeLimboResolution`:return`limbo-document`;default:return B(28987,{purpose:e})}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function lm(e){return e.unaryFilter===void 0?e.fieldFilter===void 0?e.compositeFilter===void 0?B(30097,{filter:e}):function(e){return Rd.create(e.compositeFilter.filters.map((e=>lm(e))),function(e){switch(e){case`AND`:return`and`;case`OR`:return`or`;default:return B(1026)}}(e.compositeFilter.op))}(e):function(e){return Ld.create(mm(e.fieldFilter.field),function(e){switch(e){case`EQUAL`:return`==`;case`NOT_EQUAL`:return`!=`;case`GREATER_THAN`:return`>`;case`GREATER_THAN_OR_EQUAL`:return`>=`;case`LESS_THAN`:return`<`;case`LESS_THAN_OR_EQUAL`:return`<=`;case`ARRAY_CONTAINS`:return`array-contains`;case`IN`:return`in`;case`NOT_IN`:return`not-in`;case`ARRAY_CONTAINS_ANY`:return`array-contains-any`;case`OPERATOR_UNSPECIFIED`:return B(58110);default:return B(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):function(e){switch(e.unaryFilter.op){case`IS_NAN`:let t=mm(e.unaryFilter.field);return Ld.create(t,`==`,{doubleValue:NaN});case`IS_NULL`:let n=mm(e.unaryFilter.field);return Ld.create(n,`==`,{nullValue:`NULL_VALUE`});case`IS_NOT_NAN`:let r=mm(e.unaryFilter.field);return Ld.create(r,`!=`,{doubleValue:NaN});case`IS_NOT_NULL`:let i=mm(e.unaryFilter.field);return Ld.create(i,`!=`,{nullValue:`NULL_VALUE`});case`OPERATOR_UNSPECIFIED`:return B(61313);default:return B(60726)}}(e)}function um(e){return Lp[e]}function dm(e){return Rp[e]}function fm(e){return zp[e]}function pm(e){return{fieldPath:e.canonicalString()}}function mm(e){return nu.fromServerFormat(e.fieldPath)}function hm(e){return e instanceof Ld?function(e){if(e.op===`==`){if(Cd(e.value))return{unaryFilter:{field:pm(e.field),op:`IS_NAN`}};if(Sd(e.value))return{unaryFilter:{field:pm(e.field),op:`IS_NULL`}}}else if(e.op===`!=`){if(Cd(e.value))return{unaryFilter:{field:pm(e.field),op:`IS_NOT_NAN`}};if(Sd(e.value))return{unaryFilter:{field:pm(e.field),op:`IS_NOT_NULL`}}}return{fieldFilter:{field:pm(e.field),op:dm(e.op),value:e.value}}}(e):e instanceof Rd?function(e){let t=e.getFilters().map((e=>hm(e)));return t.length===1?t[0]:{compositeFilter:{op:fm(e.op),filters:t}}}(e):B(54877,{filter:e})}function gm(e){let t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function _m(e){return e.length>=4&&e.get(0)===`projects`&&e.get(2)===`databases`}var vm=class e{constructor(e,t,n,r,i=J.min(),a=J.min(),o=Gu.EMPTY_BYTE_STRING,s=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=s}withSequenceNumber(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}},ym=class{constructor(e){this.yt=e}};function bm(e){let t=sm({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType===`LAST`?mf(t,t.limit,`L`):t}var xm=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if(`nullValue`in e)this.Ft(t,5);else if(`booleanValue`in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if(`integerValue`in e)this.Ft(t,15),t.Mt(X(e.integerValue));else if(`doubleValue`in e){let n=X(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),ku(n)?t.Mt(0):t.Mt(n))}else if(`timestampValue`in e){let n=e.timestampValue;this.Ft(t,20),typeof n==`string`&&(n=qu(n)),t.xt(`${n.seconds||``}`),t.Mt(n.nanos||0)}else if(`stringValue`in e)this.Ot(e.stringValue,t),this.Nt(t);else if(`bytesValue`in e)this.Ft(t,30),t.Bt(Ju(e.bytesValue)),this.Nt(t);else if(`referenceValue`in e)this.Lt(e.referenceValue,t);else if(`geoPointValue`in e){let n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else `mapValue`in e?Dd(e)?this.Ft(t,2**53-1):Td(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):`arrayValue`in e?(this.Qt(e.arrayValue,t),this.Nt(t)):B(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){let n=e.fields||{};this.Ft(t,55);for(let e of Object.keys(n))this.Ot(e,t),this.Ct(n[e],t)}kt(e,t){let n=e.fields||{};this.Ft(t,53);let r=ld,i=n[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(X(i)),this.Ot(r,t),this.Ct(n[r],t)}Qt(e,t){let n=e.values||[];this.Ft(t,50);for(let e of n)this.Ct(e,t)}Lt(e,t){this.Ft(t,37),q.fromName(e).path.forEach((e=>{this.Ft(t,60),this.Ut(e,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};xm.Kt=new xm;var Sm=class{constructor(){this.Cn=new Cm}addToCollectionParentIndex(e,t){return this.Cn.add(t),Y.resolve()}getCollectionParents(e,t){return Y.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Y.resolve()}deleteFieldIndex(e,t){return Y.resolve()}deleteAllFieldIndexes(e){return Y.resolve()}createTargetIndexes(e,t){return Y.resolve()}getDocumentsMatchingTarget(e,t){return Y.resolve(null)}getIndexType(e,t){return Y.resolve(0)}getFieldIndexes(e,t){return Y.resolve([])}getNextCollectionGroupToUpdate(e){return Y.resolve(null)}getMinOffset(e,t){return Y.resolve(yu.min())}getMinOffsetFromCollectionGroup(e,t){return Y.resolve(yu.min())}updateCollectionGroup(e,t,n){return Y.resolve()}updateIndexEntries(e,t){return Y.resolve()}},Cm=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Vu(K.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Vu(K.comparator)).toArray()}};new Uint8Array;var wm={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Tm=41943040,Em=class e{static withCacheSize(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}};Em.DEFAULT_COLLECTION_PERCENTILE=10,Em.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Em.DEFAULT=new Em(Tm,Em.DEFAULT_COLLECTION_PERCENTILE,Em.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Em.DISABLED=new Em(-1,0,0);var Dm=class e{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new e(0)}static cr(){return new e(-1)}},Om=`LruGarbageCollector`,km=1048576;function Am([e,t],[n,r]){let i=G(e,n);return i===0?G(t,r):i}var jm=class{constructor(e){this.Ir=e,this.buffer=new Vu(Am),this.Er=0}dr(){return++this.Er}Ar(e){let t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{let e=this.buffer.last();Am(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}},Mm=class{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&=(this.Rr.cancel(),null)}get started(){return this.Rr!==null}Vr(e){z(Om,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay(`lru_garbage_collection`,e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Tu(e)?z(Om,`Ignoring IndexedDB error during garbage collection: `,e):await Cu(e)}await this.Vr(3e5)}))}},Nm=class{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(t===0)return Y.resolve(Eu.ce);let n=new jm(t);return this.mr.forEachTarget(e,(e=>n.Ar(e.sequenceNumber))).next((()=>this.mr.pr(e,(e=>n.Ar(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(z(`LruGarbageCollector`,`Garbage collection skipped; disabled`),Y.resolve(wm)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(z(`LruGarbageCollector`,`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),wm):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,i,a,o,s,c,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(z(`LruGarbageCollector`,`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,a=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,o=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,s=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(c=Date.now(),Ml()<=R.DEBUG&&z(`LruGarbageCollector`,`LRU Garbage Collection\n\tCounted targets in ${a-l}ms\n\tDetermined least recently used ${r} in `+(o-a)+`ms
\tRemoved ${i} targets in `+(s-o)+`ms
\tRemoved ${e} documents in `+(c-s)+`ms
Total Duration: ${c-l}ms`),Y.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}};function Pm(e,t){return new Nm(e,t)}var Fm=class{constructor(){this.changes=new Sf((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ad.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let n=this.changes.get(t);return n===void 0?this.getFromCache(e,t):Y.resolve(n)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}},Im=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}},Lm=class{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(n!==null&&ip(n.mutation,e,Uu.empty(),mu.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Z()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=Z()){let r=Of();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=Ef();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){let n=Of();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Z())))}populateOverlays(e,t,n){let r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=wf(),a=Af(),o=function(){return Af()}();return t.forEach(((e,t)=>{let o=n.get(t.key);r.has(t.key)&&(o===void 0||o.mutation instanceof cp)?i=i.insert(t.key,t):o===void 0?a.set(t.key,Uu.empty()):(a.set(t.key,o.mutation.getFieldMask()),ip(o.mutation,t,o.mutation.getFieldMask(),mu.now()))})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>a.set(e,t))),t.forEach(((e,t)=>o.set(e,new Im(t,a.get(e)??null)))),o)))}recalculateAndSaveOverlays(e,t){let n=Af(),r=new Ru(((e,t)=>e-t)),i=Z();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(let i of e)i.keys().forEach((e=>{let a=t.get(e);if(a===null)return;let o=n.get(e)||Uu.empty();o=i.applyToLocalView(a,o),n.set(e,o);let s=(r.get(i.batchId)||Z()).add(e);r=r.insert(i.batchId,s)}))})).next((()=>{let a=[],o=r.getReverseIterator();for(;o.hasNext();){let r=o.getNext(),s=r.key,c=r.value,l=kf();c.forEach((e=>{if(!i.has(e)){let r=np(t.get(e),n.get(e));r!==null&&l.set(e,r),i=i.add(e)}})),a.push(this.documentOverlayCache.saveOverlays(e,s,l))}return Y.waitFor(a)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return q.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):lf(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{let a=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Y.resolve(Of()),o=hu,s=i;return a.next((t=>Y.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?Y.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{s=s.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,s,t,Z()))).next((e=>({batchId:o,changes:Df(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new q(t)).next((e=>{let t=Ef();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){let i=t.collectionGroup,a=Ef();return this.indexManager.getCollectionParents(e,i).next((o=>Y.forEach(o,(o=>{let s=function(e,t){return new af(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,s,n,r).next((e=>{e.forEach(((e,t)=>{a=a.insert(e,t)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{let r=n.getKey();e.get(r)===null&&(e=e.insert(r,Ad.newInvalidDocument(r)))}));let n=Ef();return e.forEach(((e,r)=>{let a=i.get(e);a!==void 0&&ip(a.mutation,r,Uu.empty(),mu.now()),vf(t,r)&&(n=n.insert(e,r))})),n}))}},Rm=class{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Y.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Gp(e.createTime)}}(t)),Y.resolve()}getNamedQuery(e,t){return Y.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:bm(e.bundledQuery),readTime:Gp(e.readTime)}}(t)),Y.resolve()}},zm=class{constructor(){this.overlays=new Ru(q.comparator),this.qr=new Map}getOverlay(e,t){return Y.resolve(this.overlays.get(t))}getOverlays(e,t){let n=Of();return Y.forEach(t,(t=>this.getOverlay(e,t).next((e=>{e!==null&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.St(e,t,r)})),Y.resolve()}removeOverlaysForBatchId(e,t,n){let r=this.qr.get(n);return r!==void 0&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.qr.delete(n)),Y.resolve()}getOverlaysForCollection(e,t,n){let r=Of(),i=t.length+1,a=new q(t.child(``)),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){let e=o.getNext().value,a=e.getKey();if(!t.isPrefixOf(a.path))break;a.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Y.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Ru(((e,t)=>e-t)),a=this.overlays.getIterator();for(;a.hasNext();){let e=a.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);t===null&&(t=Of(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}let o=Of(),s=i.getIterator();for(;s.hasNext()&&(s.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return Y.resolve(o)}St(e,t,n){let r=this.overlays.get(n.key);if(r!==null){let e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new gp(t,n));let i=this.qr.get(t);i===void 0&&(i=Z(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}},Bm=class{constructor(){this.sessionToken=Gu.EMPTY_BYTE_STRING}getSessionToken(e){return Y.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Y.resolve()}},Vm=class{constructor(){this.Qr=new Vu(Hm.$r),this.Ur=new Vu(Hm.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){let n=new Hm(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Gr(new Hm(e,t))}zr(e,t){e.forEach((e=>this.removeReference(e,t)))}jr(e){let t=new q(new K([])),n=new Hm(t,e),r=new Hm(t,e+1),i=[];return this.Ur.forEachInRange([n,r],(e=>{this.Gr(e),i.push(e.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){let t=new q(new K([])),n=new Hm(t,e),r=new Hm(t,e+1),i=Z();return this.Ur.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){let t=new Hm(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}},Hm=class{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return q.comparator(e.key,t.key)||G(e.Yr,t.Yr)}static Kr(e,t){return G(e.Yr,t.Yr)||q.comparator(e.key,t.key)}},Um=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Vu(Hm.$r)}checkEmpty(e){return Y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,r){let i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new mp(i,t,n,r);this.mutationQueue.push(a);for(let t of r)this.Zr=this.Zr.add(new Hm(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return Y.resolve(a)}lookupMutationBatch(e,t){return Y.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){let n=t+1,r=this.ei(n),i=r<0?0:r;return Y.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Y.resolve(this.mutationQueue.length===0?Du:this.tr-1)}getAllMutationBatches(e){return Y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let n=new Hm(t,0),r=new Hm(t,1/0),i=[];return this.Zr.forEachInRange([n,r],(e=>{let t=this.Xr(e.Yr);i.push(t)})),Y.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Vu(G);return t.forEach((e=>{let t=new Hm(e,0),r=new Hm(e,1/0);this.Zr.forEachInRange([t,r],(e=>{n=n.add(e.Yr)}))})),Y.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,r=n.length+1,i=n;q.isDocumentKey(i)||(i=i.child(``));let a=new Hm(new q(i),0),o=new Vu(G);return this.Zr.forEachWhile((e=>{let t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Yr)),!0)}),a),Y.resolve(this.ti(o))}ti(e){let t=[];return e.forEach((e=>{let n=this.Xr(e);n!==null&&t.push(n)})),t}removeMutationBatch(e,t){V(this.ni(t.batchId,`removed`)===0,55003),this.mutationQueue.shift();let n=this.Zr;return Y.forEach(t.mutations,(r=>{let i=new Hm(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,t){let n=new Hm(t,0),r=this.Zr.firstAfterOrEqual(n);return Y.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Y.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){let t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}},Wm=class{constructor(e){this.ri=e,this.docs=function(){return new Ru(q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let n=this.docs.get(t);return Y.resolve(n?n.document.mutableCopy():Ad.newInvalidDocument(t))}getEntries(e,t){let n=wf();return t.forEach((e=>{let t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Ad.newInvalidDocument(e))})),Y.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=wf(),a=t.path,o=new q(a.child(`__id-9223372036854775808__`)),s=this.docs.getIteratorFrom(o);for(;s.hasNext();){let{key:e,value:{document:o}}=s.getNext();if(!a.isPrefixOf(e.path))break;e.path.length>a.length+1||bu(vu(o),n)<=0||(r.has(o.key)||vf(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return Y.resolve(i)}getAllFromCollectionGroup(e,t,n,r){B(9500)}ii(e,t){return Y.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new Gm(this)}getSize(e){return Y.resolve(this.size)}},Gm=class extends Fm{constructor(e){super(),this.Nr=e}applyChanges(e){let t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)})),Y.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}},Km=class{constructor(e){this.persistence=e,this.si=new Sf((e=>tf(e)),nf),this.lastRemoteSnapshotVersion=J.min(),this.highestTargetId=0,this.oi=0,this._i=new Vm,this.targetCount=0,this.ai=Dm.ur()}forEachTarget(e,t){return this.si.forEach(((e,n)=>t(n))),Y.resolve()}getLastRemoteSnapshotVersion(e){return Y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Y.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Y.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),Y.resolve()}Pr(e){this.si.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ai=new Dm(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Y.resolve()}updateTargetData(e,t){return this.Pr(t),Y.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),--this.targetCount,Y.resolve()}removeTargets(e,t,n){let r=0,i=[];return this.si.forEach(((a,o)=>{o.sequenceNumber<=t&&n.get(o.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),Y.waitFor(i).next((()=>r))}getTargetCount(e){return Y.resolve(this.targetCount)}getTargetData(e,t){let n=this.si.get(t)||null;return Y.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),Y.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);let r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),Y.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Y.resolve()}getMatchingKeysForTargetId(e,t){let n=this._i.Hr(t);return Y.resolve(n)}containsKey(e,t){return Y.resolve(this._i.containsKey(t))}},qm=class{constructor(e,t){this.ui={},this.overlays={},this.ci=new Eu(0),this.li=!1,this.li=!0,this.hi=new Bm,this.referenceDelegate=e(this),this.Pi=new Km(this),this.indexManager=new Sm,this.remoteDocumentCache=function(e){return new Wm(e)}((e=>this.referenceDelegate.Ti(e))),this.serializer=new ym(t),this.Ii=new Rm(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new zm,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new Um(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){z(`MemoryPersistence`,`Starting transaction:`,e);let r=new Jm(this.ci.next());return this.referenceDelegate.Ei(),n(r).next((e=>this.referenceDelegate.di(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Ai(e,t){return Y.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,t))))}},Jm=class extends Su{constructor(e){super(),this.currentSequenceNumber=e}},Ym=class e{constructor(e){this.persistence=e,this.Ri=new Vm,this.Vi=null}static mi(t){return new e(t)}get fi(){if(this.Vi)return this.Vi;throw B(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),Y.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),Y.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Y.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((e=>this.fi.add(e.toString())));let n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.fi.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Y.forEach(this.fi,(n=>{let r=q.fromPath(n);return this.gi(e,r).next((e=>{e||t.removeEntry(r,J.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Y.or([()=>Y.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}},Xm=class e{constructor(e,t){this.persistence=e,this.pi=new Sf((e=>Mu(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=Pm(this,t)}static mi(t,n){return new e(t,n)}Ei(){}di(e){return Y.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){let t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}wr(e){let t=0;return this.pr(e,(e=>{t++})).next((()=>t))}pr(e,t){return Y.forEach(this.pi,((n,r)=>this.br(e,n,r).next((e=>e?Y.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0,r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,(r=>this.br(e,r,t).next((e=>{e||(n++,i.removeEntry(r,J.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Y.resolve()}removeTarget(e,t){let n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Y.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Y.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Y.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=vd(e.data.value)),t}br(e,t,n){return Y.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let e=this.pi.get(t);return Y.resolve(e!==void 0&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}},Zm=class e{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(t,n){let r=Z(),i=Z();for(let e of n.docChanges)switch(e.type){case 0:r=r.add(e.doc.key);break;case 1:i=i.add(e.doc.key)}return new e(t,n.fromCache,r,i)}},Qm=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}},$m=class{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return rs()?8:wu(Xo())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){let i={result:null};return this.ys(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.ws(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;let n=new Qm;return this.Ss(e,t,n).next((r=>{if(i.result=r,this.Vs)return this.bs(e,t,n,r.size)}))})).next((()=>i.result))}bs(e,t,n,r){return n.documentReadCount<this.fs?(Ml()<=R.DEBUG&&z(`QueryEngine`,`SDK will not create cache indexes for query:`,_f(t),`since it only creates cache indexes for collection contains`,`more than or equal to`,this.fs,`documents`),Y.resolve()):(Ml()<=R.DEBUG&&z(`QueryEngine`,`Query:`,_f(t),`scans`,n.documentReadCount,`local documents and returns`,r,`documents as results.`),n.documentReadCount>this.gs*r?(Ml()<=R.DEBUG&&z(`QueryEngine`,`The SDK decides to create cache indexes for query:`,_f(t),`as using cache indexes may help improve performance.`),this.indexManager.createTargetIndexes(e,df(t))):Y.resolve())}ys(e,t){if(cf(t))return Y.resolve(null);let n=df(t);return this.indexManager.getIndexType(e,n).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=mf(t,null,`F`),n=df(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{let i=Z(...r);return this.ps.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{let a=this.Ds(t,r);return this.Cs(t,a,i,n.readTime)?this.ys(e,mf(t,null,`F`)):this.vs(e,a,t,n)}))))})))))}ws(e,t,n,r){return cf(t)||r.isEqual(J.min())?Y.resolve(null):this.ps.getDocuments(e,n).next((i=>{let a=this.Ds(t,i);return this.Cs(t,a,n,r)?Y.resolve(null):(Ml()<=R.DEBUG&&z(`QueryEngine`,`Re-using previous result from %s to execute query: %s`,r.toString(),_f(t)),this.vs(e,a,t,_u(r,hu)).next((e=>e)))}))}Ds(e,t){let n=new Vu(bf(e));return t.forEach(((t,r)=>{vf(e,r)&&(n=n.add(r))})),n}Cs(e,t,n,r){if(e.limit===null)return!1;if(n.size!==t.size)return!0;let i=e.limitType===`F`?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,n){return Ml()<=R.DEBUG&&z(`QueryEngine`,`Using full collection scan to execute query:`,_f(t)),this.ps.getDocumentsMatchingQuery(e,t,yu.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}},eh=`LocalStore`,th=3e8,nh=class{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new Ru(G),this.xs=new Sf((e=>tf(e)),nf),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Lm(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction(`Collect garbage`,`readwrite-primary`,(t=>e.collect(t,this.Ms)))}};function rh(e,t,n,r){return new nh(e,t,n,r)}async function ih(e,t){let n=H(e);return await n.persistence.runTransaction(`Handle user change`,`readonly`,(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.Bs(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{let i=[],a=[],o=Z();for(let e of r){i.push(e.batchId);for(let t of e.mutations)o=o.add(t.key)}for(let e of t){a.push(e.batchId);for(let t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({Ls:e,removedBatchIds:i,addedBatchIds:a})))}))}))}function ah(e,t){let n=H(e);return n.persistence.runTransaction(`Acknowledge batch`,`readwrite-primary`,(e=>{let r=t.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){let i=n.batch,a=i.keys(),o=Y.resolve();return a.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{let a=n.docVersions.get(e);V(a!==null,48541),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Z();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}function oh(e){let t=H(e);return t.persistence.runTransaction(`Get last remote snapshot version`,`readonly`,(e=>t.Pi.getLastRemoteSnapshotVersion(e)))}function sh(e,t){let n=H(e),r=t.snapshotVersion,i=n.Ms;return n.persistence.runTransaction(`Apply remote event`,`readwrite-primary`,(e=>{let a=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;let o=[];t.targetChanges.forEach(((a,s)=>{let c=i.get(s);if(!c)return;o.push(n.Pi.removeMatchingKeys(e,a.removedDocuments,s).next((()=>n.Pi.addMatchingKeys(e,a.addedDocuments,s))));let l=c.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.get(s)===null?a.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(a.resumeToken,r)):l=l.withResumeToken(Gu.EMPTY_BYTE_STRING,J.min()).withLastLimboFreeSnapshotVersion(J.min()),i=i.insert(s,l),function(e,t,n){return e.resumeToken.approximateByteSize()===0||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=th?!0:n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,l,a)&&o.push(n.Pi.updateTargetData(e,l))}));let s=wf(),c=Z();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(ch(e,a,t.documentUpdates).next((e=>{s=e.ks,c=e.qs}))),!r.isEqual(J.min())){let t=n.Pi.getLastRemoteSnapshotVersion(e).next((t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return Y.waitFor(o).next((()=>a.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,s,c))).next((()=>s))})).then((e=>(n.Ms=i,e)))}function ch(e,t,n){let r=Z(),i=Z();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=wf();return n.forEach(((n,a)=>{let o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(J.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||a.version.compareTo(o.version)===0&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):z(eh,`Ignoring outdated watch update for `,n,`. Current version:`,o.version,` Watch version:`,a.version)})),{ks:r,qs:i}}))}function lh(e,t){let n=H(e);return n.persistence.runTransaction(`Get next mutation batch`,`readonly`,(e=>(t===void 0&&(t=Du),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function uh(e,t){let n=H(e);return n.persistence.runTransaction(`Allocate target`,`readwrite`,(e=>{let r;return n.Pi.getTargetData(e,t).next((i=>i?(r=i,Y.resolve(r)):n.Pi.allocateTargetId(e).next((i=>(r=new vm(t,i,`TargetPurposeListen`,e.currentSequenceNumber),n.Pi.addTargetData(e,r).next((()=>r)))))))})).then((e=>{let r=n.Ms.get(e.targetId);return(r===null||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e}))}async function dh(e,t,n){let r=H(e),i=r.Ms.get(t),a=n?`readwrite`:`readwrite-primary`;try{n||await r.persistence.runTransaction(`Release target`,a,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!Tu(e))throw e;z(eh,`Failed to update sequence numbers for target ${t}: ${e}`)}r.Ms=r.Ms.remove(t),r.xs.delete(i.target)}function fh(e,t,n){let r=H(e),i=J.min(),a=Z();return r.persistence.runTransaction(`Execute query`,`readwrite`,(e=>function(e,t,n){let r=H(e),i=r.xs.get(n);return i===void 0?r.Pi.getTargetData(t,n):Y.resolve(r.Ms.get(i))}(r,e,df(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next((e=>{a=e}))})).next((()=>r.Fs.getDocumentsMatchingQuery(e,t,n?i:J.min(),n?a:Z()))).next((e=>(ph(r,yf(t),e),{documents:e,Qs:a})))))}function ph(e,t,n){let r=e.Os.get(t)||J.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Os.set(t,r)}var mh=class{constructor(){this.activeTargetIds=Pf()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},hh=class{constructor(){this.Mo=new mh,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||`not-current`}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new mh,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}},gh=class{Oo(e){}shutdown(){}},_h=`ConnectivityMonitor`,vh=class{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener(`online`,this.No),window.removeEventListener(`offline`,this.Lo)}Qo(){window.addEventListener(`online`,this.No),window.addEventListener(`offline`,this.Lo)}Bo(){z(_h,`Network connectivity changed: AVAILABLE`);for(let e of this.qo)e(0)}ko(){z(_h,`Network connectivity changed: UNAVAILABLE`);for(let e of this.qo)e(1)}static v(){return typeof window<`u`&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}},yh=null;function bh(){return yh===null?yh=function(){return 268435456+Math.round(2147483648*Math.random())}():yh++,`0x`+yh.toString(16)}var xh=`RestConnection`,Sh={BatchGetDocuments:`batchGet`,Commit:`commit`,RunQuery:`runQuery`,RunAggregationQuery:`runAggregationQuery`},Ch=class{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?`https`:`http`,n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+`://`+e.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===rd?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(e,t,n,r,i){let a=bh(),o=this.zo(e,t.toUriEncodedString());z(xh,`Sending RPC '${e}' ${a}:`,o,n);let s={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(s,r,i);let{host:c}=new URL(o),l=Ho(c);return this.Jo(e,o,s,n,l).then((t=>(z(xh,`Received RPC '${e}' ${a}: `,t),t)),(t=>{throw Pl(xh,`RPC '${e}' ${a} failed with error: `,t,`url: `,o,`request:`,n),t}))}Ho(e,t,n,r,i,a){return this.Go(e,t,n,r,i)}jo(e,t,n){e[`X-Goog-Api-Client`]=function(){return`gl-js/ fire/`+Al}(),e[`Content-Type`]=`text/plain`,this.databaseInfo.appId&&(e[`X-Firebase-GMPID`]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}zo(e,t){let n=Sh[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}},wh=class{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}},Th=`WebChannelConnection`,Eh=class extends Ch{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,i){let a=bh();return new Promise(((i,o)=>{let s=new yl;s.setWithCredentials(!0),s.listenOnce(xl.COMPLETE,(()=>{try{switch(s.getLastErrorCode()){case Sl.NO_ERROR:let t=s.getResponseJson();z(Th,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(t)),i(t);break;case Sl.TIMEOUT:z(Th,`RPC '${e}' ${a} timed out`),o(new W(U.DEADLINE_EXCEEDED,`Request time out`));break;case Sl.HTTP_ERROR:let n=s.getStatus();if(z(Th,`RPC '${e}' ${a} failed with status:`,n,`response text:`,s.getResponseText()),n>0){let e=s.getResponseJson();Array.isArray(e)&&(e=e[0]);let t=e?.error;t&&t.status&&t.message?o(new W(function(e){let t=e.toLowerCase().replace(/_/g,`-`);return Object.values(U).indexOf(t)>=0?t:U.UNKNOWN}(t.status),t.message)):o(new W(U.UNKNOWN,`Server responded with status `+s.getStatus()))}else o(new W(U.UNAVAILABLE,`Connection failed.`));break;default:B(9055,{l_:e,streamId:a,h_:s.getLastErrorCode(),P_:s.getLastError()})}}finally{z(Th,`RPC '${e}' ${a} completed.`)}}));let c=JSON.stringify(r);z(Th,`RPC '${e}' ${a} sending request:`,r),s.send(t,`POST`,c,n,15)}))}T_(e,t,n){let r=bh(),i=[this.Uo,`/`,`google.firestore.v1.Firestore`,`/`,e,`/channel`],a=El(),o=Tl(),s={httpSessionIdParam:`gsessionid`,initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(s.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(s.useFetchStreams=!0),this.jo(s.initMessageHeaders,t,n),s.encodeInitMessageHeaders=!0;let l=i.join(``);z(Th,`Creating RPC '${e}' stream ${r}: ${l}`,s);let u=a.createWebChannel(l,s);this.I_(u);let d=!1,f=!1,p=new wh({Yo:t=>{f?z(Th,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||=(z(Th,`Opening RPC '${e}' stream ${r} transport.`),u.open(),!0),z(Th,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},Zo:()=>u.close()}),m=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return m(u,bl.EventType.OPEN,(()=>{f||(z(Th,`RPC '${e}' stream ${r} transport opened.`),p.o_())})),m(u,bl.EventType.CLOSE,(()=>{f||(f=!0,z(Th,`RPC '${e}' stream ${r} transport closed`),p.a_(),this.E_(u))})),m(u,bl.EventType.ERROR,(t=>{f||(f=!0,Pl(Th,`RPC '${e}' stream ${r} transport errored. Name:`,t.name,`Message:`,t.message),p.a_(new W(U.UNAVAILABLE,`The operation could not be completed`)))})),m(u,bl.EventType.MESSAGE,(t=>{if(!f){let n=t.data[0];V(!!n,16349);let i=n,a=i?.error||i[0]?.error;if(a){z(Th,`RPC '${e}' stream ${r} received error:`,a);let t=a.status,n=function(e){let t=vp[e];if(t!==void 0)return bp(t)}(t),i=a.message;n===void 0&&(n=U.INTERNAL,i=`Unknown error status: `+t+` with message `+a.message),f=!0,p.a_(new W(n,i)),u.close()}else z(Th,`RPC '${e}' stream ${r} received:`,n),p.u_(n)}})),m(o,wl.STAT_EVENT,(t=>{t.stat===Cl.PROXY?z(Th,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===Cl.NOPROXY&&z(Th,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{p.__()}),0),p}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}};function Dh(){return typeof document<`u`?document:null}function Oh(e){return new Bp(e,!0)}var kh=class{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();let t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&z(`ExponentialBackoff`,`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}},Ah=`PersistentStream`,jh=class{constructor(e,t,n,r,i,a,o,s){this.Mi=e,this.S_=n,this.b_=r,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=s,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new kh(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state===4?this.N_():this.auth()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&=(this.C_.cancel(),null)}U_(){this.v_&&=(this.v_.cancel(),null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e===4?t&&t.code===U.RESOURCE_EXHAUSTED?(Nl(t.toString()),Nl(`Using maximum backoff delay to prevent overloading the backend.`),this.M_.g_()):t&&t.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()):this.M_.reset(),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;let e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.D_===t&&this.G_(e,n)}),(t=>{e((()=>{let e=new W(U.UNKNOWN,`Fetching auth token failed: `+t.message);return this.z_(e)}))}))}G_(e,t){let n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((e=>{n((()=>this.z_(e)))})),this.stream.onMessage((e=>{n((()=>++this.F_==1?this.J_(e):this.onNext(e)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return z(Ah,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(z(Ah,`stream callback skipped by getCloseGuardedDispatcher.`),Promise.resolve())))}}},Mh=class extends jh{constructor(e,t,n,r,i,a){super(e,`listen_stream_connection_backoff`,`listen_stream_idle`,`health_check_timeout`,t,n,r,a),this.serializer=i}j_(e,t){return this.connection.T_(`Listen`,e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=nm(this.serializer,e),n=function(e){if(!(`targetChange`in e))return J.min();let t=e.targetChange;return t.targetIds&&t.targetIds.length?J.min():t.readTime?Gp(t.readTime):J.min()}(e);return this.listener.H_(t,n)}Y_(e){let t={};t.database=$p(this.serializer),t.addTarget=function(e,t){let n,r=t.target;if(n=rf(r)?{documents:am(e,r)}:{query:om(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Up(e,t.resumeToken);let r=Vp(e,t.expectedCount);r!==null&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(J.min())>0){n.readTime=Hp(e,t.snapshotVersion.toTimestamp());let r=Vp(e,t.expectedCount);r!==null&&(n.expectedCount=r)}return n}(this.serializer,e);let n=cm(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){let t={};t.database=$p(this.serializer),t.removeTarget=e,this.q_(t)}},Nh=class extends jh{constructor(e,t,n,r,i,a){super(e,`write_stream_connection_backoff`,`write_stream_idle`,`health_check_timeout`,t,n,r,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_(`Write`,e,t)}J_(e){return V(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,V(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){V(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=im(e.writeResults,e.commitTime),n=Gp(e.commitTime);return this.listener.na(n,t)}ra(){let e={};e.database=$p(this.serializer),this.q_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map((e=>rm(this.serializer,e)))};this.q_(t)}},Ph=class{},Fh=class extends Ph{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new W(U.FAILED_PRECONDITION,`The client has already been terminated.`)}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,qp(t,n),r,i,a))).catch((e=>{throw e.name===`FirebaseError`?(e.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new W(U.UNKNOWN,e.toString())}))}Ho(e,t,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Ho(e,qp(t,n),r,a,o,i))).catch((e=>{throw e.name===`FirebaseError`?(e.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new W(U.UNKNOWN,e.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}},Ih=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state=`Unknown`,this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca(`Unknown`),this._a=this.asyncQueue.enqueueAfterDelay(`online_state_timeout`,1e4,(()=>(this._a=null,this.la(`Backend didn't respond within 10 seconds.`),this.ca(`Offline`),Promise.resolve()))))}ha(e){this.state===`Online`?this.ca(`Unknown`):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca(`Offline`)))}set(e){this.Pa(),this.oa=0,e===`Online`&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Nl(t),this.aa=!1):z(`OnlineStateTracker`,t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}},Lh=`RemoteStore`,Rh=class{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((e=>{n.enqueueAndForget((async()=>{qh(this)&&(z(Lh,`Restarting streams for network reachability change.`),await async function(e){let t=H(e);t.Ea.add(4),await Bh(t),t.Ra.set(`Unknown`),t.Ea.delete(4),await zh(t)}(this))}))})),this.Ra=new Ih(n,r)}};async function zh(e){if(qh(e))for(let t of e.da)await t(!0)}async function Bh(e){for(let t of e.da)await t(!1)}function Vh(e,t){let n=H(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),Kh(n)?Gh(n):fg(n).O_()&&Uh(n,t))}function Hh(e,t){let n=H(e),r=fg(n);n.Ia.delete(t),r.O_()&&Wh(n,t),n.Ia.size===0&&(r.O_()?r.L_():qh(n)&&n.Ra.set(`Unknown`))}function Uh(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(J.min())>0){let n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}fg(e).Y_(t)}function Wh(e,t){e.Va.Ue(t),fg(e).Z_(t)}function Gh(e){e.Va=new Pp({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),fg(e).start(),e.Ra.ua()}function Kh(e){return qh(e)&&!fg(e).x_()&&e.Ia.size>0}function qh(e){return H(e).Ea.size===0}function Jh(e){e.Va=void 0}async function Yh(e){e.Ra.set(`Online`)}async function Xh(e){e.Ia.forEach(((t,n)=>{Uh(e,t)}))}async function Zh(e,t){Jh(e),Kh(e)?(e.Ra.ha(t),Gh(e)):e.Ra.set(`Unknown`)}async function Qh(e,t,n){if(e.Ra.set(`Online`),t instanceof Mp&&t.state===2&&t.cause)try{await async function(e,t){let n=t.cause;for(let r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(n){z(Lh,`Failed to remove targets %s: %s `,t.targetIds.join(`,`),n),await $h(e,n)}else if(t instanceof Ap?e.Va.Ze(t):t instanceof jp?e.Va.st(t):e.Va.tt(t),!n.isEqual(J.min()))try{let t=await oh(e.localStore);n.compareTo(t)>=0&&await function(e,t){let n=e.Va.Tt(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){let i=e.Ia.get(r);i&&e.Ia.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{let r=e.Ia.get(t);r&&(e.Ia.set(t,r.withResumeToken(Gu.EMPTY_BYTE_STRING,r.snapshotVersion)),Wh(e,t),Uh(e,new vm(r.target,t,n,r.sequenceNumber)))})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){z(Lh,`Failed to raise snapshot:`,t),await $h(e,t)}}async function $h(e,t,n){if(!Tu(t))throw t;e.Ea.add(1),await Bh(e),e.Ra.set(`Offline`),n||=()=>oh(e.localStore),e.asyncQueue.enqueueRetryable((async()=>{z(Lh,`Retrying IndexedDB access`),await n(),e.Ea.delete(1),await zh(e)}))}function eg(e,t){return t().catch((n=>$h(e,n,t)))}async function tg(e){let t=H(e),n=pg(t),r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Du;for(;ng(t);)try{let e=await lh(t.localStore,r);if(e===null){t.Ta.length===0&&n.L_();break}r=e.batchId,rg(t,e)}catch(e){await $h(t,e)}ig(t)&&ag(t)}function ng(e){return qh(e)&&e.Ta.length<10}function rg(e,t){e.Ta.push(t);let n=pg(e);n.O_()&&n.X_&&n.ea(t.mutations)}function ig(e){return qh(e)&&!pg(e).x_()&&e.Ta.length>0}function ag(e){pg(e).start()}async function og(e){pg(e).ra()}async function sg(e){let t=pg(e);for(let n of e.Ta)t.ea(n.mutations)}async function cg(e,t,n){let r=e.Ta.shift(),i=hp.from(r,t,n);await eg(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await tg(e)}async function lg(e,t){t&&pg(e).X_&&await async function(e,t){if(function(e){return yp(e)&&e!==U.ABORTED}(t.code)){let n=e.Ta.shift();pg(e).B_(),await eg(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await tg(e)}}(e,t),ig(e)&&ag(e)}async function ug(e,t){let n=H(e);n.asyncQueue.verifyOperationInProgress(),z(Lh,`RemoteStore received new credentials`);let r=qh(n);n.Ea.add(3),await Bh(n),r&&n.Ra.set(`Unknown`),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await zh(n)}async function dg(e,t){let n=H(e);t?(n.Ea.delete(2),await zh(n)):t||(n.Ea.add(2),await Bh(n),n.Ra.set(`Unknown`))}function fg(e){return e.ma||(e.ma=function(e,t,n){let r=H(e);return r.sa(),new Mh(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:Yh.bind(null,e),t_:Xh.bind(null,e),r_:Zh.bind(null,e),H_:Qh.bind(null,e)}),e.da.push((async t=>{t?(e.ma.B_(),Kh(e)?Gh(e):e.Ra.set(`Unknown`)):(await e.ma.stop(),Jh(e))}))),e.ma}function pg(e){return e.fa||(e.fa=function(e,t,n){let r=H(e);return r.sa(),new Nh(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:og.bind(null,e),r_:lg.bind(null,e),ta:sg.bind(null,e),na:cg.bind(null,e)}),e.da.push((async t=>{t?(e.fa.B_(),await tg(e)):(await e.fa.stop(),e.Ta.length>0&&(z(Lh,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))}))),e.fa}var mg=class e{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Ll,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,n,r,i,a){let o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new W(U.CANCELLED,`Operation cancelled`+(e?`: `+e:``))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle===null?Promise.resolve():(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e))))))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function hg(e,t){if(Nl(`AsyncQueue`,`${t}: ${e}`),Tu(e))return new W(U.UNAVAILABLE,`${t}: ${e}`);throw e}var gg=class e{static emptySet(t){return new e(t.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||q.comparator(t.key,n.key):(e,t)=>q.comparator(e.key,t.key),this.keyedMap=Ef(),this.sortedSet=new Ru(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(t){if(!(t instanceof e)||this.size!==t.size)return!1;let n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;n.hasNext();){let e=n.getNext().key,t=r.getNext().key;if(!e.isEqual(t))return!1}return!0}toString(){let e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?`DocumentSet ()`:`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(t,n){let r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}},_g=class{constructor(){this.ga=new Ru(q.comparator)}track(e){let t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):B(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}},vg=class e{constructor(e,t,n,r,i,a,o,s,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=s,this.hasCachedResults=c}static fromInitialDocuments(t,n,r,i,a){let o=[];return n.forEach((e=>{o.push({type:0,doc:e})})),new e(t,n,gg.emptySet(n),o,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}},yg=class{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}},bg=class{constructor(){this.queries=xg(),this.onlineState=`Unknown`,this.Ca=new Set}terminate(){(function(e,t){let n=H(e),r=n.queries;n.queries=xg(),r.forEach(((e,n)=>{for(let e of n.Sa)e.onError(t)}))})(this,new W(U.ABORTED,`Firestore shutting down`))}};function xg(){return new Sf((e=>gf(e)),hf)}async function Sg(e,t){let n=H(e),r=3,i=t.query,a=n.queries.get(i);a?!a.ba()&&t.Da()&&(r=2):(a=new yg,r=t.Da()?0:1);try{switch(r){case 0:a.wa=await n.onListen(i,!0);break;case 1:a.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){let n=hg(e,`Initialization of query '${_f(t.query)}' failed`);t.onError(n);return}n.queries.set(i,a),a.Sa.push(t),t.va(n.onlineState),a.wa&&t.Fa(a.wa)&&Eg(n)}async function Cg(e,t){let n=H(e),r=t.query,i=3,a=n.queries.get(r);if(a){let e=a.Sa.indexOf(t);e>=0&&(a.Sa.splice(e,1),a.Sa.length===0?i=t.Da()?0:1:!a.ba()&&t.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function wg(e,t){let n=H(e),r=!1;for(let e of t){let t=e.query,i=n.queries.get(t);if(i){for(let t of i.Sa)t.Fa(e)&&(r=!0);i.wa=e}}r&&Eg(n)}function Tg(e,t,n){let r=H(e),i=r.queries.get(t);if(i)for(let e of i.Sa)e.onError(n);r.queries.delete(t)}function Eg(e){e.Ca.forEach((e=>{e.next()}))}var Dg,Og;(Og=Dg||={}).Ma=`default`,Og.Cache=`cache`;var kg=class{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState=`Unknown`,this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){let t=[];for(let n of e.docChanges)n.type!==3&&t.push(n);e=new vg(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let n=t!==`Offline`;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t===`Offline`)}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=vg.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Dg.Cache}},Ag=class{constructor(e){this.key=e}},jg=class{constructor(e){this.key=e}},Mg=class{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Z(),this.mutatedKeys=Z(),this.eu=bf(e),this.tu=new gg(this.eu)}get nu(){return this.Ya}ru(e,t){let n=t?t.iu:new _g,r=t?t.tu:this.tu,i=t?t.mutatedKeys:this.mutatedKeys,a=r,o=!1,s=this.query.limitType===`F`&&r.size===this.query.limit?r.last():null,c=this.query.limitType===`L`&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{let l=r.get(e),u=vf(this.query,t)?t:null,d=!!l&&this.mutatedKeys.has(l.key),f=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations),p=!1;l&&u?l.data.isEqual(u.data)?d!==f&&(n.track({type:3,doc:u}),p=!0):this.su(l,u)||(n.track({type:2,doc:u}),p=!0,(s&&this.eu(u,s)>0||c&&this.eu(u,c)<0)&&(o=!0)):!l&&u?(n.track({type:0,doc:u}),p=!0):l&&!u&&(n.track({type:1,doc:l}),p=!0,(s||c)&&(o=!0)),p&&(u?(a=a.add(u),i=f?i.add(e):i.delete(e)):(a=a.delete(e),i=i.delete(e)))})),this.query.limit!==null)for(;a.size>this.query.limit;){let e=this.query.limitType===`F`?a.last():a.first();a=a.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{tu:a,iu:n,Cs:o,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){let i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let a=e.iu.ya();a.sort(((e,t)=>function(e,t){let n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return B(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc))),this.ou(n),r??=!1;let o=t&&!r?this._u():[],s=this.Xa.size===0&&this.current&&!r?1:0,c=s!==this.Za;return this.Za=s,a.length!==0||c?{snapshot:new vg(this.query,e.tu,i,a,e.mutatedKeys,s===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e===`Offline`?(this.current=!1,this.applyChanges({tu:this.tu,iu:new _g,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((e=>this.Ya=this.Ya.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Ya=this.Ya.delete(e))),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Xa;this.Xa=Z(),this.tu.forEach((e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))}));let t=[];return e.forEach((e=>{this.Xa.has(e)||t.push(new jg(e))})),this.Xa.forEach((n=>{e.has(n)||t.push(new Ag(n))})),t}cu(e){this.Ya=e.Qs,this.Xa=Z();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return vg.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}},Ng=`SyncEngine`,Pg=class{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}},Fg=class{constructor(e){this.key=e,this.hu=!1}},Ig=class{constructor(e,t,n,r,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Sf((e=>gf(e)),hf),this.Iu=new Map,this.Eu=new Set,this.du=new Ru(q.comparator),this.Au=new Map,this.Ru=new Vm,this.Vu={},this.mu=new Map,this.fu=Dm.cr(),this.onlineState=`Unknown`,this.gu=void 0}get isPrimaryClient(){return!0===this.gu}};async function Lg(e,t,n=!0){let r=a_(e),i,a=r.Tu.get(t);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await zg(r,t,n,!0),i}async function Rg(e,t){await zg(a_(e),t,!0,!1)}async function zg(e,t,n,r){let i=await uh(e.localStore,df(t)),a=i.targetId,o=e.sharedClientState.addLocalQueryTarget(a,n),s;return r&&(s=await Bg(e,t,a,o===`current`,i.resumeToken)),e.isPrimaryClient&&n&&Vh(e.remoteStore,i),s}async function Bg(e,t,n,r,i){e.pu=(t,n,r)=>async function(e,t,n,r){let i=t.view.ru(n);i.Cs&&(i=await fh(e.localStore,t.query,!1).then((({documents:e})=>t.view.ru(e,i))));let a=r&&r.targetChanges.get(t.targetId),o=r&&r.targetMismatches.get(t.targetId)!=null,s=t.view.applyChanges(i,e.isPrimaryClient,a,o);return $g(e,t.targetId,s.au),s.snapshot}(e,t,n,r);let a=await fh(e.localStore,t,!0),o=new Mg(t,a.Qs),s=o.ru(a.documents),c=kp.createSynthesizedTargetChangeForCurrentChange(n,r&&e.onlineState!==`Offline`,i),l=o.applyChanges(s,e.isPrimaryClient,c);$g(e,n,l.au);let u=new Pg(t,n,o);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),l.snapshot}async function Vg(e,t,n){let r=H(e),i=r.Tu.get(t),a=r.Iu.get(i.targetId);if(a.length>1)return r.Iu.set(i.targetId,a.filter((e=>!hf(e,t)))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await dh(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Hh(r.remoteStore,i.targetId),Zg(r,i.targetId)})).catch(Cu)):(Zg(r,i.targetId),await dh(r.localStore,i.targetId,!0))}async function Hg(e,t){let n=H(e),r=n.Tu.get(t),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Hh(n.remoteStore,r.targetId))}async function Ug(e,t,n){let r=o_(e);try{let e=await function(e,t){let n=H(e),r=mu.now(),i=t.reduce(((e,t)=>e.add(t.key)),Z()),a,o;return n.persistence.runTransaction(`Locally write mutations`,`readwrite`,(e=>{let s=wf(),c=Z();return n.Ns.getEntries(e,i).next((e=>{s=e,s.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,s))).next((i=>{a=i;let o=[];for(let e of t){let t=ap(e,a.get(e.key).overlayedDocument);t!=null&&o.push(new cp(e.key,t,kd(t.value.mapValue),$f.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;let r=t.applyToLocalDocumentSet(a,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:Df(a)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||=new Ru(G),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await n_(r,e.changes),await tg(r.remoteStore)}catch(e){let t=hg(e,`Failed to persist write`);n.reject(t)}}async function Wg(e,t){let n=H(e);try{let e=await sh(n.localStore,t);t.targetChanges.forEach(((e,t)=>{let r=n.Au.get(t);r&&(V(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?V(r.hu,14607):e.removedDocuments.size>0&&(V(r.hu,42227),r.hu=!1))})),await n_(n,e,t)}catch(e){await Cu(e)}}function Gg(e,t,n){let r=H(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let e=[];r.Tu.forEach(((n,r)=>{let i=r.view.va(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){let n=H(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(let e of n.Sa)e.va(t)&&(r=!0)})),r&&Eg(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Kg(e,t,n){let r=H(e);r.sharedClientState.updateQueryState(t,`rejected`,n);let i=r.Au.get(t),a=i&&i.key;if(a){let e=new Ru(q.comparator);e=e.insert(a,Ad.newNoDocument(a,J.min()));let n=Z().add(a);await Wg(r,new Op(J.min(),new Map,new Ru(G),e,n)),r.du=r.du.remove(a),r.Au.delete(t),t_(r)}else await dh(r.localStore,t,!1).then((()=>Zg(r,t,n))).catch(Cu)}async function qg(e,t){let n=H(e),r=t.batch.batchId;try{let e=await ah(n.localStore,t);Xg(n,r,null),Yg(n,r),n.sharedClientState.updateMutationState(r,`acknowledged`),await n_(n,e)}catch(e){await Cu(e)}}async function Jg(e,t,n){let r=H(e);try{let e=await function(e,t){let n=H(e);return n.persistence.runTransaction(`Reject batch`,`readwrite-primary`,(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(V(t!==null,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);Xg(r,t,n),Yg(r,t),r.sharedClientState.updateMutationState(t,`rejected`,n),await n_(r,e)}catch(e){await Cu(e)}}function Yg(e,t){(e.mu.get(t)||[]).forEach((e=>{e.resolve()})),e.mu.delete(t)}function Xg(e,t,n){let r=H(e),i=r.Vu[r.currentUser.toKey()];if(i){let e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Vu[r.currentUser.toKey()]=i}}function Zg(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(let r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach((t=>{e.Ru.containsKey(t)||Qg(e,t)}))}function Qg(e,t){e.Eu.delete(t.path.canonicalString());let n=e.du.get(t);n!==null&&(Hh(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),t_(e))}function $g(e,t,n){for(let r of n)r instanceof Ag?(e.Ru.addReference(r.key,t),e_(e,r)):r instanceof jg?(z(Ng,`Document no longer in limbo: `+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||Qg(e,r.key)):B(19791,{wu:r})}function e_(e,t){let n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(z(Ng,`New document in limbo: `+n),e.Eu.add(r),t_(e))}function t_(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){let t=e.Eu.values().next().value;e.Eu.delete(t);let n=new q(K.fromString(t)),r=e.fu.next();e.Au.set(r,new Fg(n)),e.du=e.du.insert(n,r),Vh(e.remoteStore,new vm(df(sf(n.path)),r,`TargetPurposeLimboResolution`,Eu.ce))}}async function n_(e,t,n){let r=H(e),i=[],a=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((e,s)=>{o.push(r.pu(s,t,n).then((e=>{if((e||n)&&r.isPrimaryClient){let t=e?!e.fromCache:n?.targetChanges.get(s.targetId)?.current;r.sharedClientState.updateQueryState(s.targetId,t?`current`:`not-current`)}if(e){i.push(e);let t=Zm.As(s.targetId,e);a.push(t)}})))})),await Promise.all(o),r.Pu.H_(i),await async function(e,t){let n=H(e);try{await n.persistence.runTransaction(`notifyLocalViewChanges`,`readwrite`,(e=>Y.forEach(t,(t=>Y.forEach(t.Es,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>Y.forEach(t.ds,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!Tu(e))throw e;z(eh,`Failed to update sequence numbers: `+e)}for(let e of t){let t=e.targetId;if(!e.fromCache){let e=n.Ms.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(t,i)}}}(r.localStore,a))}async function r_(e,t){let n=H(e);if(!n.currentUser.isEqual(t)){z(Ng,`User change. New user:`,t.toKey());let e=await ih(n.localStore,t);n.currentUser=t,function(e,t){e.mu.forEach((e=>{e.forEach((e=>{e.reject(new W(U.CANCELLED,t))}))})),e.mu.clear()}(n,`'waitForPendingWrites' promise is rejected due to a user change.`),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await n_(n,e.Ls)}}function i_(e,t){let n=H(e),r=n.Au.get(t);if(r&&r.hu)return Z().add(r.key);{let e=Z(),r=n.Iu.get(t);if(!r)return e;for(let t of r){let r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function a_(e){let t=H(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Wg.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=i_.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Kg.bind(null,t),t.Pu.H_=wg.bind(null,t.eventManager),t.Pu.yu=Tg.bind(null,t.eventManager),t}function o_(e){let t=H(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=qg.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Jg.bind(null,t),t}var s_=class{constructor(){this.kind=`memory`,this.synchronizeTabs=!1}async initialize(e){this.serializer=Oh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return rh(this.persistence,new $m,e.initialUser,this.serializer)}Cu(e){return new qm(Ym.mi,this.serializer)}Du(e){return new hh}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}};s_.provider={build:()=>new s_};var c_=class extends s_{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){V(this.persistence.referenceDelegate instanceof Xm,46915);let n=this.persistence.referenceDelegate.garbageCollector;return new Mm(n,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes===void 0?Em.DEFAULT:Em.withCacheSize(this.cacheSizeBytes);return new qm((e=>Xm.mi(e,t)),this.serializer)}},l_=class{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Gg(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=r_.bind(null,this.syncEngine),await dg(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new bg}()}createDatastore(e){let t=Oh(e.databaseInfo.databaseId),n=function(e){return new Eh(e)}(e.databaseInfo);return function(e,t,n,r){return new Fh(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new Rh(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>Gg(this.syncEngine,e,0)),function(){return vh.v()?new vh:new gh}())}createSyncEngine(e,t){return function(e,t,n,r,i,a,o){let s=new Ig(e,t,n,r,i,a);return o&&(s.gu=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await async function(e){let t=H(e);z(Lh,`RemoteStore shutting down.`),t.Ea.add(5),await Bh(t),t.Aa.shutdown(),t.Ra.set(`Unknown`)}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}};l_.provider={build:()=>new l_};var u_=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Nl(`Uncaught Error in snapshot listener:`,e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}},d_=`FirestoreClient`,f_=class{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=kl.UNAUTHENTICATED,this.clientId=ql.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async e=>{z(d_,`Received user=`,e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(z(d_,`Received new app check token=`,e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Ll;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let n=hg(t,`Failed to shutdown persistence`);e.reject(n)}})),e.promise}};async function p_(e,t){e.asyncQueue.verifyOperationInProgress(),z(d_,`Initializing OfflineComponentProvider`);let n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await ih(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function m_(e,t){e.asyncQueue.verifyOperationInProgress();let n=await h_(e);z(d_,`Initializing OnlineComponentProvider`),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>ug(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>ug(t.remoteStore,n))),e._onlineComponents=t}async function h_(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){z(d_,`Using user provided OfflineComponentProvider`);try{await p_(e,e._uninitializedComponentsProvider._offline)}catch(t){let n=t;if(!function(e){return e.name===`FirebaseError`?e.code===U.FAILED_PRECONDITION||e.code===U.UNIMPLEMENTED:!(typeof DOMException<`u`&&e instanceof DOMException)||e.code===22||e.code===20||e.code===11}(n))throw n;Pl(`Error using user provided cache. Falling back to memory cache: `+n),await p_(e,new s_)}}else z(d_,`Using default OfflineComponentProvider`),await p_(e,new c_(void 0));return e._offlineComponents}async function g_(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(z(d_,`Using user provided OnlineComponentProvider`),await m_(e,e._uninitializedComponentsProvider._online)):(z(d_,`Using default OnlineComponentProvider`),await m_(e,new l_))),e._onlineComponents}function __(e){return g_(e).then((e=>e.syncEngine))}async function v_(e){let t=await g_(e),n=t.eventManager;return n.onListen=Lg.bind(null,t.syncEngine),n.onUnlisten=Vg.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Rg.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Hg.bind(null,t.syncEngine),n}function y_(e,t,n={}){let r=new Ll;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){let a=new u_({next:s=>{a.Nu(),t.enqueueAndForget((()=>Cg(e,o)));let c=s.docs.has(n);!c&&s.fromCache?i.reject(new W(U.UNAVAILABLE,`Failed to get document because the client is offline.`)):c&&s.fromCache&&r&&r.source===`server`?i.reject(new W(U.UNAVAILABLE,`Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)`)):i.resolve(s)},error:e=>i.reject(e)}),o=new kg(sf(n.path),a,{includeMetadataChanges:!0,qa:!0});return Sg(e,o)}(await v_(e),e.asyncQueue,t,n,r))),r.promise}function b_(e,t,n={}){let r=new Ll;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){let a=new u_({next:n=>{a.Nu(),t.enqueueAndForget((()=>Cg(e,o))),n.fromCache&&r.source===`server`?i.reject(new W(U.UNAVAILABLE,`Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)`)):i.resolve(n)},error:e=>i.reject(e)}),o=new kg(n,a,{includeMetadataChanges:!0,qa:!0});return Sg(e,o)}(await v_(e),e.asyncQueue,t,n,r))),r.promise}function x_(e){let t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}var S_=new Map,C_=`firestore.googleapis.com`,w_=!0,T_=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new W(U.INVALID_ARGUMENT,`Can't provide ssl option if host option is not set`);this.host=C_,this.ssl=w_}else this.host=e.host,this.ssl=e.ssl??w_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Tm;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<km)throw new W(U.INVALID_ARGUMENT,`cacheSizeBytes must be at least 1048576`);this.cacheSizeBytes=e.cacheSizeBytes}iu(`experimentalForceLongPolling`,e.experimentalForceLongPolling,`experimentalAutoDetectLongPolling`,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=x_(e.experimentalLongPollingOptions??{}),function(e){if(e.timeoutSeconds!==void 0){if(isNaN(e.timeoutSeconds))throw new W(U.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new W(U.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new W(U.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},E_=class{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type=`firestore-lite`,this._persistenceKey=`(lite)`,this._settings=new T_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask=`notTerminated`}get app(){if(!this._app)throw new W(U.FAILED_PRECONDITION,`Firestore was not initialized using the Firebase SDK. 'app' is not available`);return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==`notTerminated`}_setSettings(e){if(this._settingsFrozen)throw new W(U.FAILED_PRECONDITION,`Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.`);this._settings=new T_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(e){if(!e)return new zl;switch(e.type){case`firstParty`:return new Ul(e.sessionIndex||`0`,e.iamToken||null,e.authTokenFactory||null);case`provider`:return e.client;default:throw new W(U.INVALID_ARGUMENT,`makeAuthCredentialsProvider failed due to invalid credential type`)}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask===`notTerminated`&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask===`notTerminated`?await this._terminate():this._terminateTask=`notTerminated`}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){let t=S_.get(e);t&&(z(`ComponentProvider`,`Removing Datastore`),S_.delete(e),t.terminate())}(this),Promise.resolve()}};function D_(e,t,n,r={}){e=lu(e,E_);let i=Ho(t),a=e._getSettings(),o={...a,emulatorOptions:e._getEmulatorOptions()},s=`${t}:${n}`;i&&(Uo(`https://${s}`),Yo(`Firestore`,!0)),a.host!==C_&&a.host!==s&&Pl(`Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.`);let c={...a,host:s,ssl:i,emulatorOptions:r};if(!fs(c,o)&&(e._setSettings(c),r.mockUserToken)){let t,n;if(typeof r.mockUserToken==`string`)t=r.mockUserToken,n=kl.MOCK_USER;else{t=Wo(r.mockUserToken,e._app?.options.projectId);let i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new W(U.INVALID_ARGUMENT,`mockUserToken must contain 'sub' or 'user_id' field!`);n=new kl(i)}e._authCredentials=new Bl(new Rl(t,n))}}var O_=class e{constructor(e,t,n){this.converter=t,this._query=n,this.type=`query`,this.firestore=e}withConverter(t){return new e(this.firestore,t,this._query)}},k_=class e{constructor(e,t,n){this.converter=t,this._key=n,this.type=`document`,this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new A_(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new e(this.firestore,t,this._key)}toJSON(){return{type:e._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,n,r){if(du(n,e._jsonSchema))return new e(t,r||null,new q(K.fromString(n.referencePath)))}};k_._jsonSchemaVersion=`firestore/documentReference/1.0`,k_._jsonSchema={type:uu(`string`,k_._jsonSchemaVersion),referencePath:uu(`string`)};var A_=class e extends O_{constructor(e,t,n){super(e,t,sf(n)),this._path=n,this.type=`collection`}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new k_(this.firestore,null,new q(e))}withConverter(t){return new e(this.firestore,t,this._path)}};function j_(e,t,...n){if(e=xs(e),ru(`collection`,`path`,t),e instanceof E_){let r=K.fromString(t,...n);return ou(r),new A_(e,null,r)}{if(!(e instanceof k_||e instanceof A_))throw new W(U.INVALID_ARGUMENT,`Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore`);let r=e._path.child(K.fromString(t,...n));return ou(r),new A_(e.firestore,null,r)}}function M_(e,t,...n){if(e=xs(e),arguments.length===1&&(t=ql.newId()),ru(`doc`,`path`,t),e instanceof E_){let r=K.fromString(t,...n);return au(r),new k_(e,null,new q(r))}{if(!(e instanceof k_||e instanceof A_))throw new W(U.INVALID_ARGUMENT,`Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore`);let r=e._path.child(K.fromString(t,...n));return au(r),new k_(e.firestore,e instanceof A_?e.converter:null,new q(r))}}var N_=`AsyncQueue`,P_=class{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new kh(this,`async_queue_retry`),this._c=()=>{let e=Dh();e&&z(N_,`Visibility state changed to `+e.visibilityState),this.M_.w_()},this.ac=e;let t=Dh();t&&typeof t.addEventListener==`function`&&t.addEventListener(`visibilitychange`,this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=Dh();t&&typeof t.removeEventListener==`function`&&t.removeEventListener(`visibilitychange`,this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));let t=new Ll;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Tu(e))throw e;z(N_,`Operation failed with retryable error: `+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){let t=this.ac.then((()=>(this.rc=!0,e().catch((e=>{throw this.nc=e,this.rc=!1,Nl(`INTERNAL UNHANDLED ERROR: `,F_(e)),e})).then((e=>(this.rc=!1,e))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let r=mg.createAndSchedule(this,e,t,n,(e=>this.hc(e)));return this.tc.push(r),r}uc(){this.nc&&B(47125,{Pc:F_(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(let t of this.tc)if(t.skipDelay(),e!==`all`&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function F_(e){let t=e.message||``;return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}var I_=class extends E_{constructor(e,t,n,r){super(e,t,n,r),this.type=`firestore`,this._queue=new P_,this._persistenceKey=r?.name||`[DEFAULT]`}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new P_(e),this._firestoreClient=void 0,await e}}};function L_(e,t){let n=typeof e==`object`?e:Jc(),r=typeof e==`string`?e:t||rd,i=Hc(n,`firestore`).getImmediate({identifier:r});if(!i._initialized){let e=Ro(`firestore`);e&&D_(i,...e)}return i}function R_(e){if(e._terminated)throw new W(U.FAILED_PRECONDITION,`The client has already been terminated.`);return e._firestoreClient||z_(e),e._firestoreClient}function z_(e){let t=e._freezeSettings(),n=function(e,t,n,r){return new nd(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,x_(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,e._app?.options.appId||``,e._persistenceKey,t);e._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(e._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),e._firestoreClient=new f_(e._authCredentials,e._appCheckCredentials,e._queue,n,e._componentsProvider&&function(e){let t=e?._online.build();return{_offline:e?._offline.build(t),_online:t}}(e._componentsProvider))}var B_=class e{constructor(e){this._byteString=e}static fromBase64String(t){try{return new e(Gu.fromBase64String(t))}catch(e){throw new W(U.INVALID_ARGUMENT,`Failed to construct data from Base64 string: `+e)}}static fromUint8Array(t){return new e(Gu.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return`Bytes(base64: `+this.toBase64()+`)`}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:e._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(du(t,e._jsonSchema))return e.fromBase64String(t.bytes)}};B_._jsonSchemaVersion=`firestore/bytes/1.0`,B_._jsonSchema={type:uu(`string`,B_._jsonSchemaVersion),bytes:uu(`string`)};var V_=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new W(U.INVALID_ARGUMENT,`Invalid field name at argument $(i + 1). Field names must not be empty.`);this._internalPath=new nu(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}},H_=class{constructor(e){this._methodName=e}},U_=class e{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new W(U.INVALID_ARGUMENT,`Latitude must be a number between -90 and 90, but was: `+e);if(!isFinite(t)||t<-180||t>180)throw new W(U.INVALID_ARGUMENT,`Longitude must be a number between -180 and 180, but was: `+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return G(this._lat,e._lat)||G(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:e._jsonSchemaVersion}}static fromJSON(t){if(du(t,e._jsonSchema))return new e(t.latitude,t.longitude)}};U_._jsonSchemaVersion=`firestore/geoPoint/1.0`,U_._jsonSchema={type:uu(`string`,U_._jsonSchemaVersion),latitude:uu(`number`),longitude:uu(`number`)};var W_=class e{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:e._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(du(t,e._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e==`number`)))return new e(t.vectorValues);throw new W(U.INVALID_ARGUMENT,`Expected 'vectorValues' field to be a number array`)}}};W_._jsonSchemaVersion=`firestore/vectorValue/1.0`,W_._jsonSchema={type:uu(`string`,W_._jsonSchemaVersion),vectorValues:uu(`object`)};var G_=/^__.*__$/,K_=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask===null?new sp(e,this.data,t,this.fieldTransforms):new cp(e,this.data,this.fieldMask,t,this.fieldTransforms)}},q_=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new cp(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function J_(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw B(40011,{Ac:e})}}var Y_=class e{constructor(e,t,n,r,i,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new e({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){let t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){let t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return dv(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc(`Document fields must not be empty`);if(J_(this.Ac)&&G_.test(e))throw this.Sc(`Document fields cannot begin and end with "__"`)}},X_=class{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Oh(e)}Cc(e,t,n,r=!1){return new Y_({Ac:e,methodName:t,Dc:n,path:nu.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Z_(e){let t=e._freezeSettings(),n=Oh(e._databaseId);return new X_(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Q_(e,t,n,r,i,a={}){let o=e.Cc(a.merge||a.mergeFields?2:0,t,n,i);sv(`Data must be an object, but it was:`,o,r);let s=av(r,o),c,l;if(a.merge)c=new Uu(o.fieldMask),l=o.fieldTransforms;else if(a.mergeFields){let e=[];for(let r of a.mergeFields){let i=cv(t,r,n);if(!o.contains(i))throw new W(U.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);fv(e,i)||e.push(i)}c=new Uu(e),l=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,l=o.fieldTransforms;return new K_(new Od(s),c,l)}var $_=class e extends H_{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(t){return t instanceof e}},ev=class e extends H_{_toFieldTransform(e){return new Xf(e.path,new Hf)}isEqual(t){return t instanceof e}};function tv(e,t,n,r){let i=e.Cc(1,t,n);sv(`Data must be an object, but it was:`,i,r);let a=[],o=Od.empty();return Iu(r,((e,r)=>{let s=uv(t,e,n);r=xs(r);let c=i.yc(s);if(r instanceof $_)a.push(s);else{let e=iv(r,c);e!=null&&(a.push(s),o.set(s,e))}})),new q_(o,new Uu(a),i.fieldTransforms)}function nv(e,t,n,r,i,a){let o=e.Cc(1,t,n),s=[cv(t,r,n)],c=[i];if(a.length%2!=0)throw new W(U.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<a.length;e+=2)s.push(cv(t,a[e])),c.push(a[e+1]);let l=[],u=Od.empty();for(let e=s.length-1;e>=0;--e)if(!fv(l,s[e])){let t=s[e],n=c[e];n=xs(n);let r=o.yc(t);if(n instanceof $_)l.push(t);else{let e=iv(n,r);e!=null&&(l.push(t),u.set(t,e))}}return new q_(u,new Uu(l),o.fieldTransforms)}function rv(e,t,n,r=!1){return iv(n,e.Cc(r?4:3,t))}function iv(e,t){if(ov(e=xs(e)))return sv(`Unsupported field value:`,t,e),av(e,t);if(e instanceof H_)return function(e,t){if(!J_(t.Ac))throw t.Sc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Sc(`${e._methodName}() is not currently supported inside arrays`);let n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc(`Nested arrays are not supported`);return function(e,t){let n=[],r=0;for(let i of e){let e=iv(i,t.wc(r));e??={nullValue:`NULL_VALUE`},n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if((e=xs(e))===null)return{nullValue:`NULL_VALUE`};if(typeof e==`number`)return Lf(t.serializer,e);if(typeof e==`boolean`)return{booleanValue:e};if(typeof e==`string`)return{stringValue:e};if(e instanceof Date){let n=mu.fromDate(e);return{timestampValue:Hp(t.serializer,n)}}if(e instanceof mu){let n=new mu(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Hp(t.serializer,n)}}if(e instanceof U_)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof B_)return{bytesValue:Up(t.serializer,e._byteString)};if(e instanceof k_){let n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Kp(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof W_)return function(e,t){return{mapValue:{fields:{[ad]:{stringValue:cd},[ld]:{arrayValue:{values:e.toArray().map((e=>{if(typeof e!=`number`)throw t.Sc(`VectorValues must only contain numeric values.`);return Ff(t.serializer,e)}))}}}}}}(e,t);throw t.Sc(`Unsupported field value: ${cu(e)}`)}(e,t)}function av(e,t){let n={};return Lu(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Iu(e,((e,r)=>{let i=iv(r,t.mc(e));i!=null&&(n[e]=i)})),{mapValue:{fields:n}}}function ov(e){return!(typeof e!=`object`||!e||e instanceof Array||e instanceof Date||e instanceof mu||e instanceof U_||e instanceof B_||e instanceof k_||e instanceof H_||e instanceof W_)}function sv(e,t,n){if(!ov(n)||!su(n)){let r=cu(n);throw r===`an object`?t.Sc(e+` a custom object`):t.Sc(e+` `+r)}}function cv(e,t,n){if((t=xs(t))instanceof V_)return t._internalPath;if(typeof t==`string`)return uv(e,t);throw dv(`Field path arguments must be of type string or `,e,!1,void 0,n)}var lv=RegExp(`[~\\*/\\[\\]]`);function uv(e,t,n){if(t.search(lv)>=0)throw dv(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new V_(...t.split(`.`))._internalPath}catch{throw dv(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function dv(e,t,n,r,i){let a=r&&!r.isEmpty(),o=i!==void 0,s=`Function ${t}() called with invalid data`;n&&(s+=" (via `toFirestore()`)"),s+=`. `;let c=``;return(a||o)&&(c+=` (found`,a&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=`)`),new W(U.INVALID_ARGUMENT,s+e+c)}function fv(e,t){return e.some((e=>e.isEqual(t)))}var pv=class{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new k_(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new mv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(hv(`DocumentSnapshot.get`,e));if(t!==null)return this._userDataWriter.convertValue(t)}}},mv=class extends pv{data(){return super.data()}};function hv(e,t){return typeof t==`string`?uv(e,t):t instanceof V_?t._internalPath:t._delegate._internalPath}function gv(e){if(e.limitType===`L`&&e.explicitOrderBy.length===0)throw new W(U.UNIMPLEMENTED,`limitToLast() queries require specifying at least one orderBy() clause`)}var _v=class{},vv=class extends _v{};function yv(e,t,...n){let r=[];t instanceof _v&&r.push(t),r=r.concat(n),function(e){let t=e.filter((e=>e instanceof xv)).length,n=e.filter((e=>e instanceof bv)).length;if(t>1||t>0&&n>0)throw new W(U.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let t of r)e=t._apply(e);return e}var bv=class e extends vv{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type=`where`}static _create(t,n,r){return new e(t,n,r)}_apply(e){let t=this._parse(e);return Ev(e._query,t),new O_(e.firestore,e.converter,pf(e._query,t))}_parse(e){let t=Z_(e.firestore);return function(e,t,n,r,i,a,o){let s;if(i.isKeyField()){if(a===`array-contains`||a===`array-contains-any`)throw new W(U.INVALID_ARGUMENT,`Invalid Query. You can't perform '${a}' queries on documentId().`);if(a===`in`||a===`not-in`){Tv(o,a);let t=[];for(let n of o)t.push(wv(r,e,n));s={arrayValue:{values:t}}}else s=wv(r,e,o)}else a!==`in`&&a!==`not-in`&&a!==`array-contains-any`||Tv(o,a),s=rv(n,t,o,a===`in`||a===`not-in`);return Ld.create(i,a,s)}(e._query,`where`,t,e.firestore._databaseId,this._field,this._op,this._value)}},xv=class e extends _v{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(t,n){return new e(t,n)}_parse(e){let t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return t.length===1?t[0]:Rd.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(e,t){let n=e,r=t.getFlattenedFilters();for(let e of r)Ev(n,e),n=pf(n,e)}(e._query,t),new O_(e.firestore,e.converter,pf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type===`and`?`and`:`or`}},Sv=class e extends vv{constructor(e,t){super(),this._field=e,this._direction=t,this.type=`orderBy`}static _create(t,n){return new e(t,n)}_apply(e){let t=function(e,t,n){if(e.startAt!==null)throw new W(U.INVALID_ARGUMENT,`Invalid query. You must not call startAt() or startAfter() before calling orderBy().`);if(e.endAt!==null)throw new W(U.INVALID_ARGUMENT,`Invalid query. You must not call endAt() or endBefore() before calling orderBy().`);return new Pd(t,n)}(e._query,this._field,this._direction);return new O_(e.firestore,e.converter,function(e,t){let n=e.explicitOrderBy.concat([t]);return new af(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}};function Cv(e,t=`asc`){let n=t,r=hv(`orderBy`,e);return Sv._create(r,n)}function wv(e,t,n){if(typeof(n=xs(n))==`string`){if(n===``)throw new W(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.`);if(!lf(t)&&n.indexOf(`/`)!==-1)throw new W(U.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=t.path.child(K.fromString(n));if(!q.isDocumentKey(r))throw new W(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return yd(e,new q(r))}if(n instanceof k_)return yd(e,n._key);throw new W(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${cu(n)}.`)}function Tv(e,t){if(!Array.isArray(e)||e.length===0)throw new W(U.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Ev(e,t){let n=function(e,t){for(let n of e)for(let e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case`!=`:return[`!=`,`not-in`];case`array-contains-any`:case`in`:return[`not-in`];case`not-in`:return[`array-contains-any`,`in`,`not-in`,`!=`];default:return[]}}(t.op));if(n!==null)throw n===t.op?new W(U.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new W(U.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}var Dv=class{convertValue(e,t=`none`){switch(ud(e)){case 0:return null;case 1:return e.booleanValue;case 2:return X(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ju(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw B(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t=`none`){let n={};return Iu(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertVectorValue(e){let t=e.fields?.[ld].arrayValue?.values?.map((e=>X(e.doubleValue)));return new W_(t)}convertGeoPoint(e){return new U_(X(e.latitude),X(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case`previous`:let n=ed(e);return n==null?null:this.convertValue(n,t);case`estimate`:return this.convertTimestamp(td(e));default:return null}}convertTimestamp(e){let t=qu(e);return new mu(t.seconds,t.nanos)}convertDocumentKey(e,t){let n=K.fromString(e);V(_m(n),9688,{name:e});let r=new id(n.get(1),n.get(3)),i=new q(n.popFirst(5));return r.isEqual(t)||Nl(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}};function Ov(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}var kv=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Av=class e extends pv{constructor(e,t,n,r,i,a){super(e,t,n,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new jv(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let n=this._document.data.field(hv(`DocumentSnapshot.get`,e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new W(U.FAILED_PRECONDITION,`DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().`);let t=this._document,n={};return n.type=e._jsonSchemaVersion,n.bundle=``,n.bundleSource=`DocumentSnapshot`,n.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,`previous`),n.bundle=(this._firestore,this.ref.path,`NOT SUPPORTED`),n)}};Av._jsonSchemaVersion=`firestore/documentSnapshot/1.0`,Av._jsonSchema={type:uu(`string`,Av._jsonSchemaVersion),bundleSource:uu(`string`,`DocumentSnapshot`),bundleName:uu(`string`),bundle:uu(`string`)};var jv=class extends Av{data(e={}){return super.data(e)}},Mv=class e{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new kv(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){let e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new jv(this._firestore,this._userDataWriter,n.key,n,new kv(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new W(U.INVALID_ARGUMENT,`To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().`);return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{let r=new jv(e._firestore,e._userDataWriter,n.doc.key,n.doc,new kv(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:`added`,doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||e.type!==3)).map((t=>{let r=new jv(e._firestore,e._userDataWriter,t.doc.key,t.doc,new kv(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return t.type!==0&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),t.type!==1&&(n=n.add(t.doc),a=n.indexOf(t.doc.key)),{type:Nv(t.type),doc:r,oldIndex:i,newIndex:a}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new W(U.FAILED_PRECONDITION,`QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().`);let t={};t.type=e._jsonSchemaVersion,t.bundleSource=`QuerySnapshot`,t.bundleName=ql.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let n=[],r=[],i=[];return this.docs.forEach((e=>{e._document!==null&&(n.push(e._document),r.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,`previous`)),i.push(e.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,`NOT SUPPORTED`),t}};function Nv(e){switch(e){case 0:return`added`;case 2:case 3:return`modified`;case 1:return`removed`;default:return B(61501,{type:e})}}function Pv(e){e=lu(e,k_);let t=lu(e.firestore,I_);return y_(R_(t),e._key).then((n=>Bv(t,e,n)))}Mv._jsonSchemaVersion=`firestore/querySnapshot/1.0`,Mv._jsonSchema={type:uu(`string`,Mv._jsonSchemaVersion),bundleSource:uu(`string`,`QuerySnapshot`),bundleName:uu(`string`),bundle:uu(`string`)};var Fv=class extends Dv{constructor(e){super(),this.firestore=e}convertBytes(e){return new B_(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new k_(this.firestore,null,t)}};function Iv(e){e=lu(e,O_);let t=lu(e.firestore,I_),n=R_(t),r=new Fv(t);return gv(e._query),b_(n,e._query).then((n=>new Mv(t,r,e,n)))}function Lv(e,t,n,...r){e=lu(e,k_);let i=lu(e.firestore,I_),a=Z_(i),o;return o=typeof(t=xs(t))==`string`||t instanceof V_?nv(a,`updateDoc`,e._key,t,n,r):tv(a,`updateDoc`,e._key,t),zv(i,[o.toMutation(e._key,$f.exists(!0))])}function Rv(e,t){let n=lu(e.firestore,I_),r=M_(e),i=Ov(e.converter,t);return zv(n,[Q_(Z_(e.firestore),`addDoc`,r._key,i,e.converter!==null,{}).toMutation(r._key,$f.exists(!1))]).then((()=>r))}function zv(e,t){return function(e,t){let n=new Ll;return e.asyncQueue.enqueueAndForget((async()=>Ug(await __(e),t,n))),n.promise}(R_(e),t)}function Bv(e,t,n){let r=n.docs.get(t._key);return new Av(e,new Fv(e),t._key,r,new kv(n.hasPendingWrites,n.fromCache),t.converter)}function Vv(){return new ev(`serverTimestamp`)}(function(e,t=!0){(function(e){Al=e})(Kc),Vc(new Ss(`firestore`,((e,{instanceIdentifier:n,options:r})=>{let i=e.getProvider(`app`).getImmediate(),a=new I_(new Vl(e.getProvider(`auth-internal`)),new Gl(i,e.getProvider(`app-check-internal`)),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,[`projectId`]))throw new W(U.INVALID_ARGUMENT,`"projectId" not provided in firebase.initializeApp.`);return new id(e.options.projectId,t)}(i,n),i);return r={useFetchStreams:t,...r},a._setSettings(r),a}),`PUBLIC`).setMultipleInstances(!0)),Yc(Dl,Ol,e),Yc(Dl,Ol,`esm2020`)})();const Hv=L_(qc({apiKey:`AIzaSyA1f3-PMD5gZyvvZon-EZGxKDUJblDb5zM`,authDomain:`we-app-honeymoon.firebaseapp.com`,projectId:`we-app-honeymoon`,storageBucket:`we-app-honeymoon.appspot.com`,messagingSenderId:`78763195904`,appId:`1:78763195904:web:8243a453a9c35e7c7222e5`}));function Uv(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Wv=Uv,Gv=new cs(`auth`,`Firebase`,Uv()),Kv=new Ns(`@firebase/auth`);function qv(e,...t){Kv.logLevel<=R.WARN&&Kv.warn(`Auth (${Kc}): ${e}`,...t)}function Jv(e,...t){Kv.logLevel<=R.ERROR&&Kv.error(`Auth (${Kc}): ${e}`,...t)}function Yv(e,...t){throw ey(e,...t)}function Xv(e,...t){return ey(e,...t)}function Zv(e,t,n){return new cs(`auth`,`Firebase`,{...Wv(),[t]:n}).create(t,{appName:e.name})}function Qv(e){return Zv(e,`operation-not-supported-in-this-environment`,`Operations that alter the current user are not supported in conjunction with FirebaseServerApp`)}function $v(e,t,n){let r=n;if(!(t instanceof r))throw r.name!==t.constructor.name&&Yv(e,`argument-error`),Zv(e,`argument-error`,`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ey(e,...t){if(typeof e!=`string`){let n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return Gv.create(e,...t)}function $(e,t,...n){if(!e)throw ey(t,...n)}function ty(e){let t=`INTERNAL ASSERTION FAILED: `+e;throw Jv(t),Error(t)}function ny(e,t){e||ty(t)}function ry(){return typeof self<`u`&&self.location?.href||``}function iy(){return ay()===`http:`||ay()===`https:`}function ay(){return typeof self<`u`&&self.location?.protocol||null}function oy(){return typeof navigator<`u`&&navigator&&`onLine`in navigator&&typeof navigator.onLine==`boolean`&&(iy()||es()||`connection`in navigator)?navigator.onLine:!0}function sy(){if(typeof navigator>`u`)return null;let e=navigator;return e.languages&&e.languages[0]||e.language||null}var cy=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,ny(t>e,`Short delay should be less than long delay!`),this.isMobile=Zo()||ts()}get(){return oy()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function ly(e,t){ny(e.emulator,`Emulator should always be set here`);let{url:n}=e.emulator;return t?`${n}${t.startsWith(`/`)?t.slice(1):t}`:n}var uy=class{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<`u`&&`fetch`in self)return self.fetch;if(typeof globalThis<`u`&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<`u`)return fetch;ty(`Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill`)}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<`u`&&`Headers`in self)return self.Headers;if(typeof globalThis<`u`&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<`u`)return Headers;ty(`Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill`)}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<`u`&&`Response`in self)return self.Response;if(typeof globalThis<`u`&&globalThis.Response)return globalThis.Response;if(typeof Response<`u`)return Response;ty(`Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill`)}},dy={CREDENTIAL_MISMATCH:`custom-token-mismatch`,MISSING_CUSTOM_TOKEN:`internal-error`,INVALID_IDENTIFIER:`invalid-email`,MISSING_CONTINUE_URI:`internal-error`,INVALID_PASSWORD:`wrong-password`,MISSING_PASSWORD:`missing-password`,INVALID_LOGIN_CREDENTIALS:`invalid-credential`,EMAIL_EXISTS:`email-already-in-use`,PASSWORD_LOGIN_DISABLED:`operation-not-allowed`,INVALID_IDP_RESPONSE:`invalid-credential`,INVALID_PENDING_TOKEN:`invalid-credential`,FEDERATED_USER_ID_ALREADY_LINKED:`credential-already-in-use`,MISSING_REQ_TYPE:`internal-error`,EMAIL_NOT_FOUND:`user-not-found`,RESET_PASSWORD_EXCEED_LIMIT:`too-many-requests`,EXPIRED_OOB_CODE:`expired-action-code`,INVALID_OOB_CODE:`invalid-action-code`,MISSING_OOB_CODE:`internal-error`,CREDENTIAL_TOO_OLD_LOGIN_AGAIN:`requires-recent-login`,INVALID_ID_TOKEN:`invalid-user-token`,TOKEN_EXPIRED:`user-token-expired`,USER_NOT_FOUND:`user-token-expired`,TOO_MANY_ATTEMPTS_TRY_LATER:`too-many-requests`,PASSWORD_DOES_NOT_MEET_REQUIREMENTS:`password-does-not-meet-requirements`,INVALID_CODE:`invalid-verification-code`,INVALID_SESSION_INFO:`invalid-verification-id`,INVALID_TEMPORARY_PROOF:`invalid-credential`,MISSING_SESSION_INFO:`missing-verification-id`,SESSION_EXPIRED:`code-expired`,MISSING_ANDROID_PACKAGE_NAME:`missing-android-pkg-name`,UNAUTHORIZED_DOMAIN:`unauthorized-continue-uri`,INVALID_OAUTH_CLIENT_ID:`invalid-oauth-client-id`,ADMIN_ONLY_OPERATION:`admin-restricted-operation`,INVALID_MFA_PENDING_CREDENTIAL:`invalid-multi-factor-session`,MFA_ENROLLMENT_NOT_FOUND:`multi-factor-info-not-found`,MISSING_MFA_ENROLLMENT_ID:`missing-multi-factor-info`,MISSING_MFA_PENDING_CREDENTIAL:`missing-multi-factor-session`,SECOND_FACTOR_EXISTS:`second-factor-already-in-use`,SECOND_FACTOR_LIMIT_EXCEEDED:`maximum-second-factor-count-exceeded`,BLOCKING_FUNCTION_ERROR_RESPONSE:`internal-error`,RECAPTCHA_NOT_ENABLED:`recaptcha-not-enabled`,MISSING_RECAPTCHA_TOKEN:`missing-recaptcha-token`,INVALID_RECAPTCHA_TOKEN:`invalid-recaptcha-token`,INVALID_RECAPTCHA_ACTION:`invalid-recaptcha-action`,MISSING_CLIENT_TYPE:`missing-client-type`,MISSING_RECAPTCHA_VERSION:`missing-recaptcha-version`,INVALID_RECAPTCHA_VERSION:`invalid-recaptcha-version`,INVALID_REQ_TYPE:`invalid-req-type`},fy=[`/v1/accounts:signInWithCustomToken`,`/v1/accounts:signInWithEmailLink`,`/v1/accounts:signInWithIdp`,`/v1/accounts:signInWithPassword`,`/v1/accounts:signInWithPhoneNumber`,`/v1/token`],py=new cy(3e4,6e4);function my(e,t){return e.tenantId&&!t.tenantId?{...t,tenantId:e.tenantId}:t}async function hy(e,t,n,r,i={}){return gy(e,i,async()=>{let i={},a={};r&&(t===`GET`?a=r:i={body:JSON.stringify(r)});let o=ms({key:e.config.apiKey,...a}).slice(1),s=await e._getAdditionalHeaders();s[`Content-Type`]=`application/json`,e.languageCode&&(s[`X-Firebase-Locale`]=e.languageCode);let c={method:t,headers:s,...i};return $o()||(c.referrerPolicy=`no-referrer`),e.emulatorConfig&&Ho(e.emulatorConfig.host)&&(c.credentials=`include`),uy.fetch()(await vy(e,e.config.apiHost,n,o),c)})}async function gy(e,t,n){e._canInitEmulator=!1;let r={...dy,...t};try{let t=new by(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();let a=await i.json();if(`needConfirmation`in a)throw xy(e,`account-exists-with-different-credential`,a);if(i.ok&&!(`errorMessage`in a))return a;{let[t,n]=(i.ok?a.errorMessage:a.error.message).split(` : `);if(t===`FEDERATED_USER_ID_ALREADY_LINKED`)throw xy(e,`credential-already-in-use`,a);if(t===`EMAIL_EXISTS`)throw xy(e,`email-already-in-use`,a);if(t===`USER_DISABLED`)throw xy(e,`user-disabled`,a);let o=r[t]||t.toLowerCase().replace(/[_\s]+/g,`-`);if(n)throw Zv(e,o,n);Yv(e,o)}}catch(t){if(t instanceof ss)throw t;Yv(e,`network-request-failed`,{message:String(t)})}}async function _y(e,t,n,r,i={}){let a=await hy(e,t,n,r,i);return`mfaPendingCredential`in a&&Yv(e,`multi-factor-auth-required`,{_serverResponse:a}),a}async function vy(e,t,n,r){let i=`${t}${n}?${r}`,a=e,o=a.config.emulator?ly(e.config,i):`${e.config.apiScheme}://${i}`;return fy.includes(n)&&(await a._persistenceManagerAvailable,a._getPersistenceType()===`COOKIE`)?a._getPersistence()._getFinalTarget(o).toString():o}function yy(e){switch(e){case`ENFORCE`:return`ENFORCE`;case`AUDIT`:return`AUDIT`;case`OFF`:return`OFF`;default:return`ENFORCEMENT_STATE_UNSPECIFIED`}}var by=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(Xv(this.auth,`network-request-failed`)),py.get())})}};function xy(e,t,n){let r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);let i=Xv(e,t,r);return i.customData._tokenResponse=n,i}function Sy(e){return e!==void 0&&e.enterprise!==void 0}var Cy=class{constructor(e){if(this.siteKey=``,this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw Error(`recaptchaKey undefined`);this.siteKey=e.recaptchaKey.split(`/`)[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return yy(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)===`ENFORCE`||this.getProviderEnforcementState(e)===`AUDIT`}isAnyProviderEnabled(){return this.isProviderEnabled(`EMAIL_PASSWORD_PROVIDER`)||this.isProviderEnabled(`PHONE_PROVIDER`)}};async function wy(e,t){return hy(e,`GET`,`/v2/recaptchaConfig`,my(e,t))}async function Ty(e,t){return hy(e,`POST`,`/v1/accounts:delete`,t)}async function Ey(e,t){return hy(e,`POST`,`/v1/accounts:lookup`,t)}function Dy(e){if(e)try{let t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function Oy(e,t=!1){let n=xs(e),r=await n.getIdToken(t),i=Ay(r);$(i&&i.exp&&i.auth_time&&i.iat,n.auth,`internal-error`);let a=typeof i.firebase==`object`?i.firebase:void 0,o=a?.sign_in_provider;return{claims:i,token:r,authTime:Dy(ky(i.auth_time)),issuedAtTime:Dy(ky(i.iat)),expirationTime:Dy(ky(i.exp)),signInProvider:o||null,signInSecondFactor:a?.sign_in_second_factor||null}}function ky(e){return Number(e)*1e3}function Ay(e){let[t,n,r]=e.split(`.`);if(t===void 0||n===void 0||r===void 0)return Jv(`JWT malformed, contained fewer than 3 sections`),null;try{let e=jo(n);return e?JSON.parse(e):(Jv(`Failed to decode base64 JWT payload`),null)}catch(e){return Jv(`Caught error parsing JWT payload as JSON`,e?.toString()),null}}function jy(e){let t=Ay(e);return $(t,`internal-error`),$(t.exp!==void 0,`internal-error`),$(t.iat!==void 0,`internal-error`),Number(t.exp)-Number(t.iat)}async function My(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof ss&&Ny(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}function Ny({code:e}){return e===`auth/user-disabled`||e===`auth/user-token-expired`}var Py=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let e=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),e}else{this.errorBackoff=3e4;let e=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code===`auth/network-request-failed`&&this.schedule(!0);return}this.schedule()}},Fy=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Dy(this.lastLoginAt),this.creationTime=Dy(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function Iy(e){let t=e.auth,n=await My(e,Ey(t,{idToken:await e.getIdToken()}));$(n?.users.length,t,`internal-error`);let r=n.users[0];e._notifyReloadListener(r);let i=r.providerUserInfo?.length?zy(r.providerUserInfo):[],a=Ry(e.providerData,i),o=e.isAnonymous,s=!(e.email&&r.passwordHash)&&!a?.length,c=o?s:!1,l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new Fy(r.createdAt,r.lastLoginAt),isAnonymous:c};Object.assign(e,l)}async function Ly(e){let t=xs(e);await Iy(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function Ry(e,t){return[...e.filter(e=>!t.some(t=>t.providerId===e.providerId)),...t]}function zy(e){return e.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||``,displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function By(e,t){let n=await gy(e,{},async()=>{let n=ms({grant_type:`refresh_token`,refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,a=await vy(e,r,`/v1/token`,`key=${i}`),o=await e._getAdditionalHeaders();o[`Content-Type`]=`application/x-www-form-urlencoded`;let s={method:`POST`,headers:o,body:n};return e.emulatorConfig&&Ho(e.emulatorConfig.host)&&(s.credentials=`include`),uy.fetch()(a,s)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Vy(e,t){return hy(e,`POST`,`/v2/accounts:revokeToken`,my(e,t))}var Hy=class e{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){$(e.idToken,`internal-error`),$(e.idToken!==void 0,`internal-error`),$(e.refreshToken!==void 0,`internal-error`);let t=`expiresIn`in e&&e.expiresIn!==void 0?Number(e.expiresIn):jy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){$(e.length!==0,`internal-error`);let t=jy(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:($(this.refreshToken,e,`user-token-expired`),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:n,refreshToken:r,expiresIn:i}=await By(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(t,n){let{refreshToken:r,accessToken:i,expirationTime:a}=n,o=new e;return r&&($(typeof r==`string`,`internal-error`,{appName:t}),o.refreshToken=r),i&&($(typeof i==`string`,`internal-error`,{appName:t}),o.accessToken=i),a&&($(typeof a==`number`,`internal-error`,{appName:t}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new e,this.toJSON())}_performRefresh(){return ty(`not implemented`)}};function Uy(e,t){$(typeof e==`string`||e===void 0,`internal-error`,{appName:t})}var Wy=class e{constructor({uid:e,auth:t,stsTokenManager:n,...r}){this.providerId=`firebase`,this.proactiveRefresh=new Py(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Fy(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){let t=await My(this,this.stsTokenManager.getToken(this.auth,e));return $(t,this.auth,`internal-error`),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Oy(this,e)}reload(){return Ly(this)}_assign(e){this!==e&&($(this.uid===e.uid,this.auth,`internal-error`),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>({...e})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(t){let n=new e({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){$(!this.reloadListener,this.auth,`internal-error`),this.reloadListener=e,this.reloadUserInfo&&=(this._notifyReloadListener(this.reloadUserInfo),null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Iy(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Uc(this.auth.app))return Promise.reject(Qv(this.auth));let e=await this.getIdToken();return await My(this,Ty(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||``}static _fromJSON(t,n){let r=n.displayName??void 0,i=n.email??void 0,a=n.phoneNumber??void 0,o=n.photoURL??void 0,s=n.tenantId??void 0,c=n._redirectEventId??void 0,l=n.createdAt??void 0,u=n.lastLoginAt??void 0,{uid:d,emailVerified:f,isAnonymous:p,providerData:m,stsTokenManager:h}=n;$(d&&h,t,`internal-error`);let g=Hy.fromJSON(this.name,h);$(typeof d==`string`,t,`internal-error`),Uy(r,t.name),Uy(i,t.name),$(typeof f==`boolean`,t,`internal-error`),$(typeof p==`boolean`,t,`internal-error`),Uy(a,t.name),Uy(o,t.name),Uy(s,t.name),Uy(c,t.name),Uy(l,t.name),Uy(u,t.name);let _=new e({uid:d,auth:t,email:i,emailVerified:f,displayName:r,isAnonymous:p,photoURL:o,phoneNumber:a,tenantId:s,stsTokenManager:g,createdAt:l,lastLoginAt:u});return m&&Array.isArray(m)&&(_.providerData=m.map(e=>({...e}))),c&&(_._redirectEventId=c),_}static async _fromIdTokenResponse(t,n,r=!1){let i=new Hy;i.updateFromServerResponse(n);let a=new e({uid:n.localId,auth:t,stsTokenManager:i,isAnonymous:r});return await Iy(a),a}static async _fromGetAccountInfoResponse(t,n,r){let i=n.users[0];$(i.localId!==void 0,`internal-error`);let a=i.providerUserInfo===void 0?[]:zy(i.providerUserInfo),o=!(i.email&&i.passwordHash)&&!a?.length,s=new Hy;s.updateFromIdToken(r);let c=new e({uid:i.localId,auth:t,stsTokenManager:s,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Fy(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(c,l),c}},Gy=new Map;function Ky(e){ny(e instanceof Function,`Expected a class definition`);let t=Gy.get(e);return t?(ny(t instanceof e,`Instance stored in cache mismatched with class`),t):(t=new e,Gy.set(e,t),t)}var qy=class{constructor(){this.type=`NONE`,this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){let t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}};qy.type=`NONE`;var Jy=qy;function Yy(e,t,n){return`firebase:${e}:${t}:${n}`}var Xy=class e{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;let{config:r,name:i}=this.auth;this.fullUserKey=Yy(this.userKey,r.apiKey,i),this.fullPersistenceKey=Yy(`persistence`,r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e==`string`){let t=await Ey(this.auth,{idToken:e}).catch(()=>void 0);return t?Wy._fromGetAccountInfoResponse(this.auth,t,e):null}return Wy._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,n,r=`authUser`){if(!n.length)return new e(Ky(Jy),t,r);let i=(await Promise.all(n.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e),a=i[0]||Ky(Jy),o=Yy(r,t.config.apiKey,t.name),s=null;for(let e of n)try{let n=await e._get(o);if(n){let r;if(typeof n==`string`){let e=await Ey(t,{idToken:n}).catch(()=>void 0);if(!e)break;r=await Wy._fromGetAccountInfoResponse(t,e,n)}else r=Wy._fromJSON(t,n);e!==a&&(s=r),a=e;break}}catch{}let c=i.filter(e=>e._shouldAllowMigration);return!a._shouldAllowMigration||!c.length?new e(a,t,r):(a=c[0],s&&await a._set(o,s.toJSON()),await Promise.all(n.map(async e=>{if(e!==a)try{await e._remove(o)}catch{}})),new e(a,t,r))}};function Zy(e){let t=e.toLowerCase();if(t.includes(`opera/`)||t.includes(`opr/`)||t.includes(`opios/`))return`Opera`;if(tb(t))return`IEMobile`;if(t.includes(`msie`)||t.includes(`trident/`))return`IE`;if(t.includes(`edge/`))return`Edge`;if(Qy(t))return`Firefox`;if(t.includes(`silk/`))return`Silk`;if(rb(t))return`Blackberry`;if(ib(t))return`Webos`;if($y(t))return`Safari`;if((t.includes(`chrome/`)||eb(t))&&!t.includes(`edge/`))return`Chrome`;if(nb(t))return`Android`;{let t=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(t?.length===2)return t[1]}return`Other`}function Qy(e=Xo()){return/firefox\//i.test(e)}function $y(e=Xo()){let t=e.toLowerCase();return t.includes(`safari/`)&&!t.includes(`chrome/`)&&!t.includes(`crios/`)&&!t.includes(`android`)}function eb(e=Xo()){return/crios\//i.test(e)}function tb(e=Xo()){return/iemobile/i.test(e)}function nb(e=Xo()){return/android/i.test(e)}function rb(e=Xo()){return/blackberry/i.test(e)}function ib(e=Xo()){return/webos/i.test(e)}function ab(e=Xo()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function ob(e=Xo()){return ab(e)&&!!window.navigator?.standalone}function sb(){return ns()&&document.documentMode===10}function cb(e=Xo()){return ab(e)||nb(e)||ib(e)||rb(e)||/windows phone/i.test(e)||tb(e)}function lb(e,t=[]){let n;switch(e){case`Browser`:n=Zy(Xo());break;case`Worker`:n=`${Zy(Xo())}-${e}`;break;default:n=e}let r=t.length?t.join(`,`):`FirebaseCore-web`;return`${n}/JsCore/${Kc}/${r}`}var ub=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let n=t=>new Promise((n,r)=>{try{n(e(t))}catch(e){r(e)}});n.onAbort=t,this.queue.push(n);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(let e of t)try{e()}catch{}throw this.auth._errorFactory.create(`login-blocked`,{originalMessage:e?.message})}}};async function db(e,t={}){return hy(e,`GET`,`/v2/passwordPolicy`,my(e,t))}var fb=6,pb=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??fb,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState===`ENFORCEMENT_STATE_UNSPECIFIED`&&(this.enforcementState=`OFF`),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join(``)??``,this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&=t.meetsMinPasswordLength??!0,t.isValid&&=t.meetsMaxPasswordLength??!0,t.isValid&&=t.containsLowercaseLetter??!0,t.isValid&&=t.containsUppercaseLetter??!0,t.isValid&&=t.containsNumericCharacter??!0,t.isValid&&=t.containsNonAlphanumericCharacter??!0,t}validatePasswordLengthOptions(e,t){let n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>=`a`&&n<=`z`,n>=`A`&&n<=`Z`,n>=`0`&&n<=`9`,this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||=t),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||=n),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||=r),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||=i)}},mb=class{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gb(this),this.idTokenSubscription=new gb(this),this.beforeStateQueue=new ub(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Gv,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ky(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Xy.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await Ey(this,{idToken:e}),n=await Wy._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(e){console.warn(`FirebaseServerApp could not login user with provided authIdToken: `,e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Uc(this.app)){let e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),n=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let t=this.redirectUser?._redirectEventId,i=n?._redirectEventId,a=await this.tryRedirectSignIn(e);(!t||t===i)&&a?.user&&(n=a.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(e){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(e))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return $(this._popupRedirectResolver,this,`argument-error`),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Iy(e)}catch(e){if(e?.code!==`auth/network-request-failed`)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=sy()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Uc(this.app))return Promise.reject(Qv(this));let t=e?xs(e):null;return t&&$(t.auth.config.apiKey===this.config.apiKey,this,`invalid-user-token`),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&$(this.tenantId===e.tenantId,this,`tenant-id-mismatch`),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Uc(this.app)?Promise.reject(Qv(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Uc(this.app)?Promise.reject(Qv(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ky(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion===this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?t.validatePassword(e):Promise.reject(this._errorFactory.create(`unsupported-password-policy-schema-version`,{}))}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=new pb(await db(this));this.tenantId===null?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new cs(`auth`,`Firebase`,e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t={providerId:`apple.com`,tokenType:`ACCESS_TOKEN`,token:e,idToken:await this.currentUser.getIdToken()};this.tenantId!=null&&(t.tenantId=this.tenantId),await Vy(this,t)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&Ky(e)||this._popupRedirectResolver;$(t,this,`argument-error`),this.redirectPersistenceManager=await Xy.create(this,[Ky(t._redirectPersistence)],`redirectUser`),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};let i=typeof t==`function`?t:t.next.bind(t),a=!1,o=this._isInitialized?Promise.resolve():this._initializationPromise;if($(o,this,`internal-error`),o.then(()=>{a||i(this.currentUser)}),typeof t==`function`){let i=e.addObserver(t,n,r);return()=>{a=!0,i()}}else{let n=e.addObserver(t);return()=>{a=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return $(this.persistenceManager,this,`internal-error`),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=lb(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e[`X-Firebase-gmpid`]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e[`X-Firebase-Client`]=t);let n=await this._getAppCheckToken();return n&&(e[`X-Firebase-AppCheck`]=n),e}async _getAppCheckToken(){if(Uc(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&qv(`Error while retrieving App Check token: ${e.error}`),e?.token}};function hb(e){return xs(e)}var gb=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=_s(e=>this.observer=e)}get next(){return $(this.observer,this.auth,`internal-error`),this.observer.next.bind(this.observer)}},_b={async loadJS(){throw Error(`Unable to load external scripts`)},recaptchaV2Script:``,recaptchaEnterpriseScript:``,gapiScript:``};function vb(e){_b=e}function yb(e){return _b.loadJS(e)}function bb(){return _b.recaptchaEnterpriseScript}function xb(){return _b.gapiScript}function Sb(e){return`__${e}${Math.floor(Math.random()*1e6)}`}var Cb=class{constructor(){this.enterprise=new wb}ready(e){e()}execute(e,t){return Promise.resolve(`token`)}render(e,t){return``}},wb=class{ready(e){e()}execute(e,t){return Promise.resolve(`token`)}render(e,t){return``}},Tb=`recaptcha-enterprise`,Eb=`NO_RECAPTCHA`,Db=class{constructor(e){this.type=Tb,this.auth=hb(e)}async verify(e=`verify`,t=!1){async function n(e){if(!t){if(e.tenantId==null&&e._agentRecaptchaConfig!=null)return e._agentRecaptchaConfig.siteKey;if(e.tenantId!=null&&e._tenantRecaptchaConfigs[e.tenantId]!==void 0)return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{wy(e,{clientType:`CLIENT_TYPE_WEB`,version:`RECAPTCHA_ENTERPRISE`}).then(r=>{if(r.recaptchaKey===void 0)n(Error(`recaptcha Enterprise site key undefined`));else{let n=new Cy(r);return e.tenantId==null?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}}).catch(e=>{n(e)})})}function r(t,n,r){let i=window.grecaptcha;Sy(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(Eb)})}):r(Error(`No reCAPTCHA enterprise script loaded.`))}return this.auth.settings.appVerificationDisabledForTesting?new Cb().execute(`siteKey`,{action:`verify`}):new Promise((e,i)=>{n(this.auth).then(n=>{if(!t&&Sy(window.grecaptcha))r(n,e,i);else{if(typeof window>`u`){i(Error(`RecaptchaVerifier is only supported in browser`));return}let t=bb();t.length!==0&&(t+=n),yb(t).then(()=>{r(n,e,i)}).catch(e=>{i(e)})}}).catch(e=>{i(e)})})}};async function Ob(e,t,n,r=!1,i=!1){let a=new Db(e),o;if(i)o=Eb;else try{o=await a.verify(n)}catch{o=await a.verify(n,!0)}let s={...t};if(n===`mfaSmsEnrollment`||n===`mfaSmsSignIn`){if(`phoneEnrollmentInfo`in s){let e=s.phoneEnrollmentInfo.phoneNumber,t=s.phoneEnrollmentInfo.recaptchaToken;Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:o,clientType:`CLIENT_TYPE_WEB`,recaptchaVersion:`RECAPTCHA_ENTERPRISE`}})}else if(`phoneSignInInfo`in s){let e=s.phoneSignInInfo.recaptchaToken;Object.assign(s,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:o,clientType:`CLIENT_TYPE_WEB`,recaptchaVersion:`RECAPTCHA_ENTERPRISE`}})}return s}return r?Object.assign(s,{captchaResp:o}):Object.assign(s,{captchaResponse:o}),Object.assign(s,{clientType:`CLIENT_TYPE_WEB`}),Object.assign(s,{recaptchaVersion:`RECAPTCHA_ENTERPRISE`}),s}async function kb(e,t,n,r,i){return i===`EMAIL_PASSWORD_PROVIDER`?e._getRecaptchaConfig()?.isProviderEnabled(`EMAIL_PASSWORD_PROVIDER`)?r(e,await Ob(e,t,n,n===`getOobCode`)):r(e,t).catch(async i=>i.code===`auth/missing-recaptcha-token`?(console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`),r(e,await Ob(e,t,n,n===`getOobCode`))):Promise.reject(i)):i===`PHONE_PROVIDER`?e._getRecaptchaConfig()?.isProviderEnabled(`PHONE_PROVIDER`)?r(e,await Ob(e,t,n)).catch(async i=>e._getRecaptchaConfig()?.getProviderEnforcementState(`PHONE_PROVIDER`)===`AUDIT`&&(i.code===`auth/missing-recaptcha-token`||i.code===`auth/invalid-app-credential`)?(console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`),r(e,await Ob(e,t,n,!1,!0))):Promise.reject(i)):r(e,await Ob(e,t,n,!1,!0)):Promise.reject(i+` provider is not supported.`)}async function Ab(e){let t=hb(e),n=new Cy(await wy(t,{clientType:`CLIENT_TYPE_WEB`,version:`RECAPTCHA_ENTERPRISE`}));t.tenantId==null?t._agentRecaptchaConfig=n:t._tenantRecaptchaConfigs[t.tenantId]=n,n.isAnyProviderEnabled()&&new Db(t).verify()}function jb(e,t){let n=Hc(e,`auth`);if(n.isInitialized()){let e=n.getImmediate();if(fs(n.getOptions(),t??{}))return e;Yv(e,`already-initialized`)}return n.initialize({options:t})}function Mb(e,t){let n=t?.persistence||[],r=(Array.isArray(n)?n:[n]).map(Ky);t?.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,t?.popupRedirectResolver)}function Nb(e,t,n){let r=hb(e);$(/^https?:\/\//.test(t),r,`invalid-emulator-scheme`);let i=!!n?.disableWarnings,a=Pb(t),{host:o,port:s}=Fb(t),c=s===null?``:`:${s}`,l={url:`${a}//${o}${c}/`},u=Object.freeze({host:o,port:s,protocol:a.replace(`:`,``),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){$(r.config.emulator&&r.emulatorConfig,r,`emulator-config-failed`),$(fs(l,r.config.emulator)&&fs(u,r.emulatorConfig),r,`emulator-config-failed`);return}r.config.emulator=l,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,Ho(o)?(Uo(`${a}//${o}${c}`),Yo(`Auth`,!0)):i||Lb()}function Pb(e){let t=e.indexOf(`:`);return t<0?``:e.substr(0,t+1)}function Fb(e){let t=Pb(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:``,port:null};let r=n[2].split(`@`).pop()||``,i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let e=i[1];return{host:e,port:Ib(r.substr(e.length+1))}}else{let[e,t]=r.split(`:`);return{host:e,port:Ib(t)}}}function Ib(e){if(!e)return null;let t=Number(e);return isNaN(t)?null:t}function Lb(){function e(){let e=document.createElement(`p`),t=e.style;e.innerText=`Running in emulator mode. Do not use with production credentials.`,t.position=`fixed`,t.width=`100%`,t.backgroundColor=`#ffffff`,t.border=`.1em solid #000000`,t.color=`#b50000`,t.bottom=`0px`,t.left=`0px`,t.margin=`0px`,t.zIndex=`10000`,t.textAlign=`center`,e.classList.add(`firebase-emulator-warning`),document.body.appendChild(e)}typeof console<`u`&&typeof console.info==`function`&&console.info(`WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.`),typeof window<`u`&&typeof document<`u`&&(document.readyState===`loading`?window.addEventListener(`DOMContentLoaded`,e):e())}var Rb=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ty(`not implemented`)}_getIdTokenResponse(e){return ty(`not implemented`)}_linkToIdToken(e,t){return ty(`not implemented`)}_getReauthenticationResolver(e){return ty(`not implemented`)}};async function zb(e,t){return hy(e,`POST`,`/v1/accounts:signUp`,t)}async function Bb(e,t){return _y(e,`POST`,`/v1/accounts:signInWithPassword`,my(e,t))}async function Vb(e,t){return _y(e,`POST`,`/v1/accounts:signInWithEmailLink`,my(e,t))}async function Hb(e,t){return _y(e,`POST`,`/v1/accounts:signInWithEmailLink`,my(e,t))}var Ub=class e extends Rb{constructor(e,t,n,r=null){super(`password`,n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(t,n){return new e(t,n,`password`)}static _fromEmailAndCode(t,n,r=null){return new e(t,n,`emailLink`,r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e==`string`?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod===`password`)return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod===`emailLink`)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case`password`:return kb(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:`CLIENT_TYPE_WEB`},`signInWithPassword`,Bb,`EMAIL_PASSWORD_PROVIDER`);case`emailLink`:return Vb(e,{email:this._email,oobCode:this._password});default:Yv(e,`internal-error`)}}async _linkToIdToken(e,t){switch(this.signInMethod){case`password`:return kb(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:`CLIENT_TYPE_WEB`},`signUpPassword`,zb,`EMAIL_PASSWORD_PROVIDER`);case`emailLink`:return Hb(e,{idToken:t,email:this._email,oobCode:this._password});default:Yv(e,`internal-error`)}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};async function Wb(e,t){return _y(e,`POST`,`/v1/accounts:signInWithIdp`,my(e,t))}var Gb=`http://localhost`,Kb=class e extends Rb{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){let n=new e(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(n.idToken=t.idToken),t.accessToken&&(n.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(n.nonce=t.nonce),t.pendingToken&&(n.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(n.accessToken=t.oauthToken,n.secret=t.oauthTokenSecret):Yv(`argument-error`),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){let{providerId:n,signInMethod:r,...i}=typeof t==`string`?JSON.parse(t):t;if(!n||!r)return null;let a=new e(n,r);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){return Wb(e,this.buildRequest())}_linkToIdToken(e,t){let n=this.buildRequest();return n.idToken=t,Wb(e,n)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Wb(e,t)}buildRequest(){let e={requestUri:Gb,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ms(t)}return e}};async function qb(e,t){return hy(e,`POST`,`/v1/accounts:sendVerificationCode`,my(e,t))}async function Jb(e,t){return _y(e,`POST`,`/v1/accounts:signInWithPhoneNumber`,my(e,t))}async function Yb(e,t){let n=await _y(e,`POST`,`/v1/accounts:signInWithPhoneNumber`,my(e,t));if(n.temporaryProof)throw xy(e,`account-exists-with-different-credential`,n);return n}var Xb={USER_NOT_FOUND:`user-not-found`};async function Zb(e,t){return _y(e,`POST`,`/v1/accounts:signInWithPhoneNumber`,my(e,{...t,operation:`REAUTH`}),Xb)}var Qb=class e extends Rb{constructor(e){super(`phone`,`phone`),this.params=e}static _fromVerification(t,n){return new e({verificationId:t,verificationCode:n})}static _fromTokenResponse(t,n){return new e({phoneNumber:t,temporaryProof:n})}_getIdTokenResponse(e){return Jb(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return Yb(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return Zb(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(t){typeof t==`string`&&(t=JSON.parse(t));let{verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:a}=t;return!r&&!n&&!i&&!a?null:new e({verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:a})}};function $b(e){switch(e){case`recoverEmail`:return`RECOVER_EMAIL`;case`resetPassword`:return`PASSWORD_RESET`;case`signIn`:return`EMAIL_SIGNIN`;case`verifyEmail`:return`VERIFY_EMAIL`;case`verifyAndChangeEmail`:return`VERIFY_AND_CHANGE_EMAIL`;case`revertSecondFactorAddition`:return`REVERT_SECOND_FACTOR_ADDITION`;default:return null}}function ex(e){let t=hs(gs(e)).link,n=t?hs(gs(t)).deep_link_id:null,r=hs(gs(e)).deep_link_id;return(r?hs(gs(r)).link:null)||r||n||t||e}var tx=class e{constructor(e){let t=hs(gs(e)),n=t.apiKey??null,r=t.oobCode??null,i=$b(t.mode??null);$(n&&r&&i,`argument-error`),this.apiKey=n,this.operation=i,this.code=r,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(t){let n=ex(t);try{return new e(n)}catch{return null}}},nx=class e{constructor(){this.providerId=e.PROVIDER_ID}static credential(e,t){return Ub._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){let n=tx.parseLink(t);return $(n,`argument-error`),Ub._fromEmailAndCode(e,n.code,n.tenantId)}};nx.PROVIDER_ID=`password`,nx.EMAIL_PASSWORD_SIGN_IN_METHOD=`password`,nx.EMAIL_LINK_SIGN_IN_METHOD=`emailLink`;var rx=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}},ix=class extends rx{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}},ax=class e extends ix{constructor(){super(`facebook.com`)}static credential(t){return Kb._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return e.credentialFromTaggedObject(t)}static credentialFromError(t){return e.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!(`oauthAccessToken`in t)||!t.oauthAccessToken)return null;try{return e.credential(t.oauthAccessToken)}catch{return null}}};ax.FACEBOOK_SIGN_IN_METHOD=`facebook.com`,ax.PROVIDER_ID=`facebook.com`;var ox=class e extends ix{constructor(){super(`google.com`),this.addScope(`profile`)}static credential(t,n){return Kb._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})}static credentialFromResult(t){return e.credentialFromTaggedObject(t)}static credentialFromError(t){return e.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return e.credential(n,r)}catch{return null}}};ox.GOOGLE_SIGN_IN_METHOD=`google.com`,ox.PROVIDER_ID=`google.com`;var sx=class e extends ix{constructor(){super(`github.com`)}static credential(t){return Kb._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return e.credentialFromTaggedObject(t)}static credentialFromError(t){return e.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!(`oauthAccessToken`in t)||!t.oauthAccessToken)return null;try{return e.credential(t.oauthAccessToken)}catch{return null}}};sx.GITHUB_SIGN_IN_METHOD=`github.com`,sx.PROVIDER_ID=`github.com`;var cx=class e extends ix{constructor(){super(`twitter.com`)}static credential(t,n){return Kb._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:n})}static credentialFromResult(t){return e.credentialFromTaggedObject(t)}static credentialFromError(t){return e.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return e.credential(n,r)}catch{return null}}};cx.TWITTER_SIGN_IN_METHOD=`twitter.com`,cx.PROVIDER_ID=`twitter.com`;async function lx(e,t){return _y(e,`POST`,`/v1/accounts:signUp`,my(e,t))}var ux=class e{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(t,n,r,i=!1){return new e({user:await Wy._fromIdTokenResponse(t,r,i),providerId:dx(r),_tokenResponse:r,operationType:n})}static async _forOperation(t,n,r){return await t._updateTokensIfNecessary(r,!0),new e({user:t,providerId:dx(r),_tokenResponse:r,operationType:n})}};function dx(e){return e.providerId?e.providerId:`phoneNumber`in e?`phone`:null}async function fx(e){if(Uc(e.app))return Promise.reject(Qv(e));let t=hb(e);if(await t._initializationPromise,t.currentUser?.isAnonymous)return new ux({user:t.currentUser,providerId:null,operationType:`signIn`});let n=await lx(t,{returnSecureToken:!0}),r=await ux._fromIdTokenResponse(t,`signIn`,n,!0);return await t._updateCurrentUser(r.user),r}var px=class e extends ss{constructor(t,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,e.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(t,n,r,i){return new e(t,n,r,i)}};function mx(e,t,n,r){return(t===`reauthenticate`?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{throw n.code===`auth/multi-factor-auth-required`?px._fromErrorAndOperation(e,n,t,r):n})}async function hx(e,t,n=!1){let r=await My(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return ux._forOperation(e,`link`,r)}async function gx(e,t,n=!1){let{auth:r}=e;if(Uc(r.app))return Promise.reject(Qv(r));let i=`reauthenticate`;try{let a=await My(e,mx(r,i,t,e),n);$(a.idToken,r,`internal-error`);let o=Ay(a.idToken);$(o,r,`internal-error`);let{sub:s}=o;return $(e.uid===s,r,`user-mismatch`),ux._forOperation(e,i,a)}catch(e){throw e?.code===`auth/user-not-found`&&Yv(r,`user-mismatch`),e}}async function _x(e,t,n=!1){if(Uc(e.app))return Promise.reject(Qv(e));let r=`signIn`,i=await mx(e,r,t),a=await ux._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(a.user),a}function vx(e,t,n,r){return xs(e).onIdTokenChanged(t,n,r)}function yx(e,t,n){return xs(e).beforeAuthStateChanged(t,n)}function bx(e,t,n,r){return xs(e).onAuthStateChanged(t,n,r)}function xx(e){return xs(e).signOut()}function Sx(e,t){return hy(e,`POST`,`/v2/accounts/mfaEnrollment:start`,my(e,t))}function Cx(e,t){return hy(e,`POST`,`/v2/accounts/mfaEnrollment:finalize`,my(e,t))}function wx(e,t){return hy(e,`POST`,`/v2/accounts/mfaEnrollment:start`,my(e,t))}function Tx(e,t){return hy(e,`POST`,`/v2/accounts/mfaEnrollment:finalize`,my(e,t))}var Ex=`__sak`,Dx=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ex,`1`),this.storage.removeItem(Ex),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}},Ox=1e3,kx=10,Ax=class extends Dx{constructor(){super(()=>window.localStorage,`LOCAL`),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=cb(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(let t of Object.keys(this.listeners)){let n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});return}let n=e.key;t?this.detachListener():this.stopPolling();let r=()=>{let e=this.storage.getItem(n);!t&&this.localCache[n]===e||this.notifyListeners(n,e)},i=this.storage.getItem(n);sb()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,kx):r()}notifyListeners(e,t){this.localCache[e]=t;let n=this.listeners[e];if(n)for(let e of Array.from(n))e(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent(`storage`,{key:e,oldValue:t,newValue:n}),!0)})},Ox)}stopPolling(){this.pollTimer&&=(clearInterval(this.pollTimer),null)}attachListener(){window.addEventListener(`storage`,this.boundEventHandler)}detachListener(){window.removeEventListener(`storage`,this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){let t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}};Ax.type=`LOCAL`;var jx=Ax,Mx=1e3;function Nx(e){let t=e.replace(/[\\^$.*+?()[\]{}|]/g,`\\$&`),n=RegExp(`${t}=([^;]+)`);return document.cookie.match(n)?.[1]??null}function Px(e){return`${window.location.protocol===`http:`?`__dev_`:`__HOST-`}FIREBASE_${e.split(`:`)[3]}`}var Fx=class{constructor(){this.type=`COOKIE`,this.listenerUnsubscribes=new Map}_getFinalTarget(e){let t=new URL(`${window.location.origin}/__cookies__`);return t.searchParams.set(`finalTarget`,e),t}async _isAvailable(){return typeof isSecureContext==`boolean`&&!isSecureContext||typeof navigator>`u`||typeof document>`u`?!1:navigator.cookieEnabled??!0}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;let t=Px(e);return window.cookieStore?(await window.cookieStore.get(t))?.value:Nx(t)}async _remove(e){if(!this._isAvailable()||!await this._get(e))return;let t=Px(e);document.cookie=`${t}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch(`/__cookies__`,{method:`DELETE`}).catch(()=>void 0)}_addListener(e,t){if(!this._isAvailable())return;let n=Px(e);if(window.cookieStore){let e=(e=>{let r=e.changed.find(e=>e.name===n);r&&t(r.value),e.deleted.find(e=>e.name===n)&&t(null)});return this.listenerUnsubscribes.set(t,()=>window.cookieStore.removeEventListener(`change`,e)),window.cookieStore.addEventListener(`change`,e)}let r=Nx(n),i=setInterval(()=>{let e=Nx(n);e!==r&&(t(e),r=e)},Mx);this.listenerUnsubscribes.set(t,()=>clearInterval(i))}_removeListener(e,t){let n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}};Fx.type=`COOKIE`;var Ix=class extends Dx{constructor(){super(()=>window.sessionStorage,`SESSION`)}_addListener(e,t){}_removeListener(e,t){}};Ix.type=`SESSION`;var Lx=Ix;function Rx(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}}))}var zx=class e{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let n=this.receivers.find(e=>e.isListeningto(t));if(n)return n;let r=new e(t);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){let t=e,{eventId:n,eventType:r,data:i}=t.data,a=this.handlersMap[r];if(!a?.size)return;t.ports[0].postMessage({status:`ack`,eventId:n,eventType:r});let o=await Rx(Array.from(a).map(async e=>e(t.origin,i)));t.ports[0].postMessage({status:`done`,eventId:n,eventType:r,response:o})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener(`message`,this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener(`message`,this.boundEventHandler)}};zx.receivers=[];function Bx(e=``,t=10){let n=``;for(let e=0;e<t;e++)n+=Math.floor(Math.random()*10);return e+n}var Vx=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener(`message`,e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){let r=typeof MessageChannel<`u`?new MessageChannel:null;if(!r)throw Error(`connection_unavailable`);let i,a;return new Promise((o,s)=>{let c=Bx(``,20);r.port1.start();let l=setTimeout(()=>{s(Error(`unsupported_event`))},n);a={messageChannel:r,onMessage(e){let t=e;if(t.data.eventId===c)switch(t.data.status){case`ack`:clearTimeout(l),i=setTimeout(()=>{s(Error(`timeout`))},3e3);break;case`done`:clearTimeout(i),o(t.data.response);break;default:clearTimeout(l),clearTimeout(i),s(Error(`invalid_response`));break}}},this.handlers.add(a),r.port1.addEventListener(`message`,a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}};function Hx(){return window}function Ux(e){Hx().location.href=e}function Wx(){return Hx().WorkerGlobalScope!==void 0&&typeof Hx().importScripts==`function`}async function Gx(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Kx(){return navigator?.serviceWorker?.controller||null}function qx(){return Wx()?self:null}var Jx=`firebaseLocalStorageDb`,Yx=1,Xx=`firebaseLocalStorage`,Zx=`fbase_key`,Qx=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener(`success`,()=>{e(this.request.result)}),this.request.addEventListener(`error`,()=>{t(this.request.error)})})}};function $x(e,t){return e.transaction([Xx],t?`readwrite`:`readonly`).objectStore(Xx)}function eS(){return new Qx(indexedDB.deleteDatabase(Jx)).toPromise()}function tS(){let e=indexedDB.open(Jx,Yx);return new Promise((t,n)=>{e.addEventListener(`error`,()=>{n(e.error)}),e.addEventListener(`upgradeneeded`,()=>{let t=e.result;try{t.createObjectStore(Xx,{keyPath:Zx})}catch(e){n(e)}}),e.addEventListener(`success`,async()=>{let n=e.result;n.objectStoreNames.contains(Xx)?t(n):(n.close(),await eS(),t(await tS()))})})}async function nS(e,t,n){return new Qx($x(e,!0).put({[Zx]:t,value:n})).toPromise()}async function rS(e,t){let n=await new Qx($x(e,!1).get(t)).toPromise();return n===void 0?null:n.value}function iS(e,t){return new Qx($x(e,!0).delete(t)).toPromise()}var aS=800,oS=3,sS=class{constructor(){this.type=`LOCAL`,this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||=await tS(),this.db}async _withRetries(e){let t=0;for(;;)try{return await e(await this._openDb())}catch(e){if(t++>oS)throw e;this.db&&=(this.db.close(),void 0)}}async initializeServiceWorkerMessaging(){return Wx()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=zx._getInstance(qx()),this.receiver._subscribe(`keyChanged`,async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe(`ping`,async(e,t)=>[`keyChanged`])}async initializeSender(){if(this.activeServiceWorker=await Gx(),!this.activeServiceWorker)return;this.sender=new Vx(this.activeServiceWorker);let e=await this.sender._send(`ping`,{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes(`keyChanged`)&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Kx()!==this.activeServiceWorker))try{await this.sender._send(`keyChanged`,{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let e=await tS();return await nS(e,Ex,`1`),await iS(e,Ex),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>nS(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){let t=await this._withRetries(t=>rS(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>iS(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){let e=await this._withRetries(e=>new Qx($x(e,!1).getAll()).toPromise());if(!e||this.pendingWrites!==0)return[];let t=[],n=new Set;if(e.length!==0)for(let{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(let e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;let n=this.listeners[e];if(n)for(let e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),aS)}stopPolling(){this.pollTimer&&=(clearInterval(this.pollTimer),null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}};sS.type=`LOCAL`;var cS=sS;function lS(e,t){return hy(e,`POST`,`/v2/accounts/mfaSignIn:start`,my(e,t))}function uS(e,t){return hy(e,`POST`,`/v2/accounts/mfaSignIn:finalize`,my(e,t))}function dS(e,t){return hy(e,`POST`,`/v2/accounts/mfaSignIn:finalize`,my(e,t))}Sb(`rcb`),new cy(3e4,6e4);var fS=`recaptcha`;async function pS(e,t,n){if(!e._getRecaptchaConfig())try{await Ab(e)}catch{console.log(`Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.`)}try{let r;if(r=typeof t==`string`?{phoneNumber:t}:t,`session`in r){let t=r.session;if(`phoneNumber`in r)return $(t.type===`enroll`,e,`internal-error`),(await kb(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:`CLIENT_TYPE_WEB`}},`mfaSmsEnrollment`,async(e,t)=>t.phoneEnrollmentInfo.captchaResponse===Eb?($(n?.type===fS,e,`argument-error`),Sx(e,await mS(e,t,n))):Sx(e,t),`PHONE_PROVIDER`).catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo;{$(t.type===`signin`,e,`internal-error`);let i=r.multiFactorHint?.uid||r.multiFactorUid;return $(i,e,`missing-multi-factor-info`),(await kb(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:i,phoneSignInInfo:{clientType:`CLIENT_TYPE_WEB`}},`mfaSmsSignIn`,async(e,t)=>t.phoneSignInInfo.captchaResponse===Eb?($(n?.type===fS,e,`argument-error`),lS(e,await mS(e,t,n))):lS(e,t),`PHONE_PROVIDER`).catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}else return(await kb(e,{phoneNumber:r.phoneNumber,clientType:`CLIENT_TYPE_WEB`},`sendVerificationCode`,async(e,t)=>t.captchaResponse===Eb?($(n?.type===fS,e,`argument-error`),qb(e,await mS(e,t,n))):qb(e,t),`PHONE_PROVIDER`).catch(e=>Promise.reject(e))).sessionInfo}finally{n?._reset()}}async function mS(e,t,n){$(n.type===fS,e,`argument-error`);let r=await n.verify();$(typeof r==`string`,e,`argument-error`);let i={...t};if(`phoneEnrollmentInfo`in i){let e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,n=i.phoneEnrollmentInfo.clientType,a=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:a}}),i}else if(`phoneSignInInfo`in i){let e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,n=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),i}else return Object.assign(i,{recaptchaToken:r}),i}var hS=class e{constructor(t){this.providerId=e.PROVIDER_ID,this.auth=hb(t)}verifyPhoneNumber(e,t){return pS(this.auth,e,xs(t))}static credential(e,t){return Qb._fromVerification(e,t)}static credentialFromResult(t){let n=t;return e.credentialFromTaggedObject(n)}static credentialFromError(t){return e.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{phoneNumber:t,temporaryProof:n}=e;return t&&n?Qb._fromTokenResponse(t,n):null}};hS.PROVIDER_ID=`phone`,hS.PHONE_SIGN_IN_METHOD=`phone`;function gS(e,t){return t?Ky(t):($(e._popupRedirectResolver,e,`argument-error`),e._popupRedirectResolver)}var _S=class extends Rb{constructor(e){super(`custom`,`custom`),this.params=e}_getIdTokenResponse(e){return Wb(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Wb(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Wb(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function vS(e){return _x(e.auth,new _S(e),e.bypassAuthState)}function yS(e){let{auth:t,user:n}=e;return $(n,t,`internal-error`),gx(n,new _S(e),e.bypassAuthState)}async function bS(e){let{auth:t,user:n}=e;return $(n,t,`internal-error`),hx(n,new _S(e),e.bypassAuthState)}var xS=class{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}let s={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(s))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case`signInViaPopup`:case`signInViaRedirect`:return vS;case`linkViaPopup`:case`linkViaRedirect`:return bS;case`reauthViaPopup`:case`reauthViaRedirect`:return yS;default:Yv(this.auth,`internal-error`)}}resolve(e){ny(this.pendingPromise,`Pending promise was never set`),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ny(this.pendingPromise,`Pending promise was never set`),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}},SS=new cy(2e3,1e4);async function CS(e,t,n){if(Uc(e.app))return Promise.reject(Xv(e,`operation-not-supported-in-this-environment`));let r=hb(e);return $v(e,t,rx),new wS(r,`signInViaPopup`,t,gS(r,n)).executeNotNull()}var wS=class e extends xS{constructor(t,n,r,i,a){super(t,n,i,a),this.provider=r,this.authWindow=null,this.pollId=null,e.currentPopupAction&&e.currentPopupAction.cancel(),e.currentPopupAction=this}async executeNotNull(){let e=await this.execute();return $(e,this.auth,`internal-error`),e}async onExecution(){ny(this.filter.length===1,`Popup operations only handle one event`);let e=Bx();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(Xv(this.auth,`web-storage-unsupported`))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Xv(this.auth,`cancelled-popup-request`))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,e.currentPopupAction=null}pollUserCancellation(){let e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Xv(this.auth,`popup-closed-by-user`))},8e3);return}this.pollId=window.setTimeout(e,SS.get())};e()}};wS.currentPopupAction=null;var TS=`pendingRedirect`,ES=new Map,DS=class extends xS{constructor(e,t,n=!1){super(e,[`signInViaRedirect`,`linkViaRedirect`,`reauthViaRedirect`,`unknown`],t,void 0,n),this.eventId=null}async execute(){let e=ES.get(this.auth._key());if(!e){try{let t=await OS(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}ES.set(this.auth._key(),e)}return this.bypassAuthState||ES.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type===`signInViaRedirect`)return super.onAuthEvent(e);if(e.type===`unknown`){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function OS(e,t){let n=jS(t),r=AS(e);if(!await r._isAvailable())return!1;let i=await r._get(n)===`true`;return await r._remove(n),i}function kS(e,t){ES.set(e._key(),t)}function AS(e){return Ky(e._redirectPersistence)}function jS(e){return Yy(TS,e.config.apiKey,e.name)}async function MS(e,t,n=!1){if(Uc(e.app))return Promise.reject(Qv(e));let r=hb(e),i=await new DS(r,gS(r,t),n).execute();return i&&!n&&(delete i.user._redirectEventId,await r._persistUserIfCurrent(i.user),await r._setRedirectUser(null,t)),i}var NS=600*1e3,PS=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!LS(e)?t:(this.hasHandledPotentialRedirect=!0,t||=(this.queuedRedirectEvent=e,!0),t)}sendToConsumer(e,t){if(e.error&&!IS(e)){let n=e.error.code?.split(`auth/`)[1]||`internal-error`;t.onError(Xv(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=NS&&this.cachedEventUids.clear(),this.cachedEventUids.has(FS(e))}saveEventToCache(e){this.cachedEventUids.add(FS(e)),this.lastProcessedEventTime=Date.now()}};function FS(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join(`-`)}function IS({type:e,error:t}){return e===`unknown`&&t?.code===`auth/no-auth-event`}function LS(e){switch(e.type){case`signInViaRedirect`:case`linkViaRedirect`:case`reauthViaRedirect`:return!0;case`unknown`:return IS(e);default:return!1}}async function RS(e,t={}){return hy(e,`GET`,`/v1/projects`,t)}var zS=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,BS=/^https?/;async function VS(e){if(e.config.emulator)return;let{authorizedDomains:t}=await RS(e);for(let e of t)try{if(HS(e))return}catch{}Yv(e,`unauthorized-domain`)}function HS(e){let t=ry(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith(`chrome-extension://`)){let i=new URL(e);return i.hostname===``&&r===``?n===`chrome-extension:`&&e.replace(`chrome-extension://`,``)===t.replace(`chrome-extension://`,``):n===`chrome-extension:`&&i.hostname===r}if(!BS.test(n))return!1;if(zS.test(e))return r===e;let i=e.replace(/\./g,`\\.`);return RegExp(`^(.+\\.`+i+`|`+i+`)$`,`i`).test(r)}var US=new cy(3e4,6e4);function WS(){let e=Hx().___jsl;if(e?.H){for(let t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}}function GS(e){return new Promise((t,n)=>{function r(){WS(),gapi.load(`gapi.iframes`,{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{WS(),n(Xv(e,`network-request-failed`))},timeout:US.get()})}if(Hx().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(Hx().gapi?.load)r();else{let t=Sb(`iframefcb`);return Hx()[t]=()=>{gapi.load?r():n(Xv(e,`network-request-failed`))},yb(`${xb()}?onload=${t}`).catch(e=>n(e))}}).catch(e=>{throw KS=null,e})}var KS=null;function qS(e){return KS||=GS(e),KS}var JS=new cy(5e3,15e3),YS=`__/auth/iframe`,XS=`emulator/auth/iframe`,ZS={style:{position:`absolute`,top:`-100px`,width:`1px`,height:`1px`},"aria-hidden":`true`,tabindex:`-1`},QS=new Map([[`identitytoolkit.googleapis.com`,`p`],[`staging-identitytoolkit.sandbox.googleapis.com`,`s`],[`test-identitytoolkit.sandbox.googleapis.com`,`t`]]);function $S(e){let t=e.config;$(t.authDomain,e,`auth-domain-config-required`);let n=t.emulator?ly(t,XS):`https://${e.config.authDomain}/${YS}`,r={apiKey:t.apiKey,appName:e.name,v:Kc},i=QS.get(e.config.apiHost);i&&(r.eid=i);let a=e._getFrameworks();return a.length&&(r.fw=a.join(`,`)),`${n}?${ms(r).slice(1)}`}async function eC(e){let t=await qS(e),n=Hx().gapi;return $(n,e,`internal-error`),t.open({where:document.body,url:$S(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ZS,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});let i=Xv(e,`network-request-failed`),a=Hx().setTimeout(()=>{r(i)},JS.get());function o(){Hx().clearTimeout(a),n(t)}t.ping(o).then(o,()=>{r(i)})}))}var tC={location:`yes`,resizable:`yes`,statusbar:`yes`,toolbar:`no`},nC=500,rC=600,iC=`_blank`,aC=`http://localhost`,oC=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function sC(e,t,n,r=nC,i=rC){let a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),s=``,c={...tC,width:r.toString(),height:i.toString(),top:a,left:o},l=Xo().toLowerCase();n&&(s=eb(l)?iC:n),Qy(l)&&(t||=aC,c.scrollbars=`yes`);let u=Object.entries(c).reduce((e,[t,n])=>`${e}${t}=${n},`,``);if(ob(l)&&s!==`_self`)return cC(t||``,s),new oC(null);let d=window.open(t||``,s,u);$(d,e,`popup-blocked`);try{d.focus()}catch{}return new oC(d)}function cC(e,t){let n=document.createElement(`a`);n.href=e,n.target=t;let r=document.createEvent(`MouseEvent`);r.initMouseEvent(`click`,!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}var lC=`__/auth/handler`,uC=`emulator/auth/handler`,dC=`fac`;async function fC(e,t,n,r,i,a){$(e.config.authDomain,e,`auth-domain-config-required`),$(e.config.apiKey,e,`invalid-api-key`);let o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Kc,eventId:i};if(t instanceof rx){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||``,ds(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(let[e,t]of Object.entries(a||{}))o[e]=t}if(t instanceof ix){let e=t.getScopes().filter(e=>e!==``);e.length>0&&(o.scopes=e.join(`,`))}e.tenantId&&(o.tid=e.tenantId);let s=o;for(let e of Object.keys(s))s[e]===void 0&&delete s[e];let c=await e._getAppCheckToken(),l=c?`#${dC}=${encodeURIComponent(c)}`:``;return`${pC(e)}?${ms(s).slice(1)}${l}`}function pC({config:e}){return e.emulator?ly(e,uC):`https://${e.authDomain}/${lC}`}var mC=`webStorageSupport`,hC=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Lx,this._completeRedirectFn=MS,this._overrideRedirectResult=kS}async _openPopup(e,t,n,r){return ny(this.eventManagers[e._key()]?.manager,`_initialize() not called before _openPopup()`),sC(e,await fC(e,t,n,ry(),r),Bx())}async _openRedirect(e,t,n,r){return await this._originValidation(e),Ux(await fC(e,t,n,ry(),r)),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(ny(n,`If manager is not set, promise should be`),n)}let n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){let t=await eC(e),n=new PS(e);return t.register(`authEvent`,t=>($(t?.authEvent,e,`invalid-auth-event`),{status:n.onEvent(t.authEvent)?`ACK`:`ERROR`}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(mC,{type:mC},n=>{let r=n?.[0]?.[mC];r!==void 0&&t(!!r),Yv(e,`internal-error`)},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=VS(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return cb()||$y()||ab()}},gC=class{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case`enroll`:return this._finalizeEnroll(e,t.credential,n);case`signin`:return this._finalizeSignIn(e,t.credential);default:return ty(`unexpected MultiFactorSessionType`)}}},_C=class e extends gC{constructor(e){super(`phone`),this.credential=e}static _fromCredential(t){return new e(t)}_finalizeEnroll(e,t,n){return Cx(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return uS(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},vC=class{constructor(){}static assertion(e){return _C._fromCredential(e)}};vC.FACTOR_ID=`phone`;var yC=class{static assertionForEnrollment(e,t){return bC._fromSecret(e,t)}static assertionForSignIn(e,t){return bC._fromEnrollmentId(e,t)}static async generateSecret(e){let t=e;$(t.user?.auth!==void 0,`internal-error`);let n=await wx(t.user.auth,{idToken:t.credential,totpEnrollmentInfo:{}});return xC._fromStartTotpMfaEnrollmentResponse(n,t.user.auth)}};yC.FACTOR_ID=`totp`;var bC=class e extends gC{constructor(e,t,n){super(`totp`),this.otp=e,this.enrollmentId=t,this.secret=n}static _fromSecret(t,n){return new e(n,void 0,t)}static _fromEnrollmentId(t,n){return new e(n,t)}async _finalizeEnroll(e,t,n){return $(this.secret!==void 0,e,`argument-error`),Tx(e,{idToken:t,displayName:n,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){$(this.enrollmentId!==void 0&&this.otp!==void 0,e,`argument-error`);let n={verificationCode:this.otp};return dS(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:n})}},xC=class e{constructor(e,t,n,r,i,a,o){this.sessionInfo=a,this.auth=o,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=n,this.codeIntervalSeconds=r,this.enrollmentCompletionDeadline=i}static _fromStartTotpMfaEnrollmentResponse(t,n){return new e(t.totpSessionInfo.sharedSecretKey,t.totpSessionInfo.hashingAlgorithm,t.totpSessionInfo.verificationCodeLength,t.totpSessionInfo.periodSec,new Date(t.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),t.totpSessionInfo.sessionInfo,n)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){let n=!1;return(SC(e)||SC(t))&&(n=!0),n&&(SC(e)&&(e=this.auth.currentUser?.email||`unknownuser`),SC(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}};function SC(e){return e===void 0||e?.length===0}var CC=`@firebase/auth`,wC=`1.12.0`,TC=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(t=>{e(t?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){$(this.auth._initializationPromise,`dependent-sdk-initialized-before-auth`)}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function EC(e){switch(e){case`Node`:return`node`;case`ReactNative`:return`rn`;case`Worker`:return`webworker`;case`Cordova`:return`cordova`;case`WebExtension`:return`web-extension`;default:return}}function DC(e){Vc(new Ss(`auth`,(t,{options:n})=>{let r=t.getProvider(`app`).getImmediate(),i=t.getProvider(`heartbeat`),a=t.getProvider(`app-check-internal`),{apiKey:o,authDomain:s}=r.options;$(o&&!o.includes(`:`),`invalid-api-key`,{appName:r.name});let c=new mb(r,i,a,{apiKey:o,authDomain:s,clientPlatform:e,apiHost:`identitytoolkit.googleapis.com`,tokenApiHost:`securetoken.googleapis.com`,apiScheme:`https`,sdkClientVersion:lb(e)});return Mb(c,n),c},`PUBLIC`).setInstantiationMode(`EXPLICIT`).setInstanceCreatedCallback((e,t,n)=>{e.getProvider(`auth-internal`).initialize()})),Vc(new Ss(`auth-internal`,e=>(e=>new TC(e))(hb(e.getProvider(`auth`).getImmediate())),`PRIVATE`).setInstantiationMode(`EXPLICIT`)),Yc(CC,wC,EC(e)),Yc(CC,wC,`esm2020`)}var OC=Bo(`authIdTokenMaxAge`)||300,kC=null,AC=e=>async t=>{let n=t&&await t.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>OC)return;let i=n?.token;kC!==i&&(kC=i,await fetch(e,{method:i?`POST`:`DELETE`,headers:i?{Authorization:`Bearer ${i}`}:{}}))};function jC(e=Jc()){let t=Hc(e,`auth`);if(t.isInitialized())return t.getImmediate();let n=jb(e,{popupRedirectResolver:hC,persistence:[cS,jx,Lx]}),r=Bo(`authTokenSyncURL`);if(r&&typeof isSecureContext==`boolean`&&isSecureContext){let e=new URL(r,location.origin);if(location.origin===e.origin){let t=AC(e.toString());yx(n,t,()=>t(n.currentUser)),vx(n,e=>t(e))}}let i=Lo(`auth`);return i&&Nb(n,`http://${i}`),n}function MC(){return document.getElementsByTagName(`head`)?.[0]??document}vb({loadJS(e){return new Promise((t,n)=>{let r=document.createElement(`script`);r.setAttribute(`src`,e),r.onload=t,r.onerror=e=>{let t=Xv(`internal-error`);t.customData=e,n(t)},r.type=`text/javascript`,r.charset=`UTF-8`,MC().appendChild(r)})},gapiScript:`https://apis.google.com/js/api.js`,recaptchaV2Script:`https://www.google.com/recaptcha/api.js`,recaptchaEnterpriseScript:`https://www.google.com/recaptcha/enterprise.js?render=`}),DC(`Browser`);var NC=(e,t)=>{let n=e.__vccOpts||e;for(let[e,r]of t)n[e]=r;return n},PC={class:`app-shell`},FC={class:`app-header`},IC={class:`app-subtitle`},LC={class:`auth-bar`},RC={class:`auth-left`},zC={key:0,class:`auth-user`},BC={class:`auth-text`},VC={class:`auth-name`},HC={class:`auth-meta`},UC={key:1,class:`auth-user`},WC={class:`auth-right`},GC={class:`trip-hint`},KC={key:0},qC={class:`app-main`},JC={key:0,class:`page`},YC={key:1,class:`page`},XC={key:2,class:`page`},ZC={class:`card`},QC={class:`uid-box`},$C={class:`uid-value`},ew={key:3,class:`page`},tw={class:`day-tabs`},nw=[`onClick`],rw={class:`chip-top`},iw={class:`chip-date`},aw={class:`chip-weekday`},ow={class:`weather-card`},sw={class:`weather-left`},cw={class:`weather-city`},lw={class:`weather-desc`},uw={class:`weather-title`},dw={class:`weather-emoji`},fw={class:`weather-metrics`},pw={class:`metric`},mw={class:`metric-value`},hw={class:`metric`},gw={class:`metric-value`},_w={class:`metric`},vw={class:`metric-value`},yw={class:`outfit-card`},bw={class:`outfit-text`},xw={class:`outfit-desc`},Sw={key:0,class:`weather-loading`},Cw={key:1,class:`weather-error`},ww={class:`weather-right`},Tw={class:`temp-now`},Ew={class:`temp-range`},Dw={class:`day-title`},Ow={class:`event-row`},kw={class:`event-time`},Aw={class:`event-body`},jw={class:`event-loc`},Mw={class:`event-stay`},Nw={key:0,class:`event-actions`},Pw=[`onClick`],Fw=[`onClick`],Iw={key:0,class:`note-panel`},Lw=[`onUpdate:modelValue`],Rw={class:`note-actions`},zw=[`onClick`],Bw=[`onClick`],Vw={key:0,class:`empty-state`},Hw={key:0,class:`loading`},Uw={key:1,class:`empty-state`},Ww={key:4,class:`page`},Gw={class:`card`},Kw={class:`card-subtitle`},qw={key:0},Jw={key:1},Yw={class:`form-grid`},Xw={class:`field`},Zw={class:`field`},Qw={class:`field`},$w={class:`field`},eT={class:`field field-span`},tT={class:`card`},nT={class:`stats`},rT={class:`stat`},iT={class:`stat-value`},aT={class:`stat`},oT={class:`stat-value`},sT={class:`stat`},cT={class:`stat-value`},lT={key:0,class:`empty-state`},uT={key:1,class:`list`},dT={class:`li-main`},fT={class:`li-title`},pT={style:{opacity:`.65`}},mT={class:`li-sub`},hT={class:`li-amount`},gT={key:5,class:`page`},_T={class:`bottom-nav`},vT=`HM-8F3K2A`,yT=NC({__name:`App`,setup(e){let t=jC(),n=qt(null),r=xa(()=>n.value?n.value.displayName||(n.value.isAnonymous?``:``):``),i=qt(!1),a=qt(!1),o=qt(`itinerary`),s=xa(()=>o.value===`itinerary`?``:o.value===`accounting`?``:o.value===`prep`?``:``);ir(()=>{bx(t,async e=>{if(n.value=e||null,i.value=!1,a.value=!1,!n.value){m.value=[],h.value=null,w.value=[];return}await d(),a.value&&(await _(),await ae())})});async function c(){await CS(t,new ox)}async function l(){await fx(t)}async function u(){await xx(t)}async function d(){if(n.value){i.value=!1,a.value=!1;try{a.value=(await Pv(M_(Hv,`trips`,vT,`members`,n.value.uid))).exists()}catch(e){console.error(` members `,e),a.value=!1}finally{i.value=!0}}}async function f(){await d(),a.value&&(await _(),await ae())}async function p(){try{await navigator.clipboard.writeText(n.value.uid),alert(` UID`)}catch{alert(` UID `)}}let m=qt([]),h=qt(null),g=qt(!1);async function _(){if(!(!n.value||!a.value)){g.value=!0;try{m.value=(await Iv(yv(j_(Hv,`trips`,vT,`plan`),Cv(`day`,`asc`)))).docs.map(e=>{let t=e.data();return{...t,id:e.id,events:(t.events||[]).map(e=>({...e,note:e.note||``,showNote:!1}))}}),m.value.length>0?(h.value=m.value[0].id,await te(),await ne()):h.value=null}catch(e){console.error(` plan `,e),alert(` rules `)}finally{g.value=!1}}}function v(e,t){let n=m.value.find(t=>t.id===e);n&&(n.events[t].showNote=!n.events[t].showNote)}async function y(e,t){let n=m.value.find(t=>t.id===e);if(n)try{await Lv(M_(Hv,`trips`,vT,`plan`,e),{events:n.events.map(({showNote:e,...t})=>t)}),alert(``),n.events[t].showNote=!1}catch(e){console.error(``,e),alert(` rules plan`)}}let b={Busan:{name:`Busan`,lat:35.1796,lon:129.0756,tz:`Asia/Seoul`},Osaka:{name:`Osaka`,lat:34.6937,lon:135.5023,tz:`Asia/Tokyo`},Kyoto:{name:`Kyoto`,lat:35.0116,lon:135.7681,tz:`Asia/Tokyo`},Kobe:{name:`Kobe`,lat:34.6901,lon:135.1955,tz:`Asia/Tokyo`},Nara:{name:`Nara`,lat:34.6851,lon:135.8049,tz:`Asia/Tokyo`}};function x(e){return e.city?e.city:ee(e?.events?.[0]?.loc?String(e.events[0].loc):``)||`Osaka`}function ee(e){let t=String(e||``).toLowerCase();return t.includes(`busan`)||t.includes(``)?`Busan`:t.includes(`osaka`)||t.includes(``)?`Osaka`:t.includes(`kyoto`)||t.includes(``)?`Kyoto`:t.includes(`kobe`)||t.includes(``)?`Kobe`:t.includes(`nara`)||t.includes(``)?`Nara`:``}async function te(){if(!a.value)return;let e=[];for(let t of m.value){if(t.city)continue;let n=x(t)||`Osaka`;t.city=n;let r=M_(Hv,`trips`,vT,`plan`,t.id);e.push(Lv(r,{city:n}))}if(e.length>0)try{await Promise.all(e)}catch(e){console.error(` city `,e)}}let S=qt({loading:!1,error:``,tNow:`-`,tMin:`-`,tMax:`-`,precipProb:`-`,wind:`-`,windUnit:`km/h`,sunrise:`--:--`,statusText:``,statusEmoji:``});Ln(h,async()=>{n.value&&a.value&&o.value===`itinerary`&&await ne()}),Ln(o,async e=>{!n.value||!a.value||(e===`itinerary`&&await ne(),e===`accounting`&&await ae())});async function ne(){let e=m.value.find(e=>e.id===h.value);if(!e)return;let t=b[e.city||x(e)]||b.Osaka;S.value.loading=!0,S.value.error=``;try{let n=ue(e.date),r=`https://api.open-meteo.com/v1/forecast?latitude=${t.lat}&longitude=${t.lon}&daily=temperature_2m_max,temperature_2m_min,precipitation_probability_max,sunrise,wind_speed_10m_max&current=temperature_2m&timezone=${encodeURIComponent(t.tz)}`,i=await fetch(r);if(!i.ok)throw Error(`HTTP ${i.status}`);let a=await i.json(),o=a?.current?.temperature_2m;S.value.tNow=O(o)?Math.round(o):`-`;let s=a?.daily?.time||[],c=n?s.indexOf(n):0,l=c>=0?c:0,u=a?.daily?.temperature_2m_max?.[l],d=a?.daily?.temperature_2m_min?.[l],f=a?.daily?.precipitation_probability_max?.[l],p=a?.daily?.wind_speed_10m_max?.[l],m=a?.daily?.sunrise?.[l];S.value.tMax=O(u)?Math.round(u):`-`,S.value.tMin=O(d)?Math.round(d):`-`,S.value.precipProb=O(f)?Math.round(f):`-`,S.value.wind=O(p)?Math.round(p):`-`,S.value.sunrise=m?pe(m):`--:--`;let{statusText:h,statusEmoji:g}=re(S.value.precipProb,S.value.tMax);S.value.statusText=h,S.value.statusEmoji=g}catch(e){S.value.error=e?.message?String(e.message):``}finally{S.value.loading=!1}}function re(e,t){let n=Number(e),r=Number(t);return O(n)&&n>=60?{statusText:``,statusEmoji:``}:O(n)&&n>=30?{statusText:``,statusEmoji:``}:O(r)&&r>=28?{statusText:``,statusEmoji:``}:O(r)&&r<=10?{statusText:``,statusEmoji:``}:{statusText:``,statusEmoji:``}}function C(e,t,n){let r=Number(e),i=Number(t),a=Number(n),o=O(a)&&a>=40;return`${O(r)&&r<=8?``:O(r)&&r<=15?`/`:O(i)&&i>=28?``:``}${o?``:``} 15,000 `}let w=qt(me(`hm_expenses_cache`,[])),ie=qt(!1),T=qt(``),E=qt({date:new Date().toISOString().slice(0,10),amount:0,currency:`JPY`,category:`food`,note:``});async function ae(){if(!(!n.value||!a.value)){ie.value=!0,T.value=``;try{w.value=(await Iv(yv(j_(Hv,`trips`,vT,`expenses`),Cv(`createdAt`,`desc`)))).docs.map(e=>{let t=e.data();return{id:e.id,date:t.date||``,amount:t.amount||0,currency:t.currency||`JPY`,category:t.category||`other`,note:t.note||``,uid:t.uid||``,displayName:t.displayName||``,createdAt:t.createdAt||null}}),ge(`hm_expenses_cache`,w.value)}catch(e){T.value=e?.message?String(e.message):``,w.value=me(`hm_expenses_cache`,[])}finally{ie.value=!1}}}async function oe(){if(!n.value||!a.value)return alert(``);if(!E.value.date)return alert(``);if(!O(E.value.amount)||Number(E.value.amount)<=0)return alert(` 0`);let e={date:E.value.date,amount:Number(E.value.amount),currency:E.value.currency,category:E.value.category,note:(E.value.note||``).trim(),uid:n.value.uid,displayName:n.value.displayName||(n.value.isAnonymous?``:``),createdAt:Vv()},t=`local_${Date.now()}`;w.value.unshift({id:t,...e,createdAt:new Date}),ge(`hm_expenses_cache`,w.value);try{await Rv(j_(Hv,`trips`,vT,`expenses`),e),await ae()}catch(e){T.value=e?.message?String(e.message):``,alert(` rules / `)}E.value.amount=0,E.value.note=``}function se(){confirm(``)&&(ge(`hm_expenses_cache`,[]),w.value=[])}let D=xa(()=>{let e=0,t=0;for(let n of w.value)n.currency===`JPY`&&(e+=Number(n.amount)||0),n.currency===`TWD`&&(t+=Number(n.amount)||0);return{JPY:_e(e),TWD:_e(t)}});function ce(e){return{food:``,traffic:``,shopping:``,ticket:``,hotel:``,other:``}[e]||``}function le(e){let t=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(e)}`;window.open(t,`_blank`)}function ue(e){if(!e)return``;let t=String(e).trim();if(t.includes(`-`))return t.slice(0,10);let n=t.split(`/`);if(n.length!==3)return``;let[r,i,a]=n;return`${r}-${String(i).padStart(2,`0`)}-${String(a).padStart(2,`0`)}`}function de(e){if(!e)return``;let t=String(e).trim(),n=t.includes(`/`)?t.split(`/`):t.split(`-`);if(n.length<3)return t;let r=Number(n[1]),i=Number(n[2]);return!O(r)||!O(i)?t:`${r}/${i}`}function fe(e){let t=ue(e);return t?`${[``,``,``,``,``,``,``][new Date(`${t}T00:00:00`).getDay()]}`:``}function pe(e){return(String(e||``).split(`T`)[1]||``).slice(0,5)||`--:--`}function O(e){return Number.isFinite(Number(e))}function me(e,t){try{let n=localStorage.getItem(e);return n?JSON.parse(n):t}catch{return t}}function ge(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch{}}function _e(e){return(Number(e)||0).toLocaleString(`en-US`)}return(e,t)=>(F(),I(`div`,PC,[L(`header`,FC,[t[12]||=L(`div`,{class:`app-title`},` `,-1),L(`div`,IC,k(s.value),1),L(`div`,LC,[L(`div`,RC,[n.value?(F(),I(`div`,zC,[t[8]||=L(`div`,{class:`auth-dot`},null,-1),L(`div`,BC,[L(`div`,VC,k(r.value),1),L(`div`,HC,`UID: `+k(n.value.uid),1)])])):(F(),I(`div`,UC,[...t[9]||=[L(`div`,{class:`auth-dot off`},null,-1),L(`div`,{class:`auth-text`},[L(`div`,{class:`auth-name`},``),L(`div`,{class:`auth-meta`},``)],-1)]]))]),L(`div`,WC,[n.value?Ji(``,!0):(F(),I(`button`,{key:0,class:`btn btn-secondary`,onClick:c},`Google `)),n.value?Ji(``,!0):(F(),I(`button`,{key:1,class:`btn btn-secondary`,onClick:l},``)),n.value?(F(),I(`button`,{key:2,class:`btn btn-ghost`,onClick:u},``)):Ji(``,!0)])]),L(`div`,GC,[t[11]||=Ki(` `,-1),L(`b`,null,k(vT)),n.value?(F(),I(`span`,KC,[t[10]||=Ki(``,-1),L(`b`,null,k(a.value?` `:` `),1)])):Ji(``,!0)])]),L(`main`,qC,[n.value?n.value&&!i.value?(F(),I(`section`,YC,[...t[14]||=[L(`div`,{class:`card`},[L(`div`,{class:`card-title`},` `),L(`div`,{class:`card-subtitle`},``),L(`div`,{class:`empty-state`},` rules `)],-1)]])):n.value&&i.value&&!a.value?(F(),I(`section`,XC,[L(`div`,ZC,[t[21]||=L(`div`,{class:`card-title`},` `,-1),t[22]||=L(`div`,{class:`card-subtitle`},[Ki(`  A`),L(`br`),Ki(`  UID owner members  `)],-1),L(`div`,QC,[t[15]||=L(`div`,{class:`uid-label`},` UID`,-1),L(`div`,$C,k(n.value.uid),1),L(`div`,{class:`uid-actions`},[L(`button`,{class:`btn btn-primary`,onClick:p},` UID`),L(`button`,{class:`btn btn-secondary`,onClick:f},``)])]),L(`div`,{class:`card-subtitle`,style:{"margin-top":`10px`}},[t[16]||=Ki(` `,-1),t[17]||=L(`br`,null,null,-1),t[18]||=Ki(` plan`,-1),L(`b`,null,`trips/`+k(vT)+`/plan`),t[19]||=L(`br`,null,null,-1),t[20]||=Ki(` expenses`,-1),L(`b`,null,`trips/`+k(vT)+`/expenses`)])])])):n.value&&i.value&&a.value&&o.value===`itinerary`?(F(),I(`section`,ew,[L(`div`,tw,[(F(!0),I(Di,null,mr(m.value,e=>(F(),I(`button`,{key:e.id,class:he([`day-chip`,{active:h.value===e.id}]),onClick:t=>h.value=e.id},[L(`div`,rw,`DAY `+k(e.day),1),L(`div`,iw,k(e.shortDate||de(e.date)),1),L(`div`,aw,k(e.weekday||fe(e.date)),1)],10,nw))),128))]),(F(!0),I(Di,null,mr(m.value,e=>jn((F(),I(`div`,{key:e.id,class:`day-panel`},[L(`div`,ow,[L(`div`,sw,[L(`div`,cw,[t[23]||=L(`span`,{class:`pin`},``,-1),L(`span`,null,k(e.city||x(e)),1)]),L(`div`,lw,[L(`span`,uw,k(S.value.statusText),1),L(`span`,dw,k(S.value.statusEmoji),1)]),L(`div`,fw,[L(`div`,pw,[L(`div`,mw,k(S.value.precipProb)+`%`,1),t[24]||=L(`div`,{class:`metric-label`},``,-1)]),L(`div`,hw,[L(`div`,gw,k(S.value.wind)+k(S.value.windUnit),1),t[25]||=L(`div`,{class:`metric-label`},``,-1)]),L(`div`,_w,[L(`div`,vw,k(S.value.sunrise),1),t[26]||=L(`div`,{class:`metric-label`},``,-1)])]),L(`div`,yw,[t[28]||=L(`div`,{class:`outfit-icon`},``,-1),L(`div`,bw,[t[27]||=L(`div`,{class:`outfit-title`},``,-1),L(`div`,xw,k(C(S.value.tMin,S.value.tMax,S.value.precipProb)),1)])]),S.value.loading?(F(),I(`div`,Sw,`...`)):Ji(``,!0),S.value.error?(F(),I(`div`,Cw,``+k(S.value.error),1)):Ji(``,!0)]),L(`div`,ww,[L(`div`,Tw,k(S.value.tNow)+``,1),L(`div`,Ew,k(S.value.tMin)+` / `+k(S.value.tMax)+``,1)])]),L(`h2`,Dw,`  `+k(e.day)+` `+k(e.date)+``,1),(F(!0),I(Di,null,mr(e.events,(t,n)=>(F(),I(`div`,{key:n,class:`event-card`},[L(`div`,Ow,[L(`div`,kw,k(t.time),1),L(`div`,Aw,[L(`div`,jw,k(t.loc),1),L(`div`,Mw,`  `+k(t.stay),1)]),t.showNote?Ji(``,!0):(F(),I(`div`,Nw,[L(`button`,{class:`btn btn-secondary`,onClick:e=>le(t.loc)},``,8,Pw),L(`button`,{class:`btn btn-primary`,onClick:t=>v(e.id,n)},``,8,Fw)]))]),t.showNote?(F(),I(`div`,Iw,[jn(L(`textarea`,{"onUpdate:modelValue":e=>t.note=e,class:`note-textarea`,placeholder:`...`},null,8,Lw),[[mo,t.note]]),L(`div`,Rw,[L(`button`,{class:`btn btn-primary`,onClick:t=>y(e.id,n)},``,8,zw),L(`button`,{class:`btn btn-secondary`,onClick:t=>v(e.id,n)},``,8,Bw)])])):Ji(``,!0)]))),128)),!e.events||e.events.length===0?(F(),I(`div`,Vw,`  `)):Ji(``,!0)])),[[Fa,h.value===e.id]])),128)),g.value?(F(),I(`div`,Hw,`... `)):Ji(``,!0),!g.value&&m.value.length===0?(F(),I(`div`,Uw,`  plan trips/`+k(vT)+`/plan `)):Ji(``,!0)])):n.value&&i.value&&a.value&&o.value===`accounting`?(F(),I(`section`,Ww,[L(`div`,Gw,[t[38]||=L(`div`,{class:`card-title`},` `,-1),L(`div`,Kw,[t[29]||=Ki(` `,-1),L(`b`,null,`trips/`+k(vT)+`/expenses`),t[30]||=L(`br`,null,null,-1),ie.value?(F(),I(`span`,qw,``)):Ji(``,!0),T.value?(F(),I(`span`,Jw,``+k(T.value),1)):Ji(``,!0)]),L(`div`,Yw,[L(`label`,Xw,[t[31]||=L(`div`,{class:`field-label`},``,-1),jn(L(`input`,{class:`field-input`,type:`date`,"onUpdate:modelValue":t[0]||=e=>E.value.date=e},null,512),[[mo,E.value.date]])]),L(`label`,Zw,[t[32]||=L(`div`,{class:`field-label`},``,-1),jn(L(`input`,{class:`field-input`,type:`number`,"onUpdate:modelValue":t[1]||=e=>E.value.amount=e,placeholder:` 1200`},null,512),[[mo,E.value.amount,void 0,{number:!0}]])]),L(`label`,Qw,[t[34]||=L(`div`,{class:`field-label`},``,-1),jn(L(`select`,{class:`field-input`,"onUpdate:modelValue":t[2]||=e=>E.value.currency=e},[...t[33]||=[L(`option`,{value:`JPY`},`JPY`,-1),L(`option`,{value:`TWD`},`TWD`,-1)]],512),[[ho,E.value.currency]])]),L(`label`,$w,[t[36]||=L(`div`,{class:`field-label`},``,-1),jn(L(`select`,{class:`field-input`,"onUpdate:modelValue":t[3]||=e=>E.value.category=e},[...t[35]||=[qi(`<option value="food" data-v-24ef83df></option><option value="traffic" data-v-24ef83df></option><option value="shopping" data-v-24ef83df></option><option value="ticket" data-v-24ef83df></option><option value="hotel" data-v-24ef83df></option><option value="other" data-v-24ef83df></option>`,6)]],512),[[ho,E.value.category]])]),L(`label`,eT,[t[37]||=L(`div`,{class:`field-label`},``,-1),jn(L(`input`,{class:`field-input`,"onUpdate:modelValue":t[4]||=e=>E.value.note=e,placeholder:`...`},null,512),[[mo,E.value.note]])])]),L(`div`,{class:`row-right`},[L(`button`,{class:`btn btn-primary`,onClick:oe},` `),L(`button`,{class:`btn btn-secondary`,onClick:ae},``),L(`button`,{class:`btn btn-secondary`,onClick:se},``)]),t[39]||=L(`div`,{class:`card-subtitle`,style:{"margin-top":`10px`}},[Ki(` `),L(`b`,null,`uid`),Ki(` + `),L(`b`,null,`displayName`),Ki(``),L(`br`),Ki(`   rules `)],-1)]),L(`div`,tT,[t[43]||=L(`div`,{class:`card-title`},` `,-1),L(`div`,nT,[L(`div`,rT,[L(`div`,iT,k(D.value.JPY),1),t[40]||=L(`div`,{class:`stat-label`},`JPY `,-1)]),L(`div`,aT,[L(`div`,oT,k(D.value.TWD),1),t[41]||=L(`div`,{class:`stat-label`},`TWD `,-1)]),L(`div`,sT,[L(`div`,cT,k(w.value.length),1),t[42]||=L(`div`,{class:`stat-label`},``,-1)])]),w.value.length===0?(F(),I(`div`,lT,`  `)):(F(),I(`div`,uT,[(F(!0),I(Di,null,mr(w.value,e=>(F(),I(`div`,{key:e.id,class:`list-item`},[L(`div`,dT,[L(`div`,fT,[Ki(k(e.date)+``+k(ce(e.category))+` `,1),L(`span`,pT,``+k(e.displayName||``),1)]),L(`div`,mT,k(e.note||``),1)]),L(`div`,hT,k(e.amount)+` `+k(e.currency),1)]))),128))]))])])):n.value&&i.value&&a.value&&o.value===`prep`?(F(),I(`section`,gT,[L(`div`,{class:`card`},[t[44]||=L(`div`,{class:`card-title`},` `,-1),L(`div`,{class:`card-subtitle`},` trips/`+k(vT)+`/meta `)])])):Ji(``,!0):(F(),I(`section`,JC,[...t[13]||=[L(`div`,{class:`card`},[L(`div`,{class:`card-title`},` `),L(`div`,{class:`card-subtitle`},``)],-1)]]))]),L(`nav`,_T,[L(`button`,{class:he([`nav-item`,{active:o.value===`itinerary`}]),onClick:t[5]||=e=>o.value=`itinerary`},[...t[45]||=[L(`div`,{class:`nav-icon`},``,-1),L(`div`,{class:`nav-label`},``,-1)]],2),L(`button`,{class:he([`nav-item`,{active:o.value===`accounting`}]),onClick:t[6]||=e=>o.value=`accounting`},[...t[46]||=[L(`div`,{class:`nav-icon`},``,-1),L(`div`,{class:`nav-label`},``,-1)]],2),L(`button`,{class:he([`nav-item`,{active:o.value===`prep`}]),onClick:t[7]||=e=>o.value=`prep`},[...t[47]||=[L(`div`,{class:`nav-icon`},``,-1),L(`div`,{class:`nav-label`},``,-1)]],2)])]))}},[[`__scopeId`,`data-v-24ef83df`]]);console.log(`Vue main.js `),xo(yT).mount(`#app`);